Imports System.Drawing.Drawing2D
Imports System
Imports Microsoft.Win32
Public Class Form1

    Inherits System.Windows.Forms.Form
#Region " Windows Form Designer generated code "

    Public Sub New()
        MyBase.New()

        'This call is required by the Windows Form Designer.
        InitializeComponent()

        'Add any initialization after the InitializeComponent() call

    End Sub

    'Form overrides dispose to clean up the component list.
    Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)
        If disposing Then
            If Not (components Is Nothing) Then
                components.Dispose()
            End If
        End If
        MyBase.Dispose(disposing)
    End Sub

    'Required by the Windows Form Designer
    Private components As System.ComponentModel.IContainer

    'NOTE: The following procedure is required by the Windows Form Designer
    'It can be modified using the Windows Form Designer.  
    'Do not modify it using the code editor.
    Friend WithEvents Label1 As System.Windows.Forms.Label
    Friend WithEvents Label14 As System.Windows.Forms.Label
    Friend WithEvents Label19 As System.Windows.Forms.Label
    Friend WithEvents Label15 As System.Windows.Forms.Label
    Friend WithEvents Label13 As System.Windows.Forms.Label
    Friend WithEvents Label10 As System.Windows.Forms.Label
    Friend WithEvents Label8 As System.Windows.Forms.Label
    Friend WithEvents Label7 As System.Windows.Forms.Label
    Friend WithEvents Label6 As System.Windows.Forms.Label
    Friend WithEvents Label5 As System.Windows.Forms.Label
    Friend WithEvents Label4 As System.Windows.Forms.Label
    Friend WithEvents Label3 As System.Windows.Forms.Label
    Friend WithEvents Label2 As System.Windows.Forms.Label
    Friend WithEvents Label114 As System.Windows.Forms.Label
    Friend WithEvents Label89 As System.Windows.Forms.Label
    Friend WithEvents Label90 As System.Windows.Forms.Label
    Friend WithEvents Label94 As System.Windows.Forms.Label
    Friend WithEvents Label95 As System.Windows.Forms.Label
    Friend WithEvents Label96 As System.Windows.Forms.Label
    Friend WithEvents Label97 As System.Windows.Forms.Label
    Friend WithEvents Label98 As System.Windows.Forms.Label
    Friend WithEvents txtInitialUpgrades As System.Windows.Forms.TextBox
    Friend WithEvents cmbLightPointsSound As System.Windows.Forms.ComboBox
    Friend WithEvents txtBuildableHerosMP As System.Windows.Forms.TextBox
    Friend WithEvents txtDefaultPlayerAIType As System.Windows.Forms.ComboBox
    Friend WithEvents cmbScienceCommandSet As System.Windows.Forms.ComboBox
    Friend WithEvents cmbSpellBook As System.Windows.Forms.ComboBox
    Friend WithEvents cmbIntirinsicSciences As System.Windows.Forms.ComboBox
    Friend WithEvents cmbEvil As System.Windows.Forms.ComboBox
    Friend WithEvents txtStartMoney As System.Windows.Forms.TextBox
    Friend WithEvents txtPlayerTemplateFaction As System.Windows.Forms.TextBox
    Friend WithEvents txtSide As System.Windows.Forms.TextBox
    Friend WithEvents txtFactionsUgradeText As System.Windows.Forms.TextBox
    Friend WithEvents txtFactionsArmiesName As System.Windows.Forms.TextBox
    Friend WithEvents txtFactionsDisplayedName As System.Windows.Forms.TextBox
    Friend WithEvents txtMajorUnitValue As System.Windows.Forms.TextBox
    Friend WithEvents txtVictoryThreshold As System.Windows.Forms.TextBox
    Friend WithEvents txtEnemyKillScaleFactor As System.Windows.Forms.TextBox
    Friend WithEvents txtAllyDeathScaleFactor As System.Windows.Forms.TextBox
    Friend WithEvents lblColor As System.Windows.Forms.Label
    Friend WithEvents GrpPlayerTemplate As System.Windows.Forms.GroupBox
    Friend WithEvents grpSTR As System.Windows.Forms.GroupBox
    Friend WithEvents grpVictorySystem As System.Windows.Forms.GroupBox
    Friend WithEvents chkIncludeFaction As System.Windows.Forms.CheckBox
    Friend WithEvents btnColor As System.Windows.Forms.Button
    Friend WithEvents cmbPlayableSide As System.Windows.Forms.ComboBox
    Friend WithEvents txtMapToCellVictoryRatio As System.Windows.Forms.TextBox
    Friend WithEvents ColorDialog1 As System.Windows.Forms.ColorDialog
    Friend WithEvents OpenFileDialog1 As System.Windows.Forms.OpenFileDialog
    Friend WithEvents SaveFileDialog1 As System.Windows.Forms.SaveFileDialog
    Friend WithEvents GroupBox1 As System.Windows.Forms.GroupBox
    Friend WithEvents chkPT As System.Windows.Forms.CheckBox
    Friend WithEvents chkS As System.Windows.Forms.CheckBox
    Friend WithEvents chkCS As System.Windows.Forms.CheckBox
    Friend WithEvents chkU As System.Windows.Forms.CheckBox
    Friend WithEvents chkVS As System.Windows.Forms.CheckBox
    Friend WithEvents chkSTR As System.Windows.Forms.CheckBox
    Friend WithEvents chkCB As System.Windows.Forms.CheckBox
    Friend WithEvents chkIncludeCB As System.Windows.Forms.CheckBox
    Friend WithEvents Timer1 As System.Windows.Forms.Timer
    Friend WithEvents Label9 As System.Windows.Forms.Label
    Friend WithEvents LinkLabel1 As System.Windows.Forms.LinkLabel
    Friend WithEvents picLogo As System.Windows.Forms.PictureBox
    Friend WithEvents MainMenu1 As System.Windows.Forms.MainMenu
    Friend WithEvents ToolTip1 As System.Windows.Forms.ToolTip
    Friend WithEvents Status As System.Windows.Forms.StatusBar
    Friend WithEvents StatusBarPanel1 As System.Windows.Forms.StatusBarPanel
    Friend WithEvents StatusBarPanel2 As System.Windows.Forms.StatusBarPanel
    Friend WithEvents StatusBarPanel3 As System.Windows.Forms.StatusBarPanel
    Friend WithEvents lstFactions As System.Windows.Forms.ListBox
    Friend WithEvents btnFile As System.Windows.Forms.MenuItem
    Friend WithEvents btnOpen As System.Windows.Forms.MenuItem
    Friend WithEvents btnCreate As System.Windows.Forms.MenuItem
    Friend WithEvents btnExit As System.Windows.Forms.MenuItem
    Friend WithEvents btnEdit As System.Windows.Forms.MenuItem
    Friend WithEvents btnAdd As System.Windows.Forms.MenuItem
    Friend WithEvents btnHelp As System.Windows.Forms.MenuItem
    Friend WithEvents btnInstructions As System.Windows.Forms.MenuItem
    Friend WithEvents btnCredits As System.Windows.Forms.MenuItem
    Friend WithEvents btnCreateFiles As System.Windows.Forms.Button
    Friend WithEvents MenuItem1 As System.Windows.Forms.MenuItem
    Friend WithEvents btnAdd2 As System.Windows.Forms.Button
    Friend WithEvents btnNew2 As System.Windows.Forms.Button
    Friend WithEvents btnSave2 As System.Windows.Forms.Button
    Friend WithEvents btnOpen2 As System.Windows.Forms.Button
    Friend WithEvents btnSetFaction As System.Windows.Forms.MenuItem
    Friend WithEvents btnEvil As System.Windows.Forms.MenuItem
    Friend WithEvents btnGood As System.Windows.Forms.MenuItem
    Friend WithEvents btnInstructions2 As System.Windows.Forms.Button
    Friend WithEvents btnEvil2 As System.Windows.Forms.Button
    Friend WithEvents btnGood2 As System.Windows.Forms.Button
    Friend WithEvents btnTips2 As System.Windows.Forms.Button
    Friend WithEvents btnCredits2 As System.Windows.Forms.Button
    Friend WithEvents Label12 As System.Windows.Forms.Label
    Friend WithEvents Label11 As System.Windows.Forms.Label
    <System.Diagnostics.DebuggerStepThrough()> Private Sub InitializeComponent()
        Me.components = New System.ComponentModel.Container
        Dim resources As System.Resources.ResourceManager = New System.Resources.ResourceManager(GetType(Form1))
        Me.GrpPlayerTemplate = New System.Windows.Forms.GroupBox
        Me.lblColor = New System.Windows.Forms.Label
        Me.btnColor = New System.Windows.Forms.Button
        Me.Label1 = New System.Windows.Forms.Label
        Me.txtInitialUpgrades = New System.Windows.Forms.TextBox
        Me.cmbLightPointsSound = New System.Windows.Forms.ComboBox
        Me.Label14 = New System.Windows.Forms.Label
        Me.Label19 = New System.Windows.Forms.Label
        Me.txtBuildableHerosMP = New System.Windows.Forms.TextBox
        Me.txtDefaultPlayerAIType = New System.Windows.Forms.ComboBox
        Me.Label15 = New System.Windows.Forms.Label
        Me.cmbScienceCommandSet = New System.Windows.Forms.ComboBox
        Me.Label13 = New System.Windows.Forms.Label
        Me.cmbSpellBook = New System.Windows.Forms.ComboBox
        Me.Label10 = New System.Windows.Forms.Label
        Me.cmbIntirinsicSciences = New System.Windows.Forms.ComboBox
        Me.Label8 = New System.Windows.Forms.Label
        Me.cmbEvil = New System.Windows.Forms.ComboBox
        Me.cmbPlayableSide = New System.Windows.Forms.ComboBox
        Me.Label7 = New System.Windows.Forms.Label
        Me.Label6 = New System.Windows.Forms.Label
        Me.txtStartMoney = New System.Windows.Forms.TextBox
        Me.Label5 = New System.Windows.Forms.Label
        Me.Label4 = New System.Windows.Forms.Label
        Me.Label3 = New System.Windows.Forms.Label
        Me.Label2 = New System.Windows.Forms.Label
        Me.txtPlayerTemplateFaction = New System.Windows.Forms.TextBox
        Me.txtSide = New System.Windows.Forms.TextBox
        Me.grpSTR = New System.Windows.Forms.GroupBox
        Me.txtFactionsUgradeText = New System.Windows.Forms.TextBox
        Me.Label114 = New System.Windows.Forms.Label
        Me.txtFactionsArmiesName = New System.Windows.Forms.TextBox
        Me.Label89 = New System.Windows.Forms.Label
        Me.txtFactionsDisplayedName = New System.Windows.Forms.TextBox
        Me.Label90 = New System.Windows.Forms.Label
        Me.grpVictorySystem = New System.Windows.Forms.GroupBox
        Me.Label9 = New System.Windows.Forms.Label
        Me.txtMapToCellVictoryRatio = New System.Windows.Forms.TextBox
        Me.Label94 = New System.Windows.Forms.Label
        Me.txtMajorUnitValue = New System.Windows.Forms.TextBox
        Me.Label95 = New System.Windows.Forms.Label
        Me.txtVictoryThreshold = New System.Windows.Forms.TextBox
        Me.Label96 = New System.Windows.Forms.Label
        Me.txtEnemyKillScaleFactor = New System.Windows.Forms.TextBox
        Me.Label97 = New System.Windows.Forms.Label
        Me.txtAllyDeathScaleFactor = New System.Windows.Forms.TextBox
        Me.Label98 = New System.Windows.Forms.Label
        Me.chkIncludeCB = New System.Windows.Forms.CheckBox
        Me.chkIncludeFaction = New System.Windows.Forms.CheckBox
        Me.LinkLabel1 = New System.Windows.Forms.LinkLabel
        Me.GroupBox1 = New System.Windows.Forms.GroupBox
        Me.chkVS = New System.Windows.Forms.CheckBox
        Me.chkU = New System.Windows.Forms.CheckBox
        Me.chkS = New System.Windows.Forms.CheckBox
        Me.chkSTR = New System.Windows.Forms.CheckBox
        Me.chkCB = New System.Windows.Forms.CheckBox
        Me.chkCS = New System.Windows.Forms.CheckBox
        Me.chkPT = New System.Windows.Forms.CheckBox
        Me.btnCreateFiles = New System.Windows.Forms.Button
        Me.picLogo = New System.Windows.Forms.PictureBox
        Me.ColorDialog1 = New System.Windows.Forms.ColorDialog
        Me.OpenFileDialog1 = New System.Windows.Forms.OpenFileDialog
        Me.SaveFileDialog1 = New System.Windows.Forms.SaveFileDialog
        Me.Timer1 = New System.Windows.Forms.Timer(Me.components)
        Me.MainMenu1 = New System.Windows.Forms.MainMenu
        Me.btnFile = New System.Windows.Forms.MenuItem
        Me.btnOpen = New System.Windows.Forms.MenuItem
        Me.btnCreate = New System.Windows.Forms.MenuItem
        Me.btnExit = New System.Windows.Forms.MenuItem
        Me.btnEdit = New System.Windows.Forms.MenuItem
        Me.btnAdd = New System.Windows.Forms.MenuItem
        Me.btnSetFaction = New System.Windows.Forms.MenuItem
        Me.btnEvil = New System.Windows.Forms.MenuItem
        Me.btnGood = New System.Windows.Forms.MenuItem
        Me.btnHelp = New System.Windows.Forms.MenuItem
        Me.btnInstructions = New System.Windows.Forms.MenuItem
        Me.btnCredits = New System.Windows.Forms.MenuItem
        Me.MenuItem1 = New System.Windows.Forms.MenuItem
        Me.ToolTip1 = New System.Windows.Forms.ToolTip(Me.components)
        Me.btnInstructions2 = New System.Windows.Forms.Button
        Me.btnEvil2 = New System.Windows.Forms.Button
        Me.btnAdd2 = New System.Windows.Forms.Button
        Me.btnNew2 = New System.Windows.Forms.Button
        Me.btnSave2 = New System.Windows.Forms.Button
        Me.btnOpen2 = New System.Windows.Forms.Button
        Me.btnGood2 = New System.Windows.Forms.Button
        Me.btnTips2 = New System.Windows.Forms.Button
        Me.btnCredits2 = New System.Windows.Forms.Button
        Me.Status = New System.Windows.Forms.StatusBar
        Me.StatusBarPanel1 = New System.Windows.Forms.StatusBarPanel
        Me.StatusBarPanel2 = New System.Windows.Forms.StatusBarPanel
        Me.StatusBarPanel3 = New System.Windows.Forms.StatusBarPanel
        Me.lstFactions = New System.Windows.Forms.ListBox
        Me.Label12 = New System.Windows.Forms.Label
        Me.Label11 = New System.Windows.Forms.Label
        Me.GrpPlayerTemplate.SuspendLayout()
        Me.grpSTR.SuspendLayout()
        Me.grpVictorySystem.SuspendLayout()
        Me.GroupBox1.SuspendLayout()
        CType(Me.StatusBarPanel1, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.StatusBarPanel2, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.StatusBarPanel3, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.SuspendLayout()
        '
        'GrpPlayerTemplate
        '
        Me.GrpPlayerTemplate.BackColor = System.Drawing.SystemColors.Control
        Me.GrpPlayerTemplate.Controls.Add(Me.lblColor)
        Me.GrpPlayerTemplate.Controls.Add(Me.btnColor)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label1)
        Me.GrpPlayerTemplate.Controls.Add(Me.txtInitialUpgrades)
        Me.GrpPlayerTemplate.Controls.Add(Me.cmbLightPointsSound)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label14)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label19)
        Me.GrpPlayerTemplate.Controls.Add(Me.txtBuildableHerosMP)
        Me.GrpPlayerTemplate.Controls.Add(Me.txtDefaultPlayerAIType)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label15)
        Me.GrpPlayerTemplate.Controls.Add(Me.cmbScienceCommandSet)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label13)
        Me.GrpPlayerTemplate.Controls.Add(Me.cmbSpellBook)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label10)
        Me.GrpPlayerTemplate.Controls.Add(Me.cmbIntirinsicSciences)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label8)
        Me.GrpPlayerTemplate.Controls.Add(Me.cmbEvil)
        Me.GrpPlayerTemplate.Controls.Add(Me.cmbPlayableSide)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label7)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label6)
        Me.GrpPlayerTemplate.Controls.Add(Me.txtStartMoney)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label5)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label4)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label3)
        Me.GrpPlayerTemplate.Controls.Add(Me.Label2)
        Me.GrpPlayerTemplate.Controls.Add(Me.txtPlayerTemplateFaction)
        Me.GrpPlayerTemplate.Controls.Add(Me.txtSide)
        Me.GrpPlayerTemplate.Location = New System.Drawing.Point(408, 32)
        Me.GrpPlayerTemplate.Name = "GrpPlayerTemplate"
        Me.GrpPlayerTemplate.Size = New System.Drawing.Size(240, 336)
        Me.GrpPlayerTemplate.TabIndex = 81
        Me.GrpPlayerTemplate.TabStop = False
        Me.GrpPlayerTemplate.Text = "PlayerTemplate.ini"
        '
        'lblColor
        '
        Me.lblColor.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D
        Me.lblColor.Location = New System.Drawing.Point(208, 136)
        Me.lblColor.Name = "lblColor"
        Me.lblColor.Size = New System.Drawing.Size(20, 20)
        Me.lblColor.TabIndex = 106
        '
        'btnColor
        '
        Me.btnColor.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.btnColor.Location = New System.Drawing.Point(152, 136)
        Me.btnColor.Name = "btnColor"
        Me.btnColor.Size = New System.Drawing.Size(48, 20)
        Me.btnColor.TabIndex = 105
        Me.btnColor.Text = "Pick"
        '
        'Label1
        '
        Me.Label1.Location = New System.Drawing.Point(24, 304)
        Me.Label1.Name = "Label1"
        Me.Label1.Size = New System.Drawing.Size(128, 24)
        Me.Label1.TabIndex = 70
        Me.Label1.Text = "InitialUpgrades:"
        Me.Label1.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label1, "The Factions Upgrade (Upgrade_'FactionName'Upgrade) Is already taken care of just" & _
        " list additional Upgrades")
        '
        'txtInitialUpgrades
        '
        Me.txtInitialUpgrades.Location = New System.Drawing.Point(152, 304)
        Me.txtInitialUpgrades.Name = "txtInitialUpgrades"
        Me.txtInitialUpgrades.Size = New System.Drawing.Size(80, 20)
        Me.txtInitialUpgrades.TabIndex = 69
        Me.txtInitialUpgrades.Text = ""
        '
        'cmbLightPointsSound
        '
        Me.cmbLightPointsSound.Items.AddRange(New Object() {"RohanLightPointsUp", "GondorLightPointsUp", "IsengardLightPointsUp", "MordorLightPointsUp"})
        Me.cmbLightPointsSound.Location = New System.Drawing.Point(152, 256)
        Me.cmbLightPointsSound.Name = "cmbLightPointsSound"
        Me.cmbLightPointsSound.Size = New System.Drawing.Size(80, 21)
        Me.cmbLightPointsSound.TabIndex = 68
        '
        'Label14
        '
        Me.Label14.Location = New System.Drawing.Point(24, 256)
        Me.Label14.Name = "Label14"
        Me.Label14.Size = New System.Drawing.Size(128, 24)
        Me.Label14.TabIndex = 66
        Me.Label14.Text = "Light Points Sound:"
        Me.Label14.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label14, "This is the Light Points sound used in game")
        '
        'Label19
        '
        Me.Label19.Location = New System.Drawing.Point(24, 280)
        Me.Label19.Name = "Label19"
        Me.Label19.Size = New System.Drawing.Size(128, 24)
        Me.Label19.TabIndex = 60
        Me.Label19.Text = "BuildableHerosMP:"
        Me.Label19.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label19, "List all Buildable Heros here for skirmish matches. Separate the Heros by a space" & _
        ", no comma.")
        '
        'txtBuildableHerosMP
        '
        Me.txtBuildableHerosMP.Location = New System.Drawing.Point(152, 280)
        Me.txtBuildableHerosMP.Name = "txtBuildableHerosMP"
        Me.txtBuildableHerosMP.Size = New System.Drawing.Size(80, 20)
        Me.txtBuildableHerosMP.TabIndex = 59
        Me.txtBuildableHerosMP.Text = ""
        '
        'txtDefaultPlayerAIType
        '
        Me.txtDefaultPlayerAIType.Items.AddRange(New Object() {"RohanSkirmishAI", "GondorSkirmishAI", "IsengardSkirmishAI", "MordorSkirmishAI"})
        Me.txtDefaultPlayerAIType.Location = New System.Drawing.Point(152, 232)
        Me.txtDefaultPlayerAIType.Name = "txtDefaultPlayerAIType"
        Me.txtDefaultPlayerAIType.Size = New System.Drawing.Size(80, 21)
        Me.txtDefaultPlayerAIType.TabIndex = 49
        '
        'Label15
        '
        Me.Label15.Location = New System.Drawing.Point(24, 232)
        Me.Label15.Name = "Label15"
        Me.Label15.Size = New System.Drawing.Size(128, 24)
        Me.Label15.TabIndex = 47
        Me.Label15.Text = "DefaultPlayerAIType:"
        Me.Label15.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label15, "This is the Factions AItype unless you create your own")
        '
        'cmbScienceCommandSet
        '
        Me.cmbScienceCommandSet.Items.AddRange(New Object() {"GoodSpellStoreCommandSet", "EvilSpellStoreCommandSet"})
        Me.cmbScienceCommandSet.Location = New System.Drawing.Point(152, 208)
        Me.cmbScienceCommandSet.Name = "cmbScienceCommandSet"
        Me.cmbScienceCommandSet.Size = New System.Drawing.Size(80, 21)
        Me.cmbScienceCommandSet.TabIndex = 38
        '
        'Label13
        '
        Me.Label13.Location = New System.Drawing.Point(24, 208)
        Me.Label13.Name = "Label13"
        Me.Label13.Size = New System.Drawing.Size(128, 24)
        Me.Label13.TabIndex = 37
        Me.Label13.Text = "ScienceCommandSet:"
        Me.Label13.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label13, "Does this faction have good or bad SpellStores?")
        '
        'cmbSpellBook
        '
        Me.cmbSpellBook.Items.AddRange(New Object() {"GoodSpellBook", "EvilSpellBook"})
        Me.cmbSpellBook.Location = New System.Drawing.Point(152, 184)
        Me.cmbSpellBook.Name = "cmbSpellBook"
        Me.cmbSpellBook.Size = New System.Drawing.Size(80, 21)
        Me.cmbSpellBook.TabIndex = 32
        '
        'Label10
        '
        Me.Label10.Location = New System.Drawing.Point(24, 184)
        Me.Label10.Name = "Label10"
        Me.Label10.Size = New System.Drawing.Size(128, 24)
        Me.Label10.TabIndex = 31
        Me.Label10.Text = "SpellBook:"
        Me.Label10.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label10, "Does this faction have good or bad Spellbooks?")
        '
        'cmbIntirinsicSciences
        '
        Me.cmbIntirinsicSciences.Items.AddRange(New Object() {"SCIENCE_GOOD", "SCIENCE_EVIL"})
        Me.cmbIntirinsicSciences.Location = New System.Drawing.Point(152, 160)
        Me.cmbIntirinsicSciences.Name = "cmbIntirinsicSciences"
        Me.cmbIntirinsicSciences.Size = New System.Drawing.Size(80, 21)
        Me.cmbIntirinsicSciences.TabIndex = 20
        '
        'Label8
        '
        Me.Label8.Location = New System.Drawing.Point(24, 160)
        Me.Label8.Name = "Label8"
        Me.Label8.Size = New System.Drawing.Size(128, 24)
        Me.Label8.TabIndex = 19
        Me.Label8.Text = "IntrinsicSciences:"
        Me.Label8.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label8, "Does this faction have good or bad Sciences?")
        '
        'cmbEvil
        '
        Me.cmbEvil.Items.AddRange(New Object() {"Yes", "No"})
        Me.cmbEvil.Location = New System.Drawing.Point(152, 88)
        Me.cmbEvil.Name = "cmbEvil"
        Me.cmbEvil.Size = New System.Drawing.Size(80, 21)
        Me.cmbEvil.TabIndex = 17
        '
        'cmbPlayableSide
        '
        Me.cmbPlayableSide.Items.AddRange(New Object() {"Yes", "No"})
        Me.cmbPlayableSide.Location = New System.Drawing.Point(152, 64)
        Me.cmbPlayableSide.Name = "cmbPlayableSide"
        Me.cmbPlayableSide.Size = New System.Drawing.Size(80, 21)
        Me.cmbPlayableSide.TabIndex = 16
        '
        'Label7
        '
        Me.Label7.Location = New System.Drawing.Point(24, 136)
        Me.Label7.Name = "Label7"
        Me.Label7.Size = New System.Drawing.Size(128, 24)
        Me.Label7.TabIndex = 15
        Me.Label7.Text = "Preferred Color:"
        Me.Label7.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label7, "This is the Factions preferred color if you were to face it in Skirmish.")
        '
        'Label6
        '
        Me.Label6.Location = New System.Drawing.Point(24, 112)
        Me.Label6.Name = "Label6"
        Me.Label6.Size = New System.Drawing.Size(128, 24)
        Me.Label6.TabIndex = 13
        Me.Label6.Text = "StartMoney:"
        Me.Label6.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label6, "By Defualt this should always be set as 0, unless you know exactly what your doin" & _
        "g.")
        '
        'txtStartMoney
        '
        Me.txtStartMoney.Location = New System.Drawing.Point(152, 112)
        Me.txtStartMoney.Name = "txtStartMoney"
        Me.txtStartMoney.Size = New System.Drawing.Size(80, 20)
        Me.txtStartMoney.TabIndex = 12
        Me.txtStartMoney.Text = "0"
        '
        'Label5
        '
        Me.Label5.Location = New System.Drawing.Point(24, 88)
        Me.Label5.Name = "Label5"
        Me.Label5.Size = New System.Drawing.Size(128, 24)
        Me.Label5.TabIndex = 11
        Me.Label5.Text = "Evil:"
        Me.Label5.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label5, "Is This faction evil? Example: Isengard and Mordor ar Evil while Gondor and Rohan" & _
        " are Good.")
        '
        'Label4
        '
        Me.Label4.Location = New System.Drawing.Point(24, 64)
        Me.Label4.Name = "Label4"
        Me.Label4.Size = New System.Drawing.Size(128, 24)
        Me.Label4.TabIndex = 9
        Me.Label4.Text = "Playable Side:"
        Me.Label4.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label4, "This should always be Yes, unless you dont want to play your team.")
        '
        'Label3
        '
        Me.Label3.Location = New System.Drawing.Point(24, 40)
        Me.Label3.Name = "Label3"
        Me.Label3.Size = New System.Drawing.Size(128, 24)
        Me.Label3.TabIndex = 7
        Me.Label3.Text = "Side:"
        Me.Label3.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label3, "This is used for the commandsets, Str String Files and all Objects for which side" & _
        " they are on.")
        '
        'Label2
        '
        Me.Label2.Location = New System.Drawing.Point(24, 16)
        Me.Label2.Name = "Label2"
        Me.Label2.Size = New System.Drawing.Size(128, 24)
        Me.Label2.TabIndex = 5
        Me.Label2.Text = "PlayerTemplate Faction:"
        Me.Label2.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label2, "This is your Factions Name Used only for player Template.ini")
        '
        'txtPlayerTemplateFaction
        '
        Me.txtPlayerTemplateFaction.Location = New System.Drawing.Point(152, 16)
        Me.txtPlayerTemplateFaction.Name = "txtPlayerTemplateFaction"
        Me.txtPlayerTemplateFaction.Size = New System.Drawing.Size(80, 20)
        Me.txtPlayerTemplateFaction.TabIndex = 4
        Me.txtPlayerTemplateFaction.Text = ""
        '
        'txtSide
        '
        Me.txtSide.Location = New System.Drawing.Point(152, 40)
        Me.txtSide.Name = "txtSide"
        Me.txtSide.Size = New System.Drawing.Size(80, 20)
        Me.txtSide.TabIndex = 6
        Me.txtSide.Text = ""
        '
        'grpSTR
        '
        Me.grpSTR.BackColor = System.Drawing.SystemColors.Control
        Me.grpSTR.Controls.Add(Me.txtFactionsUgradeText)
        Me.grpSTR.Controls.Add(Me.Label114)
        Me.grpSTR.Controls.Add(Me.txtFactionsArmiesName)
        Me.grpSTR.Controls.Add(Me.Label89)
        Me.grpSTR.Controls.Add(Me.txtFactionsDisplayedName)
        Me.grpSTR.Controls.Add(Me.Label90)
        Me.grpSTR.Location = New System.Drawing.Point(160, 272)
        Me.grpSTR.Name = "grpSTR"
        Me.grpSTR.Size = New System.Drawing.Size(240, 96)
        Me.grpSTR.TabIndex = 84
        Me.grpSTR.TabStop = False
        Me.grpSTR.Text = "STR File"
        '
        'txtFactionsUgradeText
        '
        Me.txtFactionsUgradeText.Location = New System.Drawing.Point(152, 64)
        Me.txtFactionsUgradeText.Name = "txtFactionsUgradeText"
        Me.txtFactionsUgradeText.Size = New System.Drawing.Size(80, 20)
        Me.txtFactionsUgradeText.TabIndex = 78
        Me.txtFactionsUgradeText.Text = ""
        '
        'Label114
        '
        Me.Label114.Location = New System.Drawing.Point(16, 64)
        Me.Label114.Name = "Label114"
        Me.Label114.Size = New System.Drawing.Size(136, 24)
        Me.Label114.TabIndex = 76
        Me.Label114.Text = "Factions Upgrade Text:"
        Me.Label114.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label114, "The purpose of this is Uknown, it's suggested to keep this to your Sides Name")
        '
        'txtFactionsArmiesName
        '
        Me.txtFactionsArmiesName.Location = New System.Drawing.Point(152, 40)
        Me.txtFactionsArmiesName.Name = "txtFactionsArmiesName"
        Me.txtFactionsArmiesName.Size = New System.Drawing.Size(80, 20)
        Me.txtFactionsArmiesName.TabIndex = 72
        Me.txtFactionsArmiesName.Text = ""
        '
        'Label89
        '
        Me.Label89.Location = New System.Drawing.Point(16, 40)
        Me.Label89.Name = "Label89"
        Me.Label89.Size = New System.Drawing.Size(136, 24)
        Me.Label89.TabIndex = 69
        Me.Label89.Text = "Factions Armies Name:"
        Me.Label89.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label89, "This is the name of your factions Living World Army")
        '
        'txtFactionsDisplayedName
        '
        Me.txtFactionsDisplayedName.Location = New System.Drawing.Point(152, 16)
        Me.txtFactionsDisplayedName.Name = "txtFactionsDisplayedName"
        Me.txtFactionsDisplayedName.Size = New System.Drawing.Size(80, 20)
        Me.txtFactionsDisplayedName.TabIndex = 71
        Me.txtFactionsDisplayedName.Text = ""
        '
        'Label90
        '
        Me.Label90.Location = New System.Drawing.Point(16, 16)
        Me.Label90.Name = "Label90"
        Me.Label90.Size = New System.Drawing.Size(136, 24)
        Me.Label90.TabIndex = 66
        Me.Label90.Text = "Factions Displayed Name:"
        Me.Label90.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label90, "This is the name displayed in game for the new faction. Also the name used for th" & _
        "e Living World Army")
        '
        'grpVictorySystem
        '
        Me.grpVictorySystem.BackColor = System.Drawing.SystemColors.Control
        Me.grpVictorySystem.Controls.Add(Me.Label9)
        Me.grpVictorySystem.Controls.Add(Me.txtMapToCellVictoryRatio)
        Me.grpVictorySystem.Controls.Add(Me.Label94)
        Me.grpVictorySystem.Controls.Add(Me.txtMajorUnitValue)
        Me.grpVictorySystem.Controls.Add(Me.Label95)
        Me.grpVictorySystem.Controls.Add(Me.txtVictoryThreshold)
        Me.grpVictorySystem.Controls.Add(Me.Label96)
        Me.grpVictorySystem.Controls.Add(Me.txtEnemyKillScaleFactor)
        Me.grpVictorySystem.Controls.Add(Me.Label97)
        Me.grpVictorySystem.Controls.Add(Me.txtAllyDeathScaleFactor)
        Me.grpVictorySystem.Location = New System.Drawing.Point(160, 120)
        Me.grpVictorySystem.Name = "grpVictorySystem"
        Me.grpVictorySystem.Size = New System.Drawing.Size(240, 144)
        Me.grpVictorySystem.TabIndex = 82
        Me.grpVictorySystem.TabStop = False
        Me.grpVictorySystem.Text = "VictorySystems.ini"
        '
        'Label9
        '
        Me.Label9.Location = New System.Drawing.Point(16, 16)
        Me.Label9.Name = "Label9"
        Me.Label9.Size = New System.Drawing.Size(144, 24)
        Me.Label9.TabIndex = 88
        Me.Label9.Text = "AllyDeathScaleFactor:"
        Me.Label9.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label9, "Value placed on special/major units (normal units are worth 1.0). Its Advised not" & _
        " to change these values.")
        '
        'txtMapToCellVictoryRatio
        '
        Me.txtMapToCellVictoryRatio.Location = New System.Drawing.Point(160, 112)
        Me.txtMapToCellVictoryRatio.Name = "txtMapToCellVictoryRatio"
        Me.txtMapToCellVictoryRatio.Size = New System.Drawing.Size(72, 20)
        Me.txtMapToCellVictoryRatio.TabIndex = 81
        Me.txtMapToCellVictoryRatio.Text = "0.8"
        '
        'Label94
        '
        Me.Label94.Location = New System.Drawing.Point(16, 112)
        Me.Label94.Name = "Label94"
        Me.Label94.Size = New System.Drawing.Size(144, 24)
        Me.Label94.TabIndex = 82
        Me.Label94.Text = "MapToCellVictoryRatio:"
        Me.Label94.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label94, "Factor of VictoryThreshold that a cell needs for a Victory, practical range " & vbCrLf & _
                                           "should be on the order of 0.2 and 1.0. Larger values make it more difficult " & vbCrLf & _
                                           "to achieve 'Victory'. Its Advised not to change these values.")
        '
        'txtMajorUnitValue
        '
        Me.txtMajorUnitValue.Location = New System.Drawing.Point(160, 88)
        Me.txtMajorUnitValue.Name = "txtMajorUnitValue"
        Me.txtMajorUnitValue.Size = New System.Drawing.Size(72, 20)
        Me.txtMajorUnitValue.TabIndex = 78
        Me.txtMajorUnitValue.Text = "10.0"
        '
        'Label95
        '
        Me.Label95.Location = New System.Drawing.Point(16, 88)
        Me.Label95.Name = "Label95"
        Me.Label95.Size = New System.Drawing.Size(144, 24)
        Me.Label95.TabIndex = 79
        Me.Label95.Text = "MajorUnitValue:"
        Me.Label95.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label95, "Value placed on special/major units (normal units are worth 1.0). Its Advised not" & _
        " to change these values.")
        '
        'txtVictoryThreshold
        '
        Me.txtVictoryThreshold.Location = New System.Drawing.Point(160, 64)
        Me.txtVictoryThreshold.Name = "txtVictoryThreshold"
        Me.txtVictoryThreshold.Size = New System.Drawing.Size(72, 20)
        Me.txtVictoryThreshold.TabIndex = 75
        Me.txtVictoryThreshold.Text = "200.0"
        '
        'Label96
        '
        Me.Label96.Location = New System.Drawing.Point(16, 64)
        Me.Label96.Name = "Label96"
        Me.Label96.Size = New System.Drawing.Size(144, 24)
        Me.Label96.TabIndex = 76
        Me.Label96.Text = "VictoryThreshold:"
        Me.Label96.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label96, "Thereshold needed for a 'Victory'. Its Advised not to change these values.")
        '
        'txtEnemyKillScaleFactor
        '
        Me.txtEnemyKillScaleFactor.Location = New System.Drawing.Point(160, 40)
        Me.txtEnemyKillScaleFactor.Name = "txtEnemyKillScaleFactor"
        Me.txtEnemyKillScaleFactor.Size = New System.Drawing.Size(72, 20)
        Me.txtEnemyKillScaleFactor.TabIndex = 72
        Me.txtEnemyKillScaleFactor.Text = "1.1"
        '
        'Label97
        '
        Me.Label97.Location = New System.Drawing.Point(16, 40)
        Me.Label97.Name = "Label97"
        Me.Label97.Size = New System.Drawing.Size(144, 24)
        Me.Label97.TabIndex = 73
        Me.Label97.Text = "EnemyKillScaleFactor:"
        Me.Label97.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        Me.ToolTip1.SetToolTip(Me.Label97, "Value this faction places on 'kills' of enemy units that it gets")
        '
        'txtAllyDeathScaleFactor
        '
        Me.txtAllyDeathScaleFactor.Location = New System.Drawing.Point(160, 16)
        Me.txtAllyDeathScaleFactor.Name = "txtAllyDeathScaleFactor"
        Me.txtAllyDeathScaleFactor.Size = New System.Drawing.Size(72, 20)
        Me.txtAllyDeathScaleFactor.TabIndex = 69
        Me.txtAllyDeathScaleFactor.Text = "1.0"
        '
        'Label98
        '
        Me.Label98.Location = New System.Drawing.Point(8, 16)
        Me.Label98.Name = "Label98"
        Me.Label98.Size = New System.Drawing.Size(144, 24)
        Me.Label98.TabIndex = 70
        Me.Label98.Text = "AllyDeathScaleFactor :"
        Me.Label98.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        '
        'chkIncludeCB
        '
        Me.chkIncludeCB.BackColor = System.Drawing.SystemColors.Control
        Me.chkIncludeCB.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.chkIncludeCB.Location = New System.Drawing.Point(168, 80)
        Me.chkIncludeCB.Name = "chkIncludeCB"
        Me.chkIncludeCB.Size = New System.Drawing.Size(224, 24)
        Me.chkIncludeCB.TabIndex = 20
        Me.chkIncludeCB.Text = "Include this in the Civilian Buildings.ini"
        '
        'chkIncludeFaction
        '
        Me.chkIncludeFaction.BackColor = System.Drawing.SystemColors.Control
        Me.chkIncludeFaction.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.chkIncludeFaction.Location = New System.Drawing.Point(168, 48)
        Me.chkIncludeFaction.Name = "chkIncludeFaction"
        Me.chkIncludeFaction.Size = New System.Drawing.Size(224, 16)
        Me.chkIncludeFaction.TabIndex = 2
        Me.chkIncludeFaction.Text = "Include this faction to be created"
        '
        'LinkLabel1
        '
        Me.LinkLabel1.Location = New System.Drawing.Point(560, 8)
        Me.LinkLabel1.Name = "LinkLabel1"
        Me.LinkLabel1.Size = New System.Drawing.Size(88, 16)
        Me.LinkLabel1.TabIndex = 21
        Me.LinkLabel1.TabStop = True
        Me.LinkLabel1.Text = "The3rdAge.Net "
        Me.LinkLabel1.TextAlign = System.Drawing.ContentAlignment.MiddleCenter
        '
        'GroupBox1
        '
        Me.GroupBox1.BackColor = System.Drawing.SystemColors.Control
        Me.GroupBox1.Controls.Add(Me.chkVS)
        Me.GroupBox1.Controls.Add(Me.chkU)
        Me.GroupBox1.Controls.Add(Me.chkS)
        Me.GroupBox1.Controls.Add(Me.chkSTR)
        Me.GroupBox1.Controls.Add(Me.chkCB)
        Me.GroupBox1.Controls.Add(Me.chkCS)
        Me.GroupBox1.Controls.Add(Me.chkPT)
        Me.GroupBox1.Controls.Add(Me.btnCreateFiles)
        Me.GroupBox1.Location = New System.Drawing.Point(8, 176)
        Me.GroupBox1.Name = "GroupBox1"
        Me.GroupBox1.Size = New System.Drawing.Size(144, 194)
        Me.GroupBox1.TabIndex = 19
        Me.GroupBox1.TabStop = False
        Me.GroupBox1.Text = "Create Files"
        '
        'chkVS
        '
        Me.chkVS.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.chkVS.Location = New System.Drawing.Point(8, 120)
        Me.chkVS.Name = "chkVS"
        Me.chkVS.Size = New System.Drawing.Size(120, 24)
        Me.chkVS.TabIndex = 16
        Me.chkVS.Text = "Victory System.ini"
        '
        'chkU
        '
        Me.chkU.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.chkU.Location = New System.Drawing.Point(8, 96)
        Me.chkU.Name = "chkU"
        Me.chkU.Size = New System.Drawing.Size(112, 24)
        Me.chkU.TabIndex = 15
        Me.chkU.Text = "Upgrade.ini"
        '
        'chkS
        '
        Me.chkS.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.chkS.Location = New System.Drawing.Point(8, 48)
        Me.chkS.Name = "chkS"
        Me.chkS.Size = New System.Drawing.Size(128, 24)
        Me.chkS.TabIndex = 13
        Me.chkS.Text = "Science.ini"
        '
        'chkSTR
        '
        Me.chkSTR.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.chkSTR.Location = New System.Drawing.Point(8, 144)
        Me.chkSTR.Name = "chkSTR"
        Me.chkSTR.Size = New System.Drawing.Size(120, 24)
        Me.chkSTR.TabIndex = 17
        Me.chkSTR.Text = "lotr.str"
        '
        'chkCB
        '
        Me.chkCB.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.chkCB.Location = New System.Drawing.Point(8, 168)
        Me.chkCB.Name = "chkCB"
        Me.chkCB.Size = New System.Drawing.Size(120, 24)
        Me.chkCB.TabIndex = 18
        Me.chkCB.Text = "Civilian Buildings.ini"
        '
        'chkCS
        '
        Me.chkCS.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.chkCS.Location = New System.Drawing.Point(8, 72)
        Me.chkCS.Name = "chkCS"
        Me.chkCS.Size = New System.Drawing.Size(128, 24)
        Me.chkCS.TabIndex = 14
        Me.chkCS.Text = "CommandSet.ini"
        '
        'chkPT
        '
        Me.chkPT.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.chkPT.Location = New System.Drawing.Point(8, 24)
        Me.chkPT.Name = "chkPT"
        Me.chkPT.Size = New System.Drawing.Size(128, 24)
        Me.chkPT.TabIndex = 12
        Me.chkPT.Text = "Player Template.ini"
        '
        'btnCreateFiles
        '
        Me.btnCreateFiles.FlatStyle = System.Windows.Forms.FlatStyle.System
        Me.btnCreateFiles.Location = New System.Drawing.Point(72, 0)
        Me.btnCreateFiles.Name = "btnCreateFiles"
        Me.btnCreateFiles.Size = New System.Drawing.Size(16, 16)
        Me.btnCreateFiles.TabIndex = 88
        Me.btnCreateFiles.Text = "?"
        '
        'picLogo
        '
        Me.picLogo.Image = CType(resources.GetObject("picLogo.Image"), System.Drawing.Image)
        Me.picLogo.Location = New System.Drawing.Point(776, 296)
        Me.picLogo.Name = "picLogo"
        Me.picLogo.Size = New System.Drawing.Size(392, 168)
        Me.picLogo.SizeMode = System.Windows.Forms.PictureBoxSizeMode.StretchImage
        Me.picLogo.TabIndex = 22
        Me.picLogo.TabStop = False
        '
        'Timer1
        '
        Me.Timer1.Enabled = True
        Me.Timer1.Interval = 1
        '
        'MainMenu1
        '
        Me.MainMenu1.MenuItems.AddRange(New System.Windows.Forms.MenuItem() {Me.btnFile, Me.btnEdit, Me.btnHelp})
        '
        'btnFile
        '
        Me.btnFile.Index = 0
        Me.btnFile.MenuItems.AddRange(New System.Windows.Forms.MenuItem() {Me.btnOpen, Me.btnCreate, Me.btnExit})
        Me.btnFile.Text = "&File"
        '
        'btnOpen
        '
        Me.btnOpen.Index = 0
        Me.btnOpen.Text = "&Open PlayerTemplate.ini"
        '
        'btnCreate
        '
        Me.btnCreate.Index = 1
        Me.btnCreate.Text = "&Create Faction(s)"
        '
        'btnExit
        '
        Me.btnExit.Index = 2
        Me.btnExit.Text = "&Exit"
        '
        'btnEdit
        '
        Me.btnEdit.Index = 1
        Me.btnEdit.MenuItems.AddRange(New System.Windows.Forms.MenuItem() {Me.btnAdd, Me.btnSetFaction})
        Me.btnEdit.Text = "&Edit"
        '
        'btnAdd
        '
        Me.btnAdd.Index = 0
        Me.btnAdd.Text = "&Add New Faction"
        '
        'btnSetFaction
        '
        Me.btnSetFaction.Index = 1
        Me.btnSetFaction.MenuItems.AddRange(New System.Windows.Forms.MenuItem() {Me.btnEvil, Me.btnGood})
        Me.btnSetFaction.Text = "Set Current Faction"
        '
        'btnEvil
        '
        Me.btnEvil.Index = 0
        Me.btnEvil.Text = "Evil"
        '
        'btnGood
        '
        Me.btnGood.Index = 1
        Me.btnGood.Text = "Good"
        '
        'btnHelp
        '
        Me.btnHelp.Index = 2
        Me.btnHelp.MenuItems.AddRange(New System.Windows.Forms.MenuItem() {Me.btnInstructions, Me.btnCredits, Me.MenuItem1})
        Me.btnHelp.Text = "&Help"
        '
        'btnInstructions
        '
        Me.btnInstructions.Index = 0
        Me.btnInstructions.Text = "&Instructions"
        '
        'btnCredits
        '
        Me.btnCredits.Index = 1
        Me.btnCredits.Text = "&Credits"
        '
        'MenuItem1
        '
        Me.MenuItem1.Index = 2
        Me.MenuItem1.Text = "&Tips"
        '
        'ToolTip1
        '
        Me.ToolTip1.AutomaticDelay = 200
        Me.ToolTip1.AutoPopDelay = 20000
        Me.ToolTip1.InitialDelay = 20
        Me.ToolTip1.ReshowDelay = 1
        '
        'btnInstructions2
        '
        Me.btnInstructions2.BackgroundImage = CType(resources.GetObject("btnInstructions2.BackgroundImage"), System.Drawing.Image)
        Me.btnInstructions2.Location = New System.Drawing.Point(176, 4)
        Me.btnInstructions2.Name = "btnInstructions2"
        Me.btnInstructions2.Size = New System.Drawing.Size(24, 24)
        Me.btnInstructions2.TabIndex = 93
        Me.ToolTip1.SetToolTip(Me.btnInstructions2, "Instructions")
        '
        'btnEvil2
        '
        Me.btnEvil2.BackgroundImage = CType(resources.GetObject("btnEvil2.BackgroundImage"), System.Drawing.Image)
        Me.btnEvil2.Location = New System.Drawing.Point(148, 4)
        Me.btnEvil2.Name = "btnEvil2"
        Me.btnEvil2.Size = New System.Drawing.Size(24, 24)
        Me.btnEvil2.TabIndex = 92
        Me.ToolTip1.SetToolTip(Me.btnEvil2, "Set Current Faction As Evil")
        '
        'btnAdd2
        '
        Me.btnAdd2.BackgroundImage = CType(resources.GetObject("btnAdd2.BackgroundImage"), System.Drawing.Image)
        Me.btnAdd2.Location = New System.Drawing.Point(92, 4)
        Me.btnAdd2.Name = "btnAdd2"
        Me.btnAdd2.Size = New System.Drawing.Size(24, 24)
        Me.btnAdd2.TabIndex = 91
        Me.ToolTip1.SetToolTip(Me.btnAdd2, "Add New Faction")
        '
        'btnNew2
        '
        Me.btnNew2.BackgroundImage = CType(resources.GetObject("btnNew2.BackgroundImage"), System.Drawing.Image)
        Me.btnNew2.Location = New System.Drawing.Point(64, 4)
        Me.btnNew2.Name = "btnNew2"
        Me.btnNew2.Size = New System.Drawing.Size(24, 24)
        Me.btnNew2.TabIndex = 90
        Me.ToolTip1.SetToolTip(Me.btnNew2, "Erase everything and start over with the 4 original factions")
        '
        'btnSave2
        '
        Me.btnSave2.BackgroundImage = CType(resources.GetObject("btnSave2.BackgroundImage"), System.Drawing.Image)
        Me.btnSave2.Location = New System.Drawing.Point(36, 4)
        Me.btnSave2.Name = "btnSave2"
        Me.btnSave2.Size = New System.Drawing.Size(24, 24)
        Me.btnSave2.TabIndex = 89
        Me.ToolTip1.SetToolTip(Me.btnSave2, "Create INI Files")
        '
        'btnOpen2
        '
        Me.btnOpen2.BackgroundImage = CType(resources.GetObject("btnOpen2.BackgroundImage"), System.Drawing.Image)
        Me.btnOpen2.Location = New System.Drawing.Point(8, 4)
        Me.btnOpen2.Name = "btnOpen2"
        Me.btnOpen2.Size = New System.Drawing.Size(24, 24)
        Me.btnOpen2.TabIndex = 88
        Me.ToolTip1.SetToolTip(Me.btnOpen2, "Open PlayerTemplate.ini")
        '
        'btnGood2
        '
        Me.btnGood2.BackgroundImage = CType(resources.GetObject("btnGood2.BackgroundImage"), System.Drawing.Image)
        Me.btnGood2.Location = New System.Drawing.Point(120, 4)
        Me.btnGood2.Name = "btnGood2"
        Me.btnGood2.Size = New System.Drawing.Size(24, 24)
        Me.btnGood2.TabIndex = 94
        Me.ToolTip1.SetToolTip(Me.btnGood2, "Set Current Faction as Good")
        '
        'btnTips2
        '
        Me.btnTips2.BackgroundImage = CType(resources.GetObject("btnTips2.BackgroundImage"), System.Drawing.Image)
        Me.btnTips2.Location = New System.Drawing.Point(204, 4)
        Me.btnTips2.Name = "btnTips2"
        Me.btnTips2.Size = New System.Drawing.Size(24, 24)
        Me.btnTips2.TabIndex = 95
        Me.ToolTip1.SetToolTip(Me.btnTips2, "Tips")
        '
        'btnCredits2
        '
        Me.btnCredits2.BackgroundImage = CType(resources.GetObject("btnCredits2.BackgroundImage"), System.Drawing.Image)
        Me.btnCredits2.Location = New System.Drawing.Point(232, 4)
        Me.btnCredits2.Name = "btnCredits2"
        Me.btnCredits2.Size = New System.Drawing.Size(24, 24)
        Me.btnCredits2.TabIndex = 96
        Me.ToolTip1.SetToolTip(Me.btnCredits2, "Credits")
        '
        'Status
        '
        Me.Status.Location = New System.Drawing.Point(0, 373)
        Me.Status.Name = "Status"
        Me.Status.Panels.AddRange(New System.Windows.Forms.StatusBarPanel() {Me.StatusBarPanel1, Me.StatusBarPanel2, Me.StatusBarPanel3})
        Me.Status.ShowPanels = True
        Me.Status.Size = New System.Drawing.Size(656, 22)
        Me.Status.TabIndex = 86
        '
        'StatusBarPanel1
        '
        Me.StatusBarPanel1.Text = "Current Faction = "
        Me.StatusBarPanel1.Width = 200
        '
        'StatusBarPanel2
        '
        Me.StatusBarPanel2.Text = "Factions to be created = "
        Me.StatusBarPanel2.Width = 160
        '
        'StatusBarPanel3
        '
        Me.StatusBarPanel3.Text = "Total Factions = "
        Me.StatusBarPanel3.Width = 300
        '
        'lstFactions
        '
        Me.lstFactions.Font = New System.Drawing.Font("Microsoft Sans Serif", 8.25!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.lstFactions.HorizontalScrollbar = True
        Me.lstFactions.IntegralHeight = False
        Me.lstFactions.Location = New System.Drawing.Point(8, 32)
        Me.lstFactions.Name = "lstFactions"
        Me.lstFactions.Size = New System.Drawing.Size(144, 136)
        Me.lstFactions.TabIndex = 87
        '
        'Label12
        '
        Me.Label12.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.Label12.Location = New System.Drawing.Point(448, 8)
        Me.Label12.Name = "Label12"
        Me.Label12.Size = New System.Drawing.Size(112, 16)
        Me.Label12.TabIndex = 97
        Me.Label12.Text = "For more on modding"
        Me.Label12.TextAlign = System.Drawing.ContentAlignment.MiddleRight
        '
        'Label11
        '
        Me.Label11.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D
        Me.Label11.Location = New System.Drawing.Point(0, 0)
        Me.Label11.Name = "Label11"
        Me.Label11.Size = New System.Drawing.Size(656, 32)
        Me.Label11.TabIndex = 98
        Me.Label11.TextAlign = System.Drawing.ContentAlignment.MiddleCenter
        '
        'Form1
        '
        Me.AutoScaleBaseSize = New System.Drawing.Size(5, 13)
        Me.BackColor = System.Drawing.SystemColors.Control
        Me.ClientSize = New System.Drawing.Size(656, 395)
        Me.Controls.Add(Me.Label12)
        Me.Controls.Add(Me.btnCredits2)
        Me.Controls.Add(Me.btnTips2)
        Me.Controls.Add(Me.btnGood2)
        Me.Controls.Add(Me.btnInstructions2)
        Me.Controls.Add(Me.btnEvil2)
        Me.Controls.Add(Me.btnAdd2)
        Me.Controls.Add(Me.btnNew2)
        Me.Controls.Add(Me.btnSave2)
        Me.Controls.Add(Me.btnOpen2)
        Me.Controls.Add(Me.lstFactions)
        Me.Controls.Add(Me.Status)
        Me.Controls.Add(Me.GrpPlayerTemplate)
        Me.Controls.Add(Me.grpSTR)
        Me.Controls.Add(Me.grpVictorySystem)
        Me.Controls.Add(Me.picLogo)
        Me.Controls.Add(Me.LinkLabel1)
        Me.Controls.Add(Me.GroupBox1)
        Me.Controls.Add(Me.chkIncludeCB)
        Me.Controls.Add(Me.chkIncludeFaction)
        Me.Controls.Add(Me.Label11)
        Me.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog
        Me.Icon = CType(resources.GetObject("$this.Icon"), System.Drawing.Icon)
        Me.Menu = Me.MainMenu1
        Me.Name = "Form1"
        Me.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen
        Me.Text = "{IP}Gil-Galad's Faction Creator (BFME)"
        Me.GrpPlayerTemplate.ResumeLayout(False)
        Me.grpSTR.ResumeLayout(False)
        Me.grpVictorySystem.ResumeLayout(False)
        Me.GroupBox1.ResumeLayout(False)
        CType(Me.StatusBarPanel1, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.StatusBarPanel2, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.StatusBarPanel3, System.ComponentModel.ISupportInitialize).EndInit()
        Me.ResumeLayout(False)

    End Sub
#End Region
#Region " Class-level Variables "
    Dim Fact(100) As Faction
    Dim FactNum As Integer = 3
    Dim i As Integer
    Dim FormLoaded As Boolean = False
#End Region
#Region " Update Current Factions Info "
    Private Sub cmbEvil_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmbEvil.SelectedIndexChanged
        If FormLoaded = True Then
            Fact(i).Evil = cmbEvil.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub cmbSpellBook_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmbSpellBook.SelectedIndexChanged
        If FormLoaded = True Then
            Fact(i).SpellBook = cmbSpellBook.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub cmbScienceCommandSet_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmbScienceCommandSet.SelectedIndexChanged
        If FormLoaded = True Then
            Fact(i).ScienceCommandSet = cmbScienceCommandSet.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtDefaultPlayerAIType_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtDefaultPlayerAIType.SelectedIndexChanged
        If FormLoaded = True Then
            Fact(i).DefaultPlayerAIType = txtDefaultPlayerAIType.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtFactionsDisplayedName_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtFactionsDisplayedName.TextChanged
        If FormLoaded = True Then
            Fact(i).FactionsDisplayedName = txtFactionsDisplayedName.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtFactionsArmiesName_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtFactionsArmiesName.TextChanged
        If FormLoaded = True Then
            Fact(i).FactionsArmiesName = txtFactionsArmiesName.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtBuildableHerosMP_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtBuildableHerosMP.TextChanged
        If FormLoaded = True Then
            Fact(i).BuildableHerosMP = txtBuildableHerosMP.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtFactionsUgradeText_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtFactionsUgradeText.TextChanged
        If FormLoaded = True Then
            Fact(i).FactionsUpgradeText = txtFactionsUgradeText.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub cmbLightPointsSound_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmbLightPointsSound.SelectedIndexChanged
        If FormLoaded = True Then
            Fact(i).LightPointsSound = cmbLightPointsSound.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtInitialUpgrades_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtInitialUpgrades.TextChanged
        If FormLoaded = True Then
            Fact(i).InitialUpgrades = txtInitialUpgrades.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtEnemyKillScaleFactor_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtEnemyKillScaleFactor.TextChanged
        If FormLoaded = True Then
            Fact(i).EnemyKillScaleFactor = txtEnemyKillScaleFactor.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtAllyDeathScaleFactor_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtAllyDeathScaleFactor.TextChanged
        If FormLoaded = True Then
            Fact(i).AllyDeathScaleFactor = txtAllyDeathScaleFactor.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtSide_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtSide.TextChanged
        If FormLoaded = True Then
            Fact(i).Side = txtSide.Text
            UpdateTextBoxes()
            UpdateList()
        End If
    End Sub
    Private Sub txtPlayerTemplateFaction_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtPlayerTemplateFaction.TextChanged
        If FormLoaded = True Then
            Fact(i).FactionName = txtPlayerTemplateFaction.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtVictoryThreshold_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtVictoryThreshold.TextChanged
        If FormLoaded = True Then
            Fact(i).VictoryThreshhold = txtVictoryThreshold.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtMajorUnitValue_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtMajorUnitValue.TextChanged
        If FormLoaded = True Then
            Fact(i).MajorUnitValue = txtMajorUnitValue.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtStartMoney_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtStartMoney.TextChanged
        If FormLoaded = True Then
            Fact(i).StartMoney = txtStartMoney.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub cmbPlayableSide_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmbPlayableSide.SelectedIndexChanged
        If FormLoaded = True Then
            Fact(i).PlayableSide = cmbPlayableSide.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub txtMapToCellVictoryRatio_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles txtMapToCellVictoryRatio.TextChanged
        If FormLoaded = True Then
            Fact(i).MapToCellVictoryRatio = txtMapToCellVictoryRatio.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub cmbIntirinsicSciences_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmbIntirinsicSciences.SelectedIndexChanged
        If FormLoaded = True Then
            Fact(i).IntrinsicSciences = cmbIntirinsicSciences.Text
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub btnColor_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnColor.Click
        If FormLoaded = True Then
            ColorDialog1.FullOpen = True
            If ColorDialog1.ShowDialog() = DialogResult.OK Then
                Fact(i).PreferredColor = ColorDialog1.Color
                UpdateTextBoxes()
            End If
        End If
    End Sub
    Private Sub chkIncludeFaction_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles chkIncludeFaction.CheckedChanged
        If FormLoaded = True Then
            Fact(i).CreateFaction = chkIncludeFaction.Checked
            UpdateTextBoxes()
        End If
    End Sub
    Private Sub chkIncludeCB_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles chkIncludeCB.CheckedChanged
        Fact(i).CreateCB = chkIncludeCB.Checked
        If chkIncludeCB.Checked = False Then
            If MsgBox("This will take faction " & Fact(i).Side & " out of the CivilianBuildings.ini" & vbCrLf & "meaning that this faction will not be playable are you sure?", MsgBoxStyle.YesNo, "Attention") = MsgBoxResult.Yes Then
                Fact(i).CreateCB = False
            Else
                Fact(i).CreateCB = True
            End If
        End If
        UpdateTextBoxes()
    End Sub
#End Region
#Region " Subs / Functions "
    Sub UpdateTextBoxes()
        Dim Fact2BCreated As Integer
        For ii As Integer = 0 To FactNum
            If Fact(ii).CreateFaction = True Then
                Fact2BCreated += 1
            End If
        Next
        Status.Panels(1).Text = "Factions to be created = " & Fact2BCreated
        Status.Panels(2).Text = "Total Factions = " & FactNum + 1
        Status.Panels(0).Text = "Current Faction = " & Fact(i).Side
        lblColor.BackColor = Fact(i).PreferredColor
        txtSide.Text = Fact(i).Side
        txtStartMoney.Text = Fact(i).StartMoney
        txtVictoryThreshold.Text = Fact(i).VictoryThreshhold
        cmbSpellBook.Text = Fact(i).SpellBook
        cmbScienceCommandSet.Text = Fact(i).ScienceCommandSet
        cmbPlayableSide.Text = Fact(i).PlayableSide
        txtMapToCellVictoryRatio.Text = Fact(i).MapToCellVictoryRatio
        txtMajorUnitValue.Text = Fact(i).MajorUnitValue
        cmbLightPointsSound.Text = Fact(i).LightPointsSound
        cmbIntirinsicSciences.Text = Fact(i).IntrinsicSciences
        txtInitialUpgrades.Text = Fact(i).InitialUpgrades
        txtPlayerTemplateFaction.Text = Fact(i).FactionName
        txtFactionsDisplayedName.Text = Fact(i).FactionsDisplayedName
        txtFactionsUgradeText.Text = Fact(i).FactionsUpgradeText
        txtFactionsArmiesName.Text = Fact(i).FactionsArmiesName
        cmbEvil.Text = Fact(i).Evil
        txtBuildableHerosMP.Text = Fact(i).BuildableHerosMP
        chkIncludeFaction.Checked = Fact(i).CreateFaction
        txtAllyDeathScaleFactor.Text = Fact(i).AllyDeathScaleFactor
        txtDefaultPlayerAIType.Text = Fact(i).DefaultPlayerAIType
        txtEnemyKillScaleFactor.Text = Fact(i).EnemyKillScaleFactor
        chkIncludeCB.Checked = Fact(i).CreateCB
    End Sub
    Sub UpdateList()
        lstFactions.Items.Clear()
        For ii As Integer = 0 To FactNum
            lstFactions.Items.Add(Fact(ii).Side)
        Next
    End Sub
    Sub SetValues()
        Fact(i).Evil = cmbEvil.SelectedItem
        Fact(i).SpellBook = cmbSpellBook.SelectedItem
        Fact(i).ScienceCommandSet = cmbScienceCommandSet.SelectedItem
        Fact(i).DefaultPlayerAIType = txtDefaultPlayerAIType.SelectedItem
        Fact(i).FactionsDisplayedName = txtFactionsDisplayedName.Text
        Fact(i).FactionsArmiesName = txtFactionsArmiesName.Text
        Fact(i).BuildableHerosMP = txtBuildableHerosMP.Text
        Fact(i).FactionsUpgradeText = txtFactionsUgradeText.Text
        Fact(i).LightPointsSound = cmbLightPointsSound.SelectedItem
        Fact(i).InitialUpgrades = txtInitialUpgrades.Text
        Fact(i).EnemyKillScaleFactor = txtEnemyKillScaleFactor.Text
        Fact(i).AllyDeathScaleFactor = txtAllyDeathScaleFactor.Text
        Fact(i).CreateFaction = chkIncludeFaction.Checked
        Fact(i).IntrinsicSciences = cmbIntirinsicSciences.SelectedItem
        Fact(i).MapToCellVictoryRatio = txtMapToCellVictoryRatio.Text
        Fact(i).PlayableSide = cmbPlayableSide.SelectedItem
        Fact(i).StartMoney = txtStartMoney.Text
        Fact(i).MajorUnitValue = txtMajorUnitValue.Text
        Fact(i).VictoryThreshhold = txtVictoryThreshold.Text
        Fact(i).FactionName = txtPlayerTemplateFaction.Text
        Fact(i).Side = txtSide.Text
        Fact(i).AllyDeathScaleFactor = txtAllyDeathScaleFactor.Text
    End Sub
    Sub CreatePlayerTemplate(ByVal create As Boolean)
        If create = True Then
            Dim swPT As IO.StreamWriter = IO.File.CreateText("Playertemplate.ini")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateFaction = True Then
                    With swPT
                        .WriteLine("PlayerTemplate Faction" & Fact(f).FactionName)
                        .WriteLine("        Side = " & Fact(f).Side)
                        .WriteLine("        PlayableSide = " & Fact(f).PlayableSide)
                        .WriteLine("        Evil = " & Fact(f).Evil)
                        .WriteLine("        StartMoney = " & Fact(f).StartMoney)
                        .WriteLine("        MaxLevelMP = 34")
                        .WriteLine("        MaxLevelSP = 78")
                        .WriteLine("        PreferredColor = " & "R:" & Fact(f).PreferredColor.R & " G:" & Fact(f).PreferredColor.G & " B:" & Fact(f).PreferredColor.B)
                        .WriteLine("        IntrinsicSciences = " & Fact(f).IntrinsicSciences)
                        .WriteLine("        IntrinsicSciencesMP = SCIENCE_" & Fact(f).Side.ToUpper)
                        .WriteLine("        SpellBook = " & Fact(f).SpellBook)
                        .WriteLine("        SpellBookMp = " & Fact(f).Side & "SpellBook")
                        .WriteLine("        PurchaseScienceCommandSet = " & Fact(f).ScienceCommandSet)
                        .WriteLine("        PurchaseScienceCommandSetMP = " & Fact(f).Side & "SpellStoreCommandSet")
                        .WriteLine("        DisplayName = INI:Faction" & Fact(f).Side)
                        .WriteLine("        DefaultPlayerAIType = " & Fact(f).DefaultPlayerAIType)
                        .WriteLine("        BeaconName = MultiplayerBeacon")
                        .WriteLine("        LightPointsUpSound = " & Fact(f).LightPointsSound)
                        .WriteLine("        ObjectiveAddedSound = " & Fact(f).ObjectiveAddedSound)
                        .WriteLine("        ObjectiveCompletedSound = " & Fact(f).ObjectiveCompleteSound)
                        .WriteLine("        InitialUpgrades	= Upgrade_" & Fact(f).Side & "Faction " & Fact(f).InitialUpgrades)
                        .WriteLine("        BuildableHeroesMP = " & Fact(f).BuildableHerosMP)
                        .WriteLine("        SpellStoreCurrentPowerLabel = APT:SpellStoreCurrentEvenstarPower")
                        .WriteLine("        SpellStoreMaximumPowerLabel = APT:SpellStoreMaximumEvenstarPower")
                        .WriteLine("End")
                        .WriteLine("")
                        .WriteLine("")
                    End With
                End If
            Next
            swPT.Close()
        End If
    End Sub
    Sub createScience(ByVal create As Boolean)
        If create = True Then
            Dim swS As IO.StreamWriter = IO.File.CreateText("Science.ini")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateFaction = True Then
                    With swS
                        .WriteLine("Science SCIENCE_" & Fact(f).Side.ToUpper)
                        .WriteLine("        PrerequisiteSciences = " & Fact(f).PrerequisiteSciences)
                        .WriteLine("        SciencePurchasePointCost = " & Fact(f).SciencePurchasePointCost)
                        .WriteLine("        IsGrantable = " & Fact(f).IsGrantable)
                        .WriteLine("End")
                        .WriteLine("")
                        .WriteLine("")
                    End With
                End If
            Next
            swS.Close()
        End If
    End Sub
    Sub CreateUpgrade(ByVal create As Boolean)
        If create = True Then
            Dim swU As IO.StreamWriter = IO.File.CreateText("Upgrade.ini")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateFaction = True Then
                    With swU
                        .WriteLine("Upgrade Upgrade_" & Fact(f).Side & "Faction")
                        .WriteLine("        DisplayName = UPGRADE:" & Fact(f).Side & "Faction")
                        .WriteLine("        Type = PLAYER")
                        .WriteLine("End")
                        .WriteLine("")
                        .WriteLine("")
                    End With
                End If
            Next
            swU.Close()
        End If
    End Sub
    Sub CreateVictorySystem(ByVal create As Boolean)
        If create = True Then
            Dim swVS As IO.StreamWriter = IO.File.CreateText("VictorySystem.ini")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateFaction = True Then
                    With swVS
                        .WriteLine("FactionVictoryData " & Fact(f).Side)
                        .WriteLine("        AllyDeathScaleFactor = " & Fact(f).AllyDeathScaleFactor)
                        .WriteLine("        EnemyKillScaleFactor = " & Fact(f).EnemyKillScaleFactor)
                        .WriteLine("        VictoryThreshold = " & Fact(f).VictoryThreshhold)
                        .WriteLine("        MajorUnitValue = " & Fact(f).MajorUnitValue)
                        .WriteLine("        MapToCellVictoryRatio = " & Fact(f).MapToCellVictoryRatio)
                        .WriteLine("End")
                        .WriteLine("")
                        .WriteLine("")
                    End With
                End If
            Next
            swVS.Close()
        End If
    End Sub
    Sub CreateCommandSet(ByVal create As Boolean)
        If create = True Then
            Dim swCS As IO.StreamWriter = IO.File.CreateText("CommandSet.ini")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateFaction = True Then
                    With swCS
                        .WriteLine("CommandSet " & Fact(f).Side & "SpellStoreCommandSet")
                        .WriteLine(";Put SpellStore CommandButtons Here")
                        .WriteLine("End")
                        .WriteLine("")
                        .WriteLine("CommandSet " & Fact(f).Side & "SpellBookCommandSet")
                        .WriteLine(";Put SpellBook CommandButtons Here")
                        .WriteLine("End")
                        .WriteLine("")
                        .WriteLine("")
                    End With
                End If
            Next
            swCS.Close()
        End If
    End Sub
    Sub CreateSTR(ByVal create As Boolean)
        If create = True Then
            Dim swSTR As IO.StreamWriter = IO.File.CreateText("lotr.str")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateFaction = True Then
                    With swSTR
                        .WriteLine("INI:Faction" & Fact(f).Side)
                        .WriteLine(" " & Chr(34) & Fact(f).FactionsDisplayedName & Chr(34))
                        .WriteLine("END")
                        .WriteLine()
                        .WriteLine("SIDE:" & Fact(f).Side)
                        .WriteLine(" " & Chr(34) & Fact(f).FactionsDisplayedName & Chr(34))
                        .WriteLine("END")
                        .WriteLine()
                        .WriteLine("LWA:" & Fact(f).Side)
                        .WriteLine(" " & Chr(34) & Fact(f).FactionsDisplayedName & Chr(34))
                        .WriteLine("END")
                        .WriteLine()
                        .WriteLine("LWA:" & Fact(f).Side & "Army")
                        .WriteLine(" " & Chr(34) & Fact(f).FactionsArmiesName & Chr(34))
                        .WriteLine("END")
                        .WriteLine()
                        .WriteLine("UPGRADE:" & Fact(f).Side & "Faction")
                        .WriteLine(" " & Chr(34) & Fact(f).FactionsUpgradeText & Chr(34))
                        .WriteLine("END")
                        .WriteLine("")
                        .WriteLine("")
                    End With
                End If
            Next
            swSTR.Close()
        End If
    End Sub
    Sub CreateReadMe(ByVal create As Boolean)
        If create = True Then
            Dim swRM As IO.StreamWriter = IO.File.CreateText("Read Me - Info On Factions Just Created.txt")
            With swRM
                .WriteLine(";This Was created by Phils ({IP}Gil-Galad) Faction Creator")
                .WriteLine(";Factions Created:" & Date.Today)
                .WriteLine("")
            End With
            For f As Integer = 0 To FactNum
                If Fact(f).CreateFaction = True Then
                    With swRM
                        .WriteLine(";" & Fact(f).Side & " Info:")
                        If chkCB.Checked = True And Fact(f).CreateCB = True Then
                            .WriteLine("Camp Name = " & vbTab & "Camp_" & Fact(f).Side)
                            .WriteLine("CampNW Name = " & vbTab & "Camp_" & Fact(f).Side & "NW")
                            .WriteLine("CampNE Name = " & vbTab & "Camp_" & Fact(f).Side & "NE")
                            .WriteLine("CampSW Name = " & vbTab & "Camp_" & Fact(f).Side & "SW")
                            .WriteLine("CampSE Name = " & vbTab & "Camp_" & Fact(f).Side & "SE")
                            .WriteLine("CastleNW Name = " & vbTab & "Castle_" & Fact(f).Side & "NW")
                            .WriteLine("CastleNE Name = " & vbTab & "Castle_" & Fact(f).Side & "NE")
                            .WriteLine("CastleSW Name = " & vbTab & "Castle_" & Fact(f).Side & "SW")
                            .WriteLine("CastleSE Name = " & vbTab & "Castle_" & Fact(f).Side & "SE")
                            .WriteLine("Expansion Name = " & vbTab & "Expansion_" & Fact(f).Side)
                            .WriteLine("Farm Name = " & vbTab & "Farm_" & Fact(f).Side)
                            .WriteLine("Single Name = " & vbTab & "Single_" & Fact(f).Side)
                            .WriteLine("")
                            .WriteLine("")
                        End If
                    End With
                End If
            Next
            swRM.Close()
        End If
    End Sub
    Sub CreateCivilianBuildings(ByVal create As Boolean)
        If create = True Then
            Dim swCBINIFILE As IO.StreamWriter = IO.File.CreateText("CivilianBuildings.INI")
            Dim Farm_(FactNum) As String
            Dim Camp_(FactNum) As String
            Dim CampSW_(FactNum) As String
            Dim CampSE_(FactNum) As String
            Dim CampNE_(FactNum) As String
            Dim CampNW_(FactNum) As String
            Dim Expansion_(FactNum) As String
            Dim Castle_(FactNum) As String
            Dim CastleSW_(FactNum) As String
            Dim CastleSE_(FactNum) As String
            Dim CastleNW_(FactNum) As String
            Dim CastleNE_(FactNum) As String
            Dim Single_(FactNum) As String
            Dim FarmPrice(FactNum) As String
            Dim FarmPrice2(FactNum) As String
            Farm_(0) = " Farm_" & Fact(0).Side
            Farm_(1) = " EconomyFarm_" & Fact(1).Side
            Farm_(2) = " Lumbermill_" & Fact(2).Side
        If Fact(3).Side = "Isengard" Then
                Farm_(3) = " Lumbermill_Mordor"
        Else
                Farm_(3) = " Lumbermill_" & Fact(3).Side
        End If
        For f As Integer = 4 To FactNum
                Farm_(f) = " Farm_" & Fact(f).side
        Next
            Camp_(0) = " Camp_" & Fact(0).Side
            Camp_(1) = " Camp_" & Fact(1).Side
            Camp_(2) = " Camp_" & Fact(2).Side
            Camp_(3) = " Camp_" & Fact(3).Side
        For f As Integer = 4 To FactNum
                Camp_(f) = " Camp_" & Fact(f).side
        Next
        For f As Integer = 0 To FactNum
                Castle_(f) = "Castle_" & Fact(f).side
                CampSW_(f) = " Camp_" & Fact(f).Side & "SW"
                CampNE_(f) = " Camp_" & Fact(f).Side & "NE"
                CampSE_(f) = " Camp_" & Fact(f).Side & "SE"
                CampNW_(f) = " Camp_" & Fact(f).Side & "NW"
                CastleSW_(f) = " Castle_" & Fact(f).Side & "SW"
                CastleNE_(f) = " Castle_" & Fact(f).Side & "NE"
                CastleSE_(f) = " Castle_" & Fact(f).Side & "SE"
                CastleNW_(f) = " Castle_" & Fact(f).Side & "NW"
                Expansion_(f) = " Expansion_" & Fact(f).Side
                Single_(f) = " Single_" & Fact(f).side
        Next
            FarmPrice(0) = " 200" : FarmPrice(1) = " 5000"
        For f As Integer = 2 To FactNum
                FarmPrice(f) = " 200"
        Next
            FarmPrice2(0) = " 200" : FarmPrice2(1) = " 5000 0"
        For f As Integer = 2 To FactNum
                FarmPrice2(f) = " 200"
        Next
        With swCBINIFILE
            .WriteLine("; FILE: CivilianBuilding.ini //////////////////////////////////////////////////")
            .WriteLine("; This file contains only buildings that are not part of any specific")
            .WriteLine("; game faction.  Here is where you will find " & Chr(34) & "neutral" & Chr(34) & "buildings and")
            .WriteLine("; any related objects to those buildings (such as debris or bibs)")
            .WriteLine(";//////////////////////////////////////////////////////////////////////////////")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("Object BaseCenterGeneric")
            .WriteLine("	EditorSorting   = SYSTEM")
            .WriteLine("")
            .WriteLine("	Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("")
            .WriteLine("    	DefaultModelConditionState")
            .WriteLine("      		Model = None")
            .WriteLine("    	End")
            .WriteLine("    	")
            .WriteLine("		ModelConditionState = WORLD_BUILDER")
            .WriteLine("			Model = NBasePin")
            .WriteLine("		End")
            .WriteLine("	End")
            .WriteLine("	")
            .WriteLine("	KindOf = IMMOBILE BASE_FOUNDATION CASTLE_CENTER")
            .WriteLine("  ")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("")
    .Writeline("  		UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline(";		MaxCastleRadius = 100.0")
    .Writeline("	End  ")
    .Writeline("End")
    .Writeline("")
    .Writeline(";----------------------------------------------------------")
    .Writeline("")
    .Writeline("Object CampFlag")
    .Writeline("")
    .Writeline(";SelectPortrait = BPRCamp")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("    	    OkToChangeModelColor  = Yes")
    .Writeline("   	DefaultModelConditionState")
    .Writeline("   		Model = NONE	;NCampsite_SKN ; This is supposed to be invisable.... S.O.")
    .Writeline(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
    .Writeline("   	End")
    .Writeline("	ModelConditionState = WORLD_BUILDER")
    .Writeline("		Model = NBasePin")
    .Writeline("	End")
    .Writeline("    IdleAnimationState")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("    End    ")
    .Writeline("	AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NCampsite_SKL.NCampsite_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End	    ")
    .Writeline("	AnimationState = UNPACKING")
    .Writeline("		Animation")
    .Writeline("			AnimationName = NCampsite_SKL.NCampsite_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End")
    .Writeline("	AnimationState = PACKING")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
    .Writeline("			AnimationMode = LOOP")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("	End	    ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("	Draw = W3DFloorDraw DrawFloorBib    ")
    .Writeline("		ModelName = NCampsite_Bib")
    .Writeline("	End")
    .Writeline(";----------------------- AUDIO -------------------------")
    .Writeline("")
    .Writeline("	VoiceSelect		= Gui_PlotSelect")
    .Writeline("")
    .Writeline("")
    .Writeline("	; ***DESIGN parameters ***")
    .Writeline("	DisplayName         = OBJECT:CampFlag  ")
    .Writeline("	EditorSorting   = STRUCTURE")
    .Writeline("	Side            = Civilian")
    .Writeline("	ArmorSet")
    .Writeline("		Conditions      = None")
    .Writeline("		Armor           = InvulnerableArmor")
    .Writeline("		DamageFX        = EmptyDamageFX   ; just to avoid an assert")
    .Writeline("	End")
    .Writeline("")
    .Writeline("	CommandSet = CampFlagCommandSet")
    .Writeline("")
    .Writeline("	; *** ENGINEERING Parameters ***  ")
    .Writeline("	RadarPriority       = STRUCTURE")
    .Writeline("	KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
    .Writeline("	Body                = ImmortalBody ModuleTag_02")
    .Writeline("		MaxHealth       = 1")
    .Writeline("	End  ")
    .Writeline("	  ")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline("")
            .WriteLine("  		UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                        .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Camp_(f) & " 2000")
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("")
    .Writeline("		;FactionDecal = Gondor		GBCampFloor		675.0")
    .Writeline("		;FactionDecal = Rohan		IBCampFloor		650.0")
    .Writeline("		;FactionDecal = Mordor		MBCampFloor		650.0")
    .Writeline("		;FactionDecal = Isengard		IBCampFloor		650.0")
    .Writeline("		")
    .Writeline("		MaxCastleRadius = 280.0")
    .Writeline("		FadeTime = 2.0 ; 2 seconds")
    .Writeline("		")
    .Writeline("	End  ")
    .Writeline("  ")
    .Writeline("	Geometry            = CYLINDER")
    .Writeline("	GeometryMajorRadius = 24.0")
    .Writeline("	GeometryMinorRadius = 24.0")
    .Writeline("	GeometryHeight      = 24.0")
    .Writeline("	GeometryIsSmall     = No")
    .Writeline("	Shadow				= SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("")
    .Writeline("Object CastleFlag")
    .Writeline("")
    .Writeline(";SelectPortrait = BPRCamp")
    .Writeline("")
    .Writeline(" ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("      OkToChangeModelColor  = Yes")
    .Writeline("   	DefaultModelConditionState")
    .Writeline("   		Model = NCastle_SKN")
    .Writeline(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone05 TorchGlow FollowBone:Yes")
    .Writeline("   	End")
    .Writeline("	ModelConditionState = WORLD_BUILDER")
    .Writeline("		Model = NBasePin")
    .Writeline("	End")
    .Writeline("    IdleAnimationState")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NCastle_SKL.NCastle_IDLA")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("    End    ")
    .Writeline("	AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NCastle_SKL.NCastle_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End	    ")
    .Writeline("	AnimationState = UNPACKING")
    .Writeline("		Animation")
    .Writeline("			AnimationName = NCastle_SKL.NCastle_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End")
    .Writeline("	AnimationState = PACKING")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NCastle_SKL.NCastle_IDLA")
    .Writeline("			AnimationMode = LOOP")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("	End	    ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("")
    .Writeline(";----------------------- AUDIO -------------------------")
    .Writeline("")
    .Writeline("	VoiceSelect		= Gui_PlotSelect")
    .Writeline("")
    .Writeline("")
    .Writeline("	; ***DESIGN parameters ***")
    .Writeline("	DisplayName         = OBJECT:CastleFlag    ")
    .Writeline("	EditorSorting   = STRUCTURE")
    .Writeline("	Side            = Civilian")
    .Writeline("	ArmorSet")
    .Writeline("		Conditions      = None")
    .Writeline("		Armor           = InvulnerableArmor")
    .Writeline("		DamageFX        = EmptyDamageFX   ; just to avoid an assert")
    .Writeline("	End")
    .Writeline("")
    .Writeline("	CommandSet = CastleFlagCommandSet")
    .Writeline("	   ")
    .Writeline("	; *** ENGINEERING Parameters ***  ")
    .Writeline("	RadarPriority       = STRUCTURE")
    .Writeline("	KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
    .Writeline("	Body                = ImmortalBody  ModuleTag_02")
    .Writeline("		MaxHealth       = 1.0")
    .Writeline("	End  ")
    .Writeline("	  ")
    .Writeline("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("		UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline("	  ")
            .WriteLine("		UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                        .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Castle_(f) & " 5000")
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("		MaxCastleRadius = 420.0")
    .Writeline("		ScanDistance = 150")
    .Writeline("	End  ")
    .Writeline("	  ")
    .Writeline("	Geometry				= BOX")
    .Writeline("	GeometryName			= CampFlag")
    .Writeline("	GeometryMajorRadius	= 52.0")
    .Writeline("	GeometryMinorRadius	= 52.0")
    .Writeline("	GeometryHeight		= 24.0")
    .Writeline("	GeometryIsSmall		= No")
    .Writeline("	Shadow				= SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline("ChildObject CastleFlagNW CastleFlag")
    .Writeline("	; *** ART Parameters ***")
    .Writeline("  	Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  	    OkToChangeModelColor  = Yes")
    .Writeline("   		DefaultModelConditionState")
    .Writeline("   			Model = NCastle_SKN")
    .Writeline(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone05 TorchGlow FollowBone:Yes")
    .Writeline("	   	End")
    .Writeline("		ModelConditionState = WORLD_BUILDER")
    .Writeline("			Model = Castle_FlagNW")
    .Writeline("		End")
    .Writeline("    	IdleAnimationState")
    .Writeline("			Animation = flag")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_IDLA")
    .Writeline("				AnimationMode = ONCE")
    .Writeline("				AnimationBlendTime = 90")
    .Writeline("			End")
    .Writeline("    	End    ")
    .Writeline("		AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("			Animation = flag")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_A")
    .Writeline("				AnimationMode = ONCE")
    .Writeline("				AnimationBlendTime = 0")
    .Writeline("			End")
    .Writeline("			Flags = START_FRAME_LAST")
    .Writeline("		End	    ")
    .Writeline("		AnimationState = UNPACKING")
    .Writeline("			Animation")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_A")
    .Writeline("				AnimationMode = ONCE	")
    .Writeline("				AnimationBlendTime = 90")
    .Writeline("			End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("		End")
    .Writeline("		AnimationState = PACKING")
    .Writeline("			Animation = flag")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_IDLA")
    .Writeline("				AnimationMode = LOOP")
    .Writeline("				AnimationBlendTime = 90")
    .Writeline("			End")
    .Writeline("		End	    ")
    .Writeline("  	End")
    .Writeline("")
    .Writeline("	Behavior = CastleBehavior ModuleTag_castle")
                For f As Integer = 0 To FactNum
                    If Fact(f).CreateCB = True Then
                        .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                    End If
                Next
    .Writeline("		UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline("	    UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                        .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & CastleNW_(f) & " 5000")
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("		MaxCastleRadius = 420.0")
    .Writeline("		ScanDistance = 150")
    .Writeline("	End  ")
    .Writeline("End")
    .Writeline("")
    .Writeline("ChildObject CastleFlagNE CastleFlag")
    .Writeline("; *** ART Parameters ***")
    .Writeline("  	Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  	    OkToChangeModelColor  = Yes")
    .Writeline("   		DefaultModelConditionState")
    .Writeline("   			Model = NCastle_SKN")
    .Writeline(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone05 TorchGlow FollowBone:Yes")
    .Writeline("	   	End")
    .Writeline("		ModelConditionState = WORLD_BUILDER")
    .Writeline("			Model = Castle_FlagNE")
    .Writeline("		End")
    .Writeline("    	IdleAnimationState")
    .Writeline("			Animation = flag")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_IDLA")
    .Writeline("				AnimationMode = ONCE")
    .Writeline("				AnimationBlendTime = 90")
    .Writeline("			End")
    .Writeline("    	End    ")
    .Writeline("		AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("			Animation = flag")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_A")
    .Writeline("				AnimationMode = ONCE")
    .Writeline("				AnimationBlendTime = 0")
    .Writeline("			End")
    .Writeline("			Flags = START_FRAME_LAST")
    .Writeline("		End	    ")
    .Writeline("		AnimationState = UNPACKING")
    .Writeline("			Animation")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_A")
    .Writeline("				AnimationMode = ONCE	")
    .Writeline("				AnimationBlendTime = 90")
    .Writeline("			End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("		End")
    .Writeline("		AnimationState = PACKING")
    .Writeline("			Animation = flag")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_IDLA")
    .Writeline("				AnimationMode = LOOP")
    .Writeline("				AnimationBlendTime = 90")
    .Writeline("			End")
    .Writeline("		End	    ")
    .Writeline("  	End")
    .Writeline("  	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("		UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline("	    UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                        .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & CastleNE_(f) & " 5000")
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("		MaxCastleRadius = 420.0")
    .Writeline("		ScanDistance = 150")
    .Writeline("	End  	")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------")
    .Writeline("")
    .Writeline("ChildObject CastleFlagSW CastleFlag")
    .Writeline("; *** ART Parameters ***")
    .Writeline("  	Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  	    OkToChangeModelColor  = Yes")
    .Writeline("   		DefaultModelConditionState")
    .Writeline("   			Model = NCastle_SKN")
    .Writeline(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone05 TorchGlow FollowBone:Yes")
    .Writeline("	   	End")
    .Writeline("		ModelConditionState = WORLD_BUILDER")
    .Writeline("			Model = Castle_FlagSW")
    .Writeline("		End")
    .Writeline("    	IdleAnimationState")
    .Writeline("			Animation = flag")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_IDLA")
    .Writeline("				AnimationMode = ONCE")
    .Writeline("				AnimationBlendTime = 90")
    .Writeline("			End")
    .Writeline("    	End    ")
    .Writeline("		AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("			Animation = flag")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_A")
    .Writeline("				AnimationMode = ONCE")
    .Writeline("				AnimationBlendTime = 0")
    .Writeline("			End")
    .Writeline("			Flags = START_FRAME_LAST")
    .Writeline("		End	    ")
    .Writeline("		AnimationState = UNPACKING")
    .Writeline("			Animation")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_A")
    .Writeline("				AnimationMode = ONCE	")
    .Writeline("				AnimationBlendTime = 90")
    .Writeline("			End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("		End")
    .Writeline("		AnimationState = PACKING")
    .Writeline("			Animation = flag")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_IDLA")
    .Writeline("				AnimationMode = LOOP")
    .Writeline("				AnimationBlendTime = 90")
    .Writeline("			End")
    .Writeline("		End	    ")
    .Writeline("  	End")
    .Writeline("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("		UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline("	    UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                        .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & CastleSW_(f) & " 5000")
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("		MaxCastleRadius = 420.0")
    .Writeline("		ScanDistance = 150")
    .Writeline("	End  ")
    .Writeline("End")
    .Writeline("")
    .Writeline("ChildObject CastleFlagSE CastleFlag")
    .Writeline("; *** ART Parameters ***")
    .Writeline("  	Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  	    OkToChangeModelColor  = Yes")
    .Writeline("   		DefaultModelConditionState")
    .Writeline("   			Model = NCastle_SKN")
    .Writeline(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = glowbone05 TorchGlow FollowBone:Yes")
    .Writeline("	   	End")
    .Writeline("		ModelConditionState = WORLD_BUILDER")
    .Writeline("			Model = Castle_FlagSE")
    .Writeline("		End")
    .Writeline("    	IdleAnimationState")
    .Writeline("			Animation = flag")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_IDLA")
    .Writeline("				AnimationMode = ONCE")
    .Writeline("				AnimationBlendTime = 90")
    .Writeline("			End")
    .Writeline("    	End    ")
    .Writeline("		AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("			Animation = flag")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_A")
    .Writeline("				AnimationMode = ONCE")
    .Writeline("				AnimationBlendTime = 0")
    .Writeline("			End")
    .Writeline("			Flags = START_FRAME_LAST")
    .Writeline("		End	    ")
    .Writeline("		AnimationState = UNPACKING")
    .Writeline("			Animation")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_A")
    .Writeline("				AnimationMode = ONCE	")
    .Writeline("				AnimationBlendTime = 90")
    .Writeline("			End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("		End")
    .Writeline("		AnimationState = PACKING")
    .Writeline("			Animation = flag")
    .Writeline("				AnimationName = NCastle_SKL.NCastle_IDLA")
    .Writeline("				AnimationMode = LOOP")
    .Writeline("				AnimationBlendTime = 90")
    .Writeline("			End")
    .Writeline("		End	    ")
    .Writeline("  	End")
    .Writeline("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("		UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline("	    UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                        .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & CastleSE_(f) & " 5000")
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("		MaxCastleRadius = 420.0")
    .Writeline("		ScanDistance = 150")
    .Writeline("	End  ")
    .Writeline("End")
    .Writeline("")
    .Writeline("")
    .Writeline("")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("")
    .Writeline("Object EconomyPlotFlag")
    .Writeline("")
    .Writeline(";SelectPortrait = BPRCamp")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("      OkToChangeModelColor  = Yes")
    .Writeline("   	DefaultModelConditionState")
    .Writeline("   		Model = NFarm_SKN")
    .Writeline("                    ParticleSysBone   = FXbone01 FireSmoke FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = FXbone01 TorchGlow FollowBone:Yes")
    .Writeline("   	End")
    .Writeline("	ModelConditionState = WORLD_BUILDER")
    .Writeline("		Model = EcoPlot_Flag")
    .Writeline("	End")
    .Writeline("    IdleAnimationState")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("    End    ")
    .Writeline("	AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End	    ")
    .Writeline("	AnimationState = UNPACKING")
    .Writeline("		Animation")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End")
    .Writeline("	AnimationState = PACKING")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = LOOP")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("	End	    ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ;-------------Floor bib")
    .Writeline("  ")
    .Writeline("	Draw = W3DFloorDraw DrawFloorBib    ")
    .Writeline("		ModelName = NFarm_Bib")
    .Writeline("	End")
    .Writeline("")
    .Writeline(";----------------------- AUDIO -------------------------")
    .Writeline("")
    .Writeline("	VoiceSelect		= Gui_PlotSelect")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName         = OBJECT:EconomyFlag    ")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  Side            = Civilian")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions      = None")
    .Writeline("    Armor           = InvulnerableArmor")
    .Writeline("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  CommandSet = EconomyFlagCommandSet")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  RadarPriority       = STRUCTURE")
    .Writeline("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE BASE_SITE")
    .Writeline("  						;MP_COUNT_FOR_VICTORY;removed so econ plots will not keep zombie games going")
    .Writeline("")
    .Writeline("  Body                = ImmortalBody  ModuleTag_02")
    .Writeline("    MaxHealth       = 1")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("	UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline(" ")
    .Writeline("   	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Farm_(f) & FarmPrice(f))
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline(";	MaxCastleRadius = 100.0")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  ")
    .Writeline("  ")
    .Writeline("  	Behavior = CommandSetUpgrade ModuleTag_commandSetRohanDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_RohanDualEconomyChoice")
    .Writeline("		CommandSet = RohanEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("  	Behavior = CommandSetUpgrade ModuleTag_commandSetEvilDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_MordorDualEconomyChoice")
    .Writeline("		CommandSet = MordorEconomyPlotCommandSet")
    .Writeline("	End")
    .Writeline("	Behavior = CommandSetUpgrade ModuleTag_commandSetIsengardDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_IsengardDualEconomyChoice")
    .Writeline("		CommandSet = IsengardEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Geometry            = CYLINDER")
    .Writeline("  GeometryMajorRadius = 12.0")
    .Writeline("  GeometryMinorRadius = 12.0")
    .Writeline("  GeometryHeight      = 24.0")
    .Writeline("  GeometryIsSmall     = No")
    .Writeline("  Shadow				= SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object EconomyPlotFlag_GondorPreBuilt01")
    .Writeline("")
    .Writeline(";SelectPortrait = BPRCamp")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("      OkToChangeModelColor  = Yes")
    .Writeline("   	DefaultModelConditionState")
    .Writeline("   		Model = NFarm_SKN")
    .Writeline("                    ParticleSysBone   = FXbone01 FireSmoke FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = FXbone01 TorchGlow FollowBone:Yes")
    .Writeline("   	End")
    .Writeline("	ModelConditionState = WORLD_BUILDER")
    .Writeline("		Model = EcoPlot_Flag")
    .Writeline("	End")
    .Writeline("    IdleAnimationState")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("    End    ")
    .Writeline("	AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End	    ")
    .Writeline("	AnimationState = UNPACKING")
    .Writeline("		Animation")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End")
    .Writeline("	AnimationState = PACKING")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = LOOP")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("	End	    ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("")
    .Writeline("  ;-------------Floor bib")
    .Writeline("  ")
    .Writeline("	Draw = W3DFloorDraw DrawFloorBib    ")
    .Writeline("		ModelName = NFarm_Bib")
    .Writeline("	End")
    .Writeline("")
    .Writeline(";----------------------- AUDIO -------------------------")
    .Writeline("")
    .Writeline("	VoiceSelect		= Gui_PlotSelect")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName         = OBJECT:EconomyFlag    ")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  Side            = Civilian")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions      = None")
    .Writeline("    Armor           = InvulnerableArmor")
    .Writeline("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  CommandSet = EconomyFlagCommandSet")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  RadarPriority       = STRUCTURE")
    .Writeline("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE BASE_SITE")
    .Writeline("  						;MP_COUNT_FOR_VICTORY;removed so econ plots will not keep zombie games going")
    .Writeline("")
    .Writeline("  Body                = ImmortalBody  ModuleTag_02")
    .Writeline("    MaxHealth       = 1")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("	UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline(" ")
            .WriteLine("   	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Farm_(f))
                End If
            Next
            .WriteLine("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("  	")
    .Writeline("  	PreBuiltList = GondorFarm 1	")
    .Writeline("  	PreBuiltPlyr = PlyrGondor 	")
    .Writeline(";	MaxCastleRadius = 100.0")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  ")
    .Writeline("    Behavior = CommandSetUpgrade ModuleTag_commandSetRohanDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_RohanDualEconomyChoice")
    .Writeline("		CommandSet = RohanEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("  	Behavior = CommandSetUpgrade ModuleTag_commandSetEvilDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_MordorDualEconomyChoice")
    .Writeline("		CommandSet = MordorEconomyPlotCommandSet")
    .Writeline("	End")
    .Writeline("	Behavior = CommandSetUpgrade ModuleTag_commandSetIsengardDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_IsengardDualEconomyChoice")
    .Writeline("		CommandSet = IsengardEconomyPlotCommandSet")
    .Writeline("	End	")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Geometry            = CYLINDER")
    .Writeline("  GeometryMajorRadius = 12.0")
    .Writeline("  GeometryMinorRadius = 12.0")
    .Writeline("  GeometryHeight      = 24.0")
    .Writeline("  GeometryIsSmall     = No")
    .Writeline("  Shadow				= SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object EconomyPlotFlag_GondorPreBuilt02")
    .Writeline("")
    .Writeline(";SelectPortrait = BPRCamp")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("      OkToChangeModelColor  = Yes")
    .Writeline("   	DefaultModelConditionState")
    .Writeline("   		Model = NFarm_SKN")
    .Writeline("                    ParticleSysBone   = FXbone01 FireSmoke FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = FXbone01 TorchGlow FollowBone:Yes")
    .Writeline("   	End")
    .Writeline("	ModelConditionState = WORLD_BUILDER")
    .Writeline("		Model = EcoPlot_Flag")
    .Writeline("	End")
    .Writeline("    IdleAnimationState")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("    End    ")
    .Writeline("	AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End	    ")
    .Writeline("	AnimationState = UNPACKING")
    .Writeline("		Animation")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End")
    .Writeline("	AnimationState = PACKING")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = LOOP")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("	End	    ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ;-------------Floor bib")
    .Writeline("  ")
    .Writeline("	Draw = W3DFloorDraw DrawFloorBib    ")
    .Writeline("		ModelName = NFarm_Bib")
    .Writeline("	End")
    .Writeline("	")
    .Writeline(";----------------------- AUDIO -------------------------")
    .Writeline("")
    .Writeline("	VoiceSelect		= Gui_PlotSelect")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName         = OBJECT:EconomyFlag    ")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  Side            = Civilian")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions      = None")
    .Writeline("    Armor           = InvulnerableArmor")
    .Writeline("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  CommandSet = EconomyFlagCommandSet")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  RadarPriority       = STRUCTURE")
    .Writeline("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE BASE_SITE")
    .Writeline("    					;MP_COUNT_FOR_VICTORY;removed so econ plots will not keep zombie games going")
    .Writeline("")
    .Writeline("  Body                = ImmortalBody  ModuleTag_02")
    .Writeline("    MaxHealth       = 1")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("	UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline(" ")
    .Writeline("   	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Farm_(f))
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("  	")
    .Writeline("  	PreBuiltList = GondorFarm 1	")
    .Writeline("  	PreBuiltPlyr = PlyrGondor 	")
    .Writeline(";	MaxCastleRadius = 100.0")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("    Behavior = CommandSetUpgrade ModuleTag_commandSetRohanDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_RohanDualEconomyChoice")
    .Writeline("		CommandSet = RohanEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("  	Behavior = CommandSetUpgrade ModuleTag_commandSetEvilDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_MordorDualEconomyChoice")
    .Writeline("		CommandSet = MordorEconomyPlotCommandSet")
    .Writeline("	End")
    .Writeline("	Behavior = CommandSetUpgrade ModuleTag_commandSetIsengardDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_IsengardDualEconomyChoice")
    .Writeline("		CommandSet = IsengardEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Geometry            = CYLINDER")
    .Writeline("  GeometryMajorRadius = 12.0")
    .Writeline("  GeometryMinorRadius = 12.0")
    .Writeline("  GeometryHeight      = 24.0")
    .Writeline("  GeometryIsSmall     = No")
    .Writeline("  Shadow				= SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object EconomyPlotFlag_GondorPreBuilt03")
    .Writeline("")
    .Writeline(";SelectPortrait = BPRCamp")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("      OkToChangeModelColor  = Yes")
    .Writeline("   	DefaultModelConditionState")
    .Writeline("   		Model = NFarm_SKN")
    .Writeline("                    ParticleSysBone   = FXbone01 FireSmoke FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = FXbone01 TorchGlow FollowBone:Yes")
    .Writeline("   	End")
    .Writeline("	ModelConditionState = WORLD_BUILDER")
    .Writeline("		Model = EcoPlot_Flag")
    .Writeline("	End")
    .Writeline("    IdleAnimationState")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("    End    ")
    .Writeline("	AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End	    ")
    .Writeline("	AnimationState = UNPACKING")
    .Writeline("		Animation")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End")
    .Writeline("	AnimationState = PACKING")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = LOOP")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("	End	    ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ;-------------Floor bib")
    .Writeline("  ")
    .Writeline("	Draw = W3DFloorDraw DrawFloorBib    ")
    .Writeline("		ModelName = NFarm_Bib")
    .Writeline("	End")
    .Writeline("")
    .Writeline(";----------------------- AUDIO -------------------------")
    .Writeline("")
    .Writeline("	VoiceSelect		= Gui_PlotSelect")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName         = OBJECT:EconomyFlag    ")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  Side            = Civilian")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions      = None")
    .Writeline("    Armor           = InvulnerableArmor")
    .Writeline("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  CommandSet = EconomyFlagCommandSet")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  RadarPriority       = STRUCTURE")
    .Writeline("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE BASE_SITE ")
    .Writeline("   						;MP_COUNT_FOR_VICTORY;removed so econ plots will not keep zombie games going")
    .Writeline("  ")
    .Writeline("  Body                = ImmortalBody  ModuleTag_02")
    .Writeline("    MaxHealth       = 1")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("	UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline(" ")
    .Writeline("   	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Farm_(f))
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("  	")
    .Writeline("  	PreBuiltList = GondorFarm 1	")
    .Writeline("  	PreBuiltPlyr = PlyrGondor 	")
    .Writeline(";	MaxCastleRadius = 100.0")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  ")
    .Writeline("    Behavior = CommandSetUpgrade ModuleTag_commandSetRohanDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_RohanDualEconomyChoice")
    .Writeline("		CommandSet = RohanEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("  	Behavior = CommandSetUpgrade ModuleTag_commandSetEvilDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_MordorDualEconomyChoice")
    .Writeline("		CommandSet = MordorEconomyPlotCommandSet")
    .Writeline("	End")
    .Writeline("	Behavior = CommandSetUpgrade ModuleTag_commandSetIsengardDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_IsengardDualEconomyChoice")
    .Writeline("		CommandSet = IsengardEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("")
    .Writeline("  Geometry            = CYLINDER")
    .Writeline("  GeometryMajorRadius = 12.0")
    .Writeline("  GeometryMinorRadius = 12.0")
    .Writeline("  GeometryHeight      = 24.0")
    .Writeline("  GeometryIsSmall     = No")
    .Writeline("  Shadow				= SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object EconomyPlotFlag_GondorPreBuilt04")
    .Writeline("")
    .Writeline(";SelectPortrait = BPRCamp")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("      OkToChangeModelColor  = Yes")
    .Writeline("   	DefaultModelConditionState")
    .Writeline("   		Model = NFarm_SKN")
    .Writeline("                    ParticleSysBone   = FXbone01 FireSmoke FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = FXbone01 TorchGlow FollowBone:Yes")
    .Writeline("   	End")
    .Writeline("	ModelConditionState = WORLD_BUILDER")
    .Writeline("		Model = EcoPlot_Flag")
    .Writeline("	End")
    .Writeline("    IdleAnimationState")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("    End    ")
    .Writeline("	AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End	    ")
    .Writeline("	AnimationState = UNPACKING")
    .Writeline("		Animation")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End")
    .Writeline("	AnimationState = PACKING")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = LOOP")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("	End	    ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("")
    .Writeline("  ;-------------Floor bib")
    .Writeline("  ")
    .Writeline("	Draw = W3DFloorDraw DrawFloorBib    ")
    .Writeline("		ModelName = NFarm_Bib")
    .Writeline("	End")
    .Writeline("	")
    .Writeline(";----------------------- AUDIO -------------------------")
    .Writeline("")
    .Writeline("	VoiceSelect		= Gui_PlotSelect")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName         = OBJECT:EconomyFlag    ")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  Side            = Civilian")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions      = None")
    .Writeline("    Armor           = InvulnerableArmor")
    .Writeline("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  CommandSet = EconomyFlagCommandSet")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  RadarPriority       = STRUCTURE")
    .Writeline("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE BASE_SITE")
    .Writeline("  						;MP_COUNT_FOR_VICTORY;removed so econ plots will not keep zombie games going")
    .Writeline("  						")
    .Writeline("  Body                = ImmortalBody  ModuleTag_02")
    .Writeline("    MaxHealth       = 1")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("	UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline(" ")
    .Writeline("   	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Farm_(f))
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("  	")
    .Writeline("  	PreBuiltList = GondorFarm 1	")
    .Writeline("  	PreBuiltPlyr = PlyrGondor 	")
    .Writeline(";	MaxCastleRadius = 100.0")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  ")
    .Writeline("    Behavior = CommandSetUpgrade ModuleTag_commandSetRohanDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_RohanDualEconomyChoice")
    .Writeline("		CommandSet = RohanEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("  	Behavior = CommandSetUpgrade ModuleTag_commandSetEvilDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_MordorDualEconomyChoice")
    .Writeline("		CommandSet = MordorEconomyPlotCommandSet")
    .Writeline("	End")
    .Writeline("	Behavior = CommandSetUpgrade ModuleTag_commandSetIsengardDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_IsengardDualEconomyChoice")
    .Writeline("		CommandSet = IsengardEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  ")
    .Writeline("  Geometry            = CYLINDER")
    .Writeline("  GeometryMajorRadius = 12.0")
    .Writeline("  GeometryMinorRadius = 12.0")
    .Writeline("  GeometryHeight      = 24.0")
    .Writeline("  GeometryIsSmall     = No")
    .Writeline("  Shadow				= SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object EconomyPlotFlag_GondorPreBuilt05")
    .Writeline("")
    .Writeline(";SelectPortrait = BPRCamp")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("      OkToChangeModelColor  = Yes")
    .Writeline("   	DefaultModelConditionState")
    .Writeline("   		Model = NFarm_SKN")
    .Writeline("                    ParticleSysBone   = FXbone01 FireSmoke FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = FXbone01 TorchGlow FollowBone:Yes")
    .Writeline("   	End")
    .Writeline("	ModelConditionState = WORLD_BUILDER")
    .Writeline("		Model = EcoPlot_Flag")
    .Writeline("	End")
    .Writeline("    IdleAnimationState")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("    End    ")
    .Writeline("	AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End	    ")
    .Writeline("	AnimationState = UNPACKING")
    .Writeline("		Animation")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End")
    .Writeline("	AnimationState = PACKING")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = LOOP")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("	End	    ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("")
    .Writeline("  ;-------------Floor bib")
    .Writeline("  ")
    .Writeline("	Draw = W3DFloorDraw DrawFloorBib    ")
    .Writeline("		ModelName = NFarm_Bib")
    .Writeline("	End")
    .Writeline("	")
    .Writeline(";----------------------- AUDIO -------------------------")
    .Writeline("")
    .Writeline("	VoiceSelect		= Gui_PlotSelect")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName         = OBJECT:EconomyFlag    ")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  Side            = Civilian")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions      = None")
    .Writeline("    Armor           = InvulnerableArmor")
    .Writeline("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  CommandSet = EconomyFlagCommandSet")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  RadarPriority       = STRUCTURE")
    .Writeline("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE BASE_SITE")
    .Writeline("  						;MP_COUNT_FOR_VICTORY;removed so econ plots will not keep zombie games going")
    .Writeline("    ")
    .Writeline("  Body                = ImmortalBody  ModuleTag_02")
    .Writeline("    MaxHealth       = 1")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("	UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline(" ")
    .Writeline("   	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Farm_(f))
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("  	")
    .Writeline("  	PreBuiltList = GondorFarm 1	")
    .Writeline("  	PreBuiltPlyr = PlyrGondor 	")
    .Writeline(";	MaxCastleRadius = 100.0")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  ")
    .Writeline("    Behavior = CommandSetUpgrade ModuleTag_commandSetRohanDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_RohanDualEconomyChoice")
    .Writeline("		CommandSet = RohanEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("  	Behavior = CommandSetUpgrade ModuleTag_commandSetEvilDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_MordorDualEconomyChoice")
    .Writeline("		CommandSet = MordorEconomyPlotCommandSet")
    .Writeline("	End")
    .Writeline("	Behavior = CommandSetUpgrade ModuleTag_commandSetIsengardDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_IsengardDualEconomyChoice")
    .Writeline("		CommandSet = IsengardEconomyPlotCommandSet")
    .Writeline("	End		  ")
    .Writeline("  ")
    .Writeline("")
    .Writeline("")
    .Writeline("  Geometry            = CYLINDER")
    .Writeline("  GeometryMajorRadius = 12.0")
    .Writeline("  GeometryMinorRadius = 12.0")
    .Writeline("  GeometryHeight      = 24.0")
    .Writeline("  GeometryIsSmall     = No")
    .Writeline("  Shadow				= SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object EconomyPlotFlag_GondorPreBuilt06")
    .Writeline("")
    .Writeline(";SelectPortrait = BPRCamp")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("      OkToChangeModelColor  = Yes")
    .Writeline("   	DefaultModelConditionState")
    .Writeline("   		Model = NFarm_SKN")
    .Writeline("                    ParticleSysBone   = FXbone01 FireSmoke FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = FXbone01 TorchGlow FollowBone:Yes")
    .Writeline("   	End")
    .Writeline("	ModelConditionState = WORLD_BUILDER")
    .Writeline("		Model = EcoPlot_Flag")
    .Writeline("	End")
    .Writeline("    IdleAnimationState")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("    End    ")
    .Writeline("	AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End	    ")
    .Writeline("	AnimationState = UNPACKING")
    .Writeline("		Animation")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End")
    .Writeline("	AnimationState = PACKING")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = LOOP")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("	End	    ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("")
    .Writeline("  ;-------------Floor bib")
    .Writeline("  ")
    .Writeline("	Draw = W3DFloorDraw DrawFloorBib    ")
    .Writeline("		ModelName = NFarm_Bib")
    .Writeline("	End")
    .Writeline("")
    .Writeline(";----------------------- AUDIO -------------------------")
    .Writeline("")
    .Writeline("	VoiceSelect		= Gui_PlotSelect")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName         = OBJECT:EconomyFlag    ")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  Side            = Civilian")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions      = None")
    .Writeline("    Armor           = InvulnerableArmor")
    .Writeline("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  CommandSet = EconomyFlagCommandSet")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  RadarPriority       = STRUCTURE")
    .Writeline("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE BASE_SITE")
    .Writeline("    					;MP_COUNT_FOR_VICTORY;removed so econ plots will not keep zombie games going")
    .Writeline("  ")
    .Writeline("  Body                = ImmortalBody  ModuleTag_02")
    .Writeline("    MaxHealth       = 1")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("	UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline(" ")
    .Writeline("   	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Farm_(f))
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("  	")
    .Writeline("  	PreBuiltList = GondorFarm 1	")
    .Writeline("  	PreBuiltPlyr = PlyrGondor 	")
    .Writeline(";	MaxCastleRadius = 100.0")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  ")
    .Writeline("    Behavior = CommandSetUpgrade ModuleTag_commandSetRohanDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_RohanDualEconomyChoice")
    .Writeline("		CommandSet = RohanEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("  	Behavior = CommandSetUpgrade ModuleTag_commandSetEvilDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_MordorDualEconomyChoice")
    .Writeline("		CommandSet = MordorEconomyPlotCommandSet")
    .Writeline("	End")
    .Writeline("	Behavior = CommandSetUpgrade ModuleTag_commandSetIsengardDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_IsengardDualEconomyChoice")
    .Writeline("		CommandSet = IsengardEconomyPlotCommandSet")
    .Writeline("	End		  ")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Geometry            = CYLINDER")
    .Writeline("  GeometryMajorRadius = 12.0")
    .Writeline("  GeometryMinorRadius = 12.0")
    .Writeline("  GeometryHeight      = 24.0")
    .Writeline("  GeometryIsSmall     = No")
    .Writeline("  Shadow				= SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object EconomyPlotFlag_GondorPreBuilt07")
    .Writeline("")
    .Writeline(";SelectPortrait = BPRCamp")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("      OkToChangeModelColor  = Yes")
    .Writeline("   	DefaultModelConditionState")
    .Writeline("   		Model = NFarm_SKN")
    .Writeline("                    ParticleSysBone   = FXbone01 FireSmoke FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = FXbone01 TorchGlow FollowBone:Yes")
    .Writeline("   	End")
    .Writeline("	ModelConditionState = WORLD_BUILDER")
    .Writeline("		Model = EcoPlot_Flag")
    .Writeline("	End")
    .Writeline("    IdleAnimationState")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("    End    ")
    .Writeline("	AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End	    ")
    .Writeline("	AnimationState = UNPACKING")
    .Writeline("		Animation")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End")
    .Writeline("	AnimationState = PACKING")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = LOOP")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("	End	    ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("")
    .Writeline("  ;-------------Floor bib")
    .Writeline("  ")
    .Writeline("	Draw = W3DFloorDraw DrawFloorBib    ")
    .Writeline("		ModelName = NFarm_Bib")
    .Writeline("	End")
    .Writeline("	")
    .Writeline(";----------------------- AUDIO -------------------------")
    .Writeline("")
    .Writeline("	VoiceSelect		= Gui_PlotSelect")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName         = OBJECT:EconomyFlag    ")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  Side            = Civilian")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions      = None")
    .Writeline("    Armor           = InvulnerableArmor")
    .Writeline("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  CommandSet = EconomyFlagCommandSet")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  RadarPriority       = STRUCTURE")
    .Writeline("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE BASE_SITE")
    .Writeline("  						;MP_COUNT_FOR_VICTORY;removed so econ plots will not keep zombie games going")
    .Writeline("  ")
    .Writeline("  Body                = ImmortalBody  ModuleTag_02")
    .Writeline("    MaxHealth       = 1")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("	UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline(" ")
    .Writeline("   	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Farm_(f))
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("  	")
    .Writeline("  	PreBuiltList = GondorFarm 1	")
    .Writeline("  	PreBuiltPlyr = PlyrGondor 	")
    .Writeline(";	MaxCastleRadius = 100.0")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("    Behavior = CommandSetUpgrade ModuleTag_commandSetRohanDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_RohanDualEconomyChoice")
    .Writeline("		CommandSet = RohanEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("  	Behavior = CommandSetUpgrade ModuleTag_commandSetEvilDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_MordorDualEconomyChoice")
    .Writeline("		CommandSet = MordorEconomyPlotCommandSet")
    .Writeline("	End")
    .Writeline("	Behavior = CommandSetUpgrade ModuleTag_commandSetIsengardDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_IsengardDualEconomyChoice")
    .Writeline("		CommandSet = IsengardEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  ")
    .Writeline("  Geometry            = CYLINDER")
    .Writeline("  GeometryMajorRadius = 12.0")
    .Writeline("  GeometryMinorRadius = 12.0")
    .Writeline("  GeometryHeight      = 24.0")
    .Writeline("  GeometryIsSmall     = No")
    .Writeline("  Shadow				= SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object EconomyPlotFlag_GondorPreBuilt08")
    .Writeline("")
    .Writeline(";SelectPortrait = BPRCamp")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("      OkToChangeModelColor  = Yes")
    .Writeline("   	DefaultModelConditionState")
    .Writeline("   		Model = NFarm_SKN")
    .Writeline("                    ParticleSysBone   = FXbone01 FireSmoke FollowBone:Yes")
    .Writeline(";                    ParticleSysBone   = FXbone01 TorchGlow FollowBone:Yes")
    .Writeline("   	End")
    .Writeline("	ModelConditionState = WORLD_BUILDER")
    .Writeline("		Model = EcoPlot_Flag")
    .Writeline("	End")
    .Writeline("    IdleAnimationState")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("    End    ")
    .Writeline("	AnimationState = JUST_BUILT ; for instant-build")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End	    ")
    .Writeline("	AnimationState = UNPACKING")
    .Writeline("		Animation")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_A")
    .Writeline("			AnimationMode = ONCE")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("		Flags = START_FRAME_LAST")
    .Writeline("	End")
    .Writeline("	AnimationState = PACKING")
    .Writeline("		Animation = flag")
    .Writeline("			AnimationName = NFarm_SKL.NFarm_IDLA")
    .Writeline("			AnimationMode = LOOP")
    .Writeline("			AnimationBlendTime = 90")
    .Writeline("		End")
    .Writeline("	End	    ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("")
    .Writeline("  ;-------------Floor bib")
    .Writeline("  ")
    .Writeline("	Draw = W3DFloorDraw DrawFloorBib    ")
    .Writeline("		ModelName = NFarm_Bib")
    .Writeline("	End")
    .Writeline("	")
    .Writeline(";----------------------- AUDIO -------------------------")
    .Writeline("")
    .Writeline("	VoiceSelect		= Gui_PlotSelect")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName         = OBJECT:EconomyFlag    ")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  Side            = Civilian")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions      = None")
    .Writeline("    Armor           = InvulnerableArmor")
    .Writeline("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  CommandSet = EconomyFlagCommandSet")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  RadarPriority       = STRUCTURE")
    .Writeline("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE BASE_SITE")
    .Writeline("  						;MP_COUNT_FOR_VICTORY;removed so econ plots will not keep zombie games going")
    .Writeline("    ")
    .Writeline("  Body                = ImmortalBody  ModuleTag_02")
    .Writeline("    MaxHealth       = 1")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
    .Writeline("	UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
    .Writeline(" ")
    .Writeline("   	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Farm_(f))
                End If
            Next
    .Writeline("")
    .Writeline("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("  	")
    .Writeline("  	PreBuiltList = GondorFarm 1	")
    .Writeline("  	PreBuiltPlyr = PlyrGondor 	")
    .Writeline(";	MaxCastleRadius = 100.0")
    .Writeline("  End  ")
    .Writeline("  ")
    .Writeline("    Behavior = CommandSetUpgrade ModuleTag_commandSetRohanDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_RohanDualEconomyChoice")
    .Writeline("		CommandSet = RohanEconomyPlotCommandSet")
    .Writeline("	End	  ")
    .Writeline("  	Behavior = CommandSetUpgrade ModuleTag_commandSetEvilDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_MordorDualEconomyChoice")
    .Writeline("		CommandSet = MordorEconomyPlotCommandSet")
    .Writeline("	End")
    .Writeline("	Behavior = CommandSetUpgrade ModuleTag_commandSetIsengardDualEconomy")
    .Writeline("		TriggeredBy = Upgrade_IsengardDualEconomyChoice")
    .Writeline("		CommandSet = IsengardEconomyPlotCommandSet")
    .Writeline("	End		  ")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  ")
    .Writeline("  Geometry            = CYLINDER")
    .Writeline("  GeometryMajorRadius = 12.0")
    .Writeline("  GeometryMinorRadius = 12.0")
    .Writeline("  GeometryHeight      = 24.0")
    .Writeline("  GeometryIsSmall     = No")
    .Writeline("  Shadow				= SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("ChildObject EconomyPlotFlagMuliplayer EconomyPlotFlag")
    .Writeline("  ")
    .Writeline("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).Evil = "Yes" Then
                    If Fact(f).CreateCB = True Then
                        .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                    End If
                End If
            Next
    .Writeline("  	UseSecondaryBuildList = Yes  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("   	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    If f = 1 Then
                        Farm_(1) = "EntMoot_" & Fact(1).Side
                    Else
                        Farm_(1) = "EconomyFarm_" & Fact(1).Side
                    End If
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Farm_(f) & " " & FarmPrice2(f))
                End If
            Next
    .Writeline("	FilterCrew				= ANY +MONSTER 																									;MONSTER is for Ents, dude. -MLo")
    .Writeline("	FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER +MONSTER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
    .Writeline("")
    .Writeline("	CrewReleaseFX = FX_EntMootRelease		")
    .Writeline("	CrewPrepareFX = FX_EntMootPrepare		")
    .Writeline("	CrewPrepareInterval 12000 ; six second interval")
    .Writeline("")
    .Writeline(";	MaxCastleRadius = 100.0")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline("")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("; this is just a handy placeholder to allow units to have a target")
    .Writeline("; that can't get hurt, to test repeated firing")
    .Writeline("Object IndestructibleThing")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = TempBldgLg")
    .Writeline("    End    ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  Side            = Civilian")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions      = None")
    .Writeline("    Armor           = InvulnerableArmor")
    .Writeline("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  RadarPriority       = STRUCTURE")
    .Writeline("  KindOf              = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  Body                = ImmortalBody ModuleTag_02")
    .Writeline("    MaxHealth       = 99999.0")
    .Writeline("  End")
    .Writeline("  Geometry            = BOX")
    .Writeline("  GeometryMajorRadius = 28.0")
    .Writeline("  GeometryMinorRadius = 28.0")
    .Writeline("  GeometryHeight      = 56.0")
    .Writeline("  GeometryIsSmall     = No")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline(";Rohan Barracks")
    .Writeline("Object ElvenBarracks")
    .Writeline(" ")
    .Writeline(" SelectPortrait = BPCElvenBarracks")
    .Writeline(" ")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
    .Writeline("    OkToChangeModelColor  = Yes")
    .Writeline("    UseStandardModelNames = Yes")
    .Writeline("    ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = NBElvnBarx ")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    IdleAnimationState")
    .Writeline("		StateName	=	STATE_Idle")
    .Writeline("		Animation = IdleA")
    .Writeline("			AnimationName		=	NBElvnBarx.NBElvnBarx")
    .Writeline("			AnimationMode		=	LOOP ")
    .Writeline("			AnimationBlendTime	=	0")
    .Writeline("		End")
    .Writeline("	End    ")
    .Writeline("    ")
    .Writeline("    ;------------ Build Up States -------")
    .Writeline("    ModelConditionState   = AWAITING_CONSTRUCTION ")
    .Writeline("      Model               = NBElvnBarx_A")
    .Writeline(";		ParticleSysBone	  = NONE BuildingDoughnutCloud")
    .Writeline("    End;")
    .Writeline("    AnimationState        = AWAITING_CONSTRUCTION")
    .Writeline("      Animation           =  NBElvnBarx_A")
    .Writeline("        AnimationName     =  NBElvnBarx_A.NBElvnBarx_A")
    .Writeline("        AnimationMode     = MANUAL")
    .Writeline("        AnimationBlendTime = 0")
    .Writeline("      End")
    .Writeline("	  Flags				  = START_FRAME_FIRST")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED")
    .Writeline("      Model               = NBElvnBarx_A")
    .Writeline("		ParticleSysBone   = CONSTDUSTBONE01 BuildingContructDust FollowBone:Yes")
    .Writeline("    End;")
    .Writeline("    ")
    .Writeline("    AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED")
    .Writeline("		Animation           = NBElvnBarx_A")
    .Writeline("			AnimationName     = NBElvnBarx_A.NBElvnBarx_A")
    .Writeline("			AnimationMode     = MANUAL")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags				  = START_FRAME_FIRST")
    .Writeline("		StateName			  = BeingConstructed")
    .Writeline("		BeginScript")
            .WriteLine("			CurDrawablePlaySound(" & Chr(34) & "GondorBarracksBeginConstruction" & Chr(34) & ")")
    .Writeline("		EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("      ;--damaged building")
    .Writeline("      ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = NBElvnBarx_D2")
    .Writeline("		ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall03 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall04 SmokeBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall05 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "NBElvnBarxDP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("        ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = NBElvnBarx_D2")
    .Writeline("		ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall03 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall04 SmokeBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall05 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "NBElvnBarxDP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = NBElvnBarx_D2")
    .Writeline("		ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall03 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall04 SmokeBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall05 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "NBElvnBarxDP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("	ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = NBElvnBarx_D2")
    .Writeline("		ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall03 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall04 SmokeBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall05 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "NBElvnBarxDP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = NBElvnBarx_D1")
    .Writeline("		ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall03 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("		ParticleSysBone FireSmall05 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    AnimationState = DAMAGED")
    .Writeline("	EnteringStateFX	= FX_BuildingDamaged")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = NBElvnBarx_D2")
    .Writeline("		ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall03 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall04 SmokeBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall05 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    AnimationState = REALLYDAMAGED")
    .Writeline("	EnteringStateFX	= FX_BuildingReallyDamaged")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = NBElvnBarx_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = RUBBLE")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "NBElvnBarxDP1" & Chr(34) & ")")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "NBElvnBarxDP2" & Chr(34) & ")")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "NBElvnBarxDP3" & Chr(34) & ")")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "NBElvnBarxDP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("		ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("		ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End  ")
    .Writeline("  ")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Draw = W3DFloorDraw DrawFloor_Bib    ")
    .Writeline("     ModelName = NBElvnBarx_Bib")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName         = OBJECT:ElvenBarracks")
    .Writeline("  Side                = Civilian")
    .Writeline("  EditorSorting       = STRUCTURE")
    .Writeline("  ThreatLevel = 1.0")
    .Writeline("  ")
    .Writeline(" ")
    .Writeline("  BuildCost           = 300")
    .Writeline("  BuildTime           = 15.0           ; in seconds")
    .Writeline("  VisionRange         = 160.0          ; Shroud clearing distance")
    .Writeline("  ShroudClearingRange = 160")
    .Writeline("")
    .Writeline(" CommandSet = ElvenBarracksCommandSet")
    .Writeline("")
    .Writeline("")
    .Writeline("; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("	VoiceSelect			= RohanElvenBarracksSelect")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("	VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction")
    .Writeline("")
    .Writeline("	UnitSpecificSounds")
    .Writeline("		UnderConstruction		= BuildingConstructionLoop  ; Built first time")
    .Writeline("		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound")
    .Writeline("		UnderRepairFromRubble	= BuildingConstructionLoop	; Repaired from completely destroyed (not used???)")
    .Writeline("	End")
    .Writeline("")
    .Writeline(" ")
    .Writeline("  ; *** ENGINEERING Parameters ***")
    .Writeline("  RadarPriority       = STRUCTURE")
    .Writeline("  KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE NEED_BASE_FOUNDATION MP_COUNT_FOR_VICTORY AUTO_RALLYPOINT")
    .Writeline("")
    .Writeline("  Behavior = ProductionUpdate ProductionUpdateModuleTag")
    .Writeline("    ; nothing, but is required if we have any Object-level Upgrades!")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior = QueueProductionExitUpdate QueueProductionModuleTag")
    .Writeline("		UnitCreatePoint    = X:0.0 Y:7.2 Z:0.0")
    .Writeline("		PlacementViewAngle = 180")
    .Writeline("		NaturalRallyPoint  = X:40.0 Y:7.2 Z:0.0")
    .Writeline("		ExitDelay = 750")
    .Writeline(" End")
    .Writeline(" ")
    .Writeline(" ")
    .Writeline(" ")
    .Writeline("; MAP DESIGNER: BRING THIS BACK IF YOU WANT THE AUTOPRODUCTION IN YOUR MAP -MLo")
    .Writeline("; Behavior      = SpawnUnitBehavior ModuleTag_spawnUnit")
    .Writeline(";		UnitName		= RohanElvenWarriorHorde")
    .Writeline(";		UnitCommand		= Command_ConstructRohanElvenWarriorHorde")
    .Writeline("; End")
    .Writeline(" ")
    .Writeline(" ")
    .Writeline("  Behavior            = GettingBuiltBehavior GetBuiltBehaviorTag")
    .Writeline("    WorkerName		  = RohanWorkerNoSelect")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior = CastleMemberBehavior ModuleTag_CMB")
    .Writeline("  End ")
    .Writeline("")
    .Writeline("  Body                = StructureBody ModuleTag_05")
    .Writeline("    MaxHealth         = 3000.0")
    .Writeline("    MaxHealthDamaged  = 2000.0")
    .Writeline("    MaxHealthReallyDamaged =1000.0")
    .Writeline("    ")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("    ")
    .Writeline("    DamageCreationList = OCL_RBBarracks_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_RBBarracks_Chunk2 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_RBBarracks_Chunk3 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_RBBarracks_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("    ")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = WINDOW_N01")
    .Writeline("    FireWindowName          = WINDOW_F01")
    .Writeline("    GlowWindowName			= WINDOW_G01")
    .Writeline("	 FireName				= FIRE01")
    .Writeline("     FireName				= FIRE02")
    .Writeline("  End")
    .Writeline("  ")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  ")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_06")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_08")
    .Writeline("   ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline(" ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 50.6")
    .Writeline("  GeometryMinorRadius   = 20.6")
    .Writeline("  GeometryHeight        = 46.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  GeometryOffset		= X:-15 Y:8 Z:0")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry	= BOX")
    .Writeline("  GeometryMajorRadius   = 34.6")
    .Writeline("  GeometryMinorRadius   = 39.6")
    .Writeline("  GeometryHeight        = 12.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  GeometryOffset		= X:-29 Y:-20 Z:0")
    .Writeline("  ")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("  ")
    .Writeline("  BuildCompletion		= PLACED_BY_PLAYER")
    .Writeline("  ")
    .Writeline("	GeometryContactPoint	= X:-56.311		Y:38.761	Z:0			Repair")
    .Writeline("	GeometryContactPoint	= X:-0.492		Y:-65.304	Z:0			Repair")
    .Writeline("	GeometryContactPoint	= X:-71.003		Y:-6.883	Z:0")
    .Writeline("	GeometryContactPoint	= X:40.821		Y:-11.871	Z:0")
    .Writeline("	GeometryContactPoint	= X:-0.163		Y:-0.326	Z:68.459	Swoop")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral01")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("")
    .Writeline(";   ---Test entry for the time of day texture swap test---")
    .Writeline(";   TimeOfDayTexture = twwater01.tga AFTERNOON 1")
    .Writeline(";	BurntTexture = GBGenDB.tga")
    .Writeline("")
    .Writeline("")
    .Writeline("    ;OkToChangeModelColor = Yes")
    .Writeline("    ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("		Model		= GBGen01	")
    .Writeline("    End")
    .Writeline("")
    .Writeline("	ModelConditionState = BURNT_MODEL")
    .Writeline("		Model = GBGen01_D1	")
    .Writeline("	End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen01_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBG01DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen01_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBG01DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen01_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBG01DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen01_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBG01DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen01_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("      ")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen01_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen01_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("    SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("    SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen01_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen01_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen01_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen01_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline(";  Behavior = FlammableUpdate FlammableModuleTag_15")
    .Writeline(";    AflameDuration = 5000 ; Burn until expressly put out.  Made of wood and all.")
    .Writeline(";    AflameDamageDelay = 999999 ; No Thag, just for looks.")
    .Writeline(";    AflameDamageAmount = 0")
    .Writeline(";    FlameDamageLimit = 1; Catch fire from just 1 flame damage point")
    .Writeline(";    ")
    .Writeline(";    SwapModelWhenAflame = Yes")
    .Writeline(";    SwapModelWhenQuenched = Yes")
    .Writeline(";    SwapTextureWhenAflame = Yes")
    .Writeline(";    SwapTextureWhenQuenched = Yes")
    .Writeline(";    ")
    .Writeline(";    FireFXList = FX:FX_ForgeChimneySmoke BONE:FireSmall01")
    .Writeline(";    FireFXList = FX:FX_ForgeChimneySmoke BONE:FireSmall02")
    .Writeline(";    FireFXList = FX:FX_ForgeChimneySmoke BONE:FireSmall03")
    .Writeline(";    FireFXList = FX:FX_ForgeChimneySmoke BONE:FireSmall04")
    .Writeline(";    FireFXList = FX:FX_ForgeChimneySmoke BONE:FireSmall05")
    .Writeline(";    FireFXList = FX:FX_ForgeSteam BONE:FireMedium01")
    .Writeline(";    FireFXList = FX:FX_ForgeSteam BONE:FireMedium02")
    .Writeline(";    FireFXList = FX:FX_ForgeSparks BONE:FireLarge01")
    .Writeline(";  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline(";;;;;;;;;;;;  ")
    .Writeline(";;;;;;Imprecise Geometry")
    .Writeline(";  Geometry              = BOX")
    .Writeline(";  GeometryMajorRadius   = 16.0")
    .Writeline(";  GeometryMinorRadius   = 39.0")
    .Writeline(";  GeometryHeight        = 53.6")
    .Writeline(";  GeometryOffset		= X:0 Y:0 Z:0")
    .Writeline(";  GeometryIsSmall       = No")
    .Writeline(";  Shadow                = SHADOW_VOLUME")
    .Writeline(";  ShadowSizeX = 64; ")
    .Writeline(";  ShadowSizeY = 64;")
    .Writeline(";;;;;;;;;;;;")
    .Writeline("")
    .Writeline(";;;;;;;;;;;;")
    .Writeline(";;;;;;Precise Geometry")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 8.8")
    .Writeline("  GeometryMinorRadius   = 12.0")
    .Writeline("  GeometryHeight        = 7.6")
    .Writeline("  GeometryOffset		= X:0 Y:-14 Z:32.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry	= BOX")
    .Writeline("  GeometryMajorRadius   = 16.0")
    .Writeline("  GeometryMinorRadius   = 6.0")
    .Writeline("  GeometryHeight        = 53.6")
    .Writeline("  GeometryOffset		= X:0 Y:-33 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry	= BOX")
    .Writeline("  GeometryMajorRadius   = 16.0")
    .Writeline("  GeometryMinorRadius   = 6.0")
    .Writeline("  GeometryHeight        = 53.6")
    .Writeline("  GeometryOffset		= X:0 Y:4 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry	= BOX")
    .Writeline("  GeometryMajorRadius   = 7.8")
    .Writeline("  GeometryMinorRadius   = 6.0")
    .Writeline("  GeometryHeight        = 53.6")
    .Writeline("  GeometryOffset		= X:-3.8 Y:32 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry	= BOX")
    .Writeline("  GeometryMajorRadius   = 8.8")
    .Writeline("  GeometryMinorRadius   = 7.2")
    .Writeline("  GeometryHeight        = 27.6")
    .Writeline("  GeometryOffset		= X:-1 Y:18 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("  ShadowSizeX = 64; ")
    .Writeline("  ShadowSizeY = 64;")
    .Writeline(";;;;;;;;;;;;;")
    .Writeline("  ")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral02")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen02")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState   = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen02_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN02DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen02_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN02DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen02_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN02DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen02_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN02DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen02_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen02_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen02_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen02_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen02_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen02_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen02_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3700")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.0")
    .Writeline("  GeometryMinorRadius   = 9.6")
    .Writeline("  GeometryHeight        = 56.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("ChildObject GondorBuildingGeneral02_CivSpawn GondorBuildingGeneral02")
    .Writeline("")
    .Writeline(" 	Behavior = CivilianSpawnUpdate ModuleTag_CreatePeople")
    .Writeline("		SpawnDelayTime	= 5000")
    .Writeline("		MaximumDistance	= 200")
    .Writeline("		RunToFilter		= ANY +GondorBuildingGeneral11 +GondorBuildingGeneral47")
    .Writeline("		Civilian		= GondorTownsman GondorTownsmanTorch GondorTownsWoman GondorTownsPair")
    .Writeline("	End")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral03")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen03")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen03_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN03DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen03_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN03DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen03_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN03DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen03_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN03DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen03_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen03_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen03_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen03_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen03_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen03_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen03_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 18.6")
    .Writeline("  GeometryMinorRadius   = 25.0")
    .Writeline("  GeometryHeight        = 34.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 12.6")
    .Writeline("  GeometryMinorRadius   = 12.4")
    .Writeline("  GeometryHeight        = 65.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("  ShadowSizeX = 64; ")
    .Writeline("  ShadowSizeY = 64;")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral04")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen04")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen04_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN04DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen04_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN04DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen04_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN04DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen04_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN04DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen04_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen04_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen04_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen04_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen04_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen04_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen04_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 4000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 12.8")
    .Writeline("  GeometryHeight        = 64.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral05")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen05")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen05_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN05DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen05_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN05DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen05_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN05DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen05_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN05DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen05_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen05_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen05_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen05_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen05_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen05_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen05_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline(" ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("    ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline(";;;;;;;;;;;;  ")
    .Writeline(";;;;;Imprecise Geometry")
    .Writeline(";  Geometry              = BOX")
    .Writeline(";  GeometryMajorRadius   = 8.0")
    .Writeline(";  GeometryMinorRadius   = 32.8")
    .Writeline(";  GeometryHeight        = 49.6")
    .Writeline(";  GeometryIsSmall       = No")
    .Writeline(";  Shadow                = SHADOW_VOLUME")
    .Writeline("")
    .Writeline(";;;;;;;;;;;;")
    .Writeline(";;;;;Precise Geometry")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 4.0")
    .Writeline("  GeometryMinorRadius   = 17.8")
    .Writeline("  GeometryHeight        = -12.0")
    .Writeline("  GeometryOffset		= X:0 Y:0 Z:23.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryName			= GondorBuildingGeneral05_leftTower")
    .Writeline("  GeometryMajorRadius   = 14.0")
    .Writeline("  GeometryMinorRadius   = 32.8")
    .Writeline("  GeometryHeight        = 68.6")
    .Writeline("  GeometryOffset		= X:0 Y:-24.8 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryName			= GondorBuildingGeneral05_rightTower")
    .Writeline("  GeometryMajorRadius   = 14.0")
    .Writeline("  GeometryMinorRadius   = 32.8")
    .Writeline("  GeometryHeight        = 68.6")
    .Writeline("  GeometryOffset		= X:0 Y:25.8 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline(";;;;;;;;;;;")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral06")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen06")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen06_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN06DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen06_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN06DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen06_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN06DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen06_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN06DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen06_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen06_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen06_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen06_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen06_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen06_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen06_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 12.8")
    .Writeline("  GeometryHeight        = 42.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral07")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen07")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen07_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN07DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen07_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN07DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen07_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN07DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen07_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN07DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen07_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen07_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen07_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen07_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen07_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen07_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen07_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("    ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline(";;;;;;;;;;;;  ")
    .Writeline(";;;;;Imprecise Geometry")
    .Writeline(";  Geometry              = BOX")
    .Writeline(";  GeometryMajorRadius   = 14.8")
    .Writeline(";  GeometryMinorRadius   = 22.4")
    .Writeline(";  GeometryHeight        = 49.6")
    .Writeline(";  GeometryIsSmall       = No")
    .Writeline(";  Shadow                = SHADOW_VOLUME")
    .Writeline(";;;;;;;;;;;")
    .Writeline("")
    .Writeline(";;;;;;;;;;;;  ")
    .Writeline(";;;;;Precise Geometry")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryName			= GondorBuildingGeneral07_stairway")
    .Writeline("  GeometryMajorRadius   = 11.0")
    .Writeline("  GeometryMinorRadius   = 11.0")
    .Writeline("  GeometryHeight        = 14.6")
    .Writeline("  GeometryOffset		= X:3.8 Y:-17.4 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 15.8")
    .Writeline("  GeometryMinorRadius   = 20.4")
    .Writeline("  GeometryHeight        = 54.6")
    .Writeline("  GeometryOffset		= X:0 Y:2.4 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline(";;;;;;;;;;;;")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral08")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen08")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen08_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN08DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen08_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN08DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen08_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN08DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen08_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN08DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen08_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen08_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen08_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen08_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen08_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen08_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen08_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline(";;;;;;;;;;;;  ")
    .Writeline(";;;;;Imprecise Geometry")
    .Writeline(";  Geometry              = BOX")
    .Writeline(";  GeometryMajorRadius   = 16.8")
    .Writeline(";  GeometryMinorRadius   = 23.2")
    .Writeline(";  GeometryHeight        = 44.8")
    .Writeline(";  GeometryIsSmall       = No")
    .Writeline(";  Shadow                = SHADOW_VOLUME")
    .Writeline(";  ShadowSizeX = 64; ")
    .Writeline(";  ShadowSizeY = 64;")
    .Writeline(";;;;;;;;;;;")
    .Writeline("")
    .Writeline(";;;;;;;;;;;")
    .Writeline(";;;;;Precise Geometry")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 3.8")
    .Writeline("  GeometryMinorRadius   = 12.8")
    .Writeline("  GeometryHeight        = 9.8")
    .Writeline("  GeometryOffset		= X:13.8 Y:11.2 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryName			= GondorBuildingGeneral08_mainStructure")
    .Writeline("  GeometryMajorRadius   = 12.0")
    .Writeline("  GeometryMinorRadius   = 17.0")
    .Writeline("  GeometryHeight        = 56.8")
    .Writeline("  GeometryOffset		= X:-3.8 Y:-9.2 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryName			= GondorBuildingGeneral08_stair2")
    .Writeline("  GeometryMajorRadius   = 10.0")
    .Writeline("  GeometryMinorRadius   = 12.0")
    .Writeline("  GeometryHeight        = 17.4")
    .Writeline("  GeometryOffset		= X:-1 Y:14.2 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("  ShadowSizeX = 64; ")
    .Writeline("  ShadowSizeY = 64;")
    .Writeline(";;;;;;;;;;;")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral09")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen09")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen09_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN09DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen09_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN09DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen09_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN09DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen09_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN09DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen09_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen09_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen09_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen09_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen09_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen09_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen09_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 14.2")
    .Writeline("  GeometryMinorRadius   = 23.8")
    .Writeline("  GeometryHeight        = 39.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral10")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen10")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen10_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen10_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen10_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen10_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen10_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen10_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen10_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.0")
    .Writeline("  GeometryMinorRadius   = 26.4")
    .Writeline("  GeometryHeight        = 43.6")
    .Writeline("  GeometryOffset		= X:4 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral11")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen11")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen11_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN11DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen11_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN11DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen11_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN11DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen11_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN11DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen11_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen11_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen11_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen11_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen11_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen11_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen11_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3700")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior = CivilianSpawnCollide Tag_deleteGuys")
    .Writeline("	DeleteObjectFilter = ANY +GondorTownsman +GondorTownsmanTorch +GondorTownsWoman +GondorTownsPair")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 15.0")
    .Writeline("  GeometryMinorRadius   = 13.4")
    .Writeline("  GeometryHeight        = 83.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral11NoFireD1")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen11_D1R")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("	;SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	;SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("    ")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 15.0")
    .Writeline("  GeometryMinorRadius   = 13.4")
    .Writeline("  GeometryHeight        = 83.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral11NoFireD2")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen11_D2R")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("	;SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	;SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3700")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 14.0")
    .Writeline("  GeometryMinorRadius   = 10.4")
    .Writeline("  GeometryHeight        = 70.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral12")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("      DefaultModelConditionState")
    .Writeline("      Model = GBGen12")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen12_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN12DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen12_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN12DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen12_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN12DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen12_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN12DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen12_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen12_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen12_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen12_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen12_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen12_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen12_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.4")
    .Writeline("  GeometryMinorRadius   = 15.0")
    .Writeline("  GeometryHeight        = 56.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral13")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen13")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen13_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN13DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen13_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN13DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen13_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN13DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen13_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN13DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen13_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen13_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen13_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen13_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen13_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen13_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen13_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2400")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 19.0")
    .Writeline("  GeometryMinorRadius   = 53.4")
    .Writeline("  GeometryHeight        = 33.4")
    .Writeline("  GeometryOffset		= X:-2 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 12.0")
    .Writeline("  GeometryMinorRadius   = 19.4")
    .Writeline("  GeometryHeight        = 90.4")
    .Writeline("  GeometryOffset		= X:-2 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral14")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen14")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen14_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN14DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen14_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN14DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen14_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN14DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen14_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN14DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen14_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen14_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen14_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen14_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen14_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen14_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen14_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("    ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 14.4")
    .Writeline("  GeometryMinorRadius   = 33.4")
    .Writeline("  GeometryHeight        = 32.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  GeometryOffset		= X:0 Y:-9.4 Z:0")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 12.4")
    .Writeline("  GeometryMinorRadius   = 14.0")
    .Writeline("  GeometryHeight        = 56.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  GeometryOffset		= X:0 Y:-28.4 Z:0")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral15")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen15")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen15_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN15DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen15_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN15DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen15_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN15DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen15_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN15DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen15_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen15_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen15_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen15_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen15_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen15_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen15_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 33.0")
    .Writeline("  GeometryHeight        = 40.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral15NoFireD1")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen15_D1R")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("	;SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	;SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 33.0")
    .Writeline("  GeometryHeight        = 40.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral15NoFireD2")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen15_D2R")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("	;SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	;SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 33.0")
    .Writeline("  GeometryHeight        = 40.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral16")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen16")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen16_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN16DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen16_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN16DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen16_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN16DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen16_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN16DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen16_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen16_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen16_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen16_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen16_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen16_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen16_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 19.2")
    .Writeline("  GeometryMinorRadius   = 31.0")
    .Writeline("  GeometryHeight        = 62.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral17")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen17")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen17_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN17DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen17_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN17DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen17_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN17DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen17_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN17DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen17_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen17_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen17_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen17_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen17_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen17_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen17_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 10.4")
    .Writeline("  GeometryMinorRadius   = 36.6")
    .Writeline("  GeometryHeight        = 33.6")
    .Writeline("  GeometryOffset		= X:0 Y:1 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 8.0")
    .Writeline("  GeometryMinorRadius   = 29.6")
    .Writeline("  GeometryHeight        = 83.0")
    .Writeline("  GeometryOffset		= X:0 Y:-25.6 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral17NoFireD1")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen17_D1R")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("	;SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	;SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 10.4")
    .Writeline("  GeometryMinorRadius   = 36.6")
    .Writeline("  GeometryHeight        = 33.6")
    .Writeline("  GeometryOffset		= X:0 Y:1 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 8.0")
    .Writeline("  GeometryMinorRadius   = 29.6")
    .Writeline("  GeometryHeight        = 83.0")
    .Writeline("  GeometryOffset		= X:0 Y:-25.6 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral17NoFireD2")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen17_D2R")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("	;SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	;SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 10.4")
    .Writeline("  GeometryMinorRadius   = 36.6")
    .Writeline("  GeometryHeight        = 33.6")
    .Writeline("  GeometryOffset		= X:0 Y:1 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 8.0")
    .Writeline("  GeometryMinorRadius   = 29.6")
    .Writeline("  GeometryHeight        = 83.0")
    .Writeline("  GeometryOffset		= X:0 Y:-25.6 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral18")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen18")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen18_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN18DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen18_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN18DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen18_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN18DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen18_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN18DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen18_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen18_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen18_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen18_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen18_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen18_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen18_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("    ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.0")
    .Writeline("  GeometryMinorRadius   = 14.4")
    .Writeline("  GeometryHeight        = 55.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral19")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen19")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen19_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN19DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen19_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN19DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen19_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN19DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen19_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN19DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen19_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen19_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen19_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen19_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen19_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen19_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen19_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2300")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("    ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 15.4")
    .Writeline("  GeometryMinorRadius   = 21.8")
    .Writeline("  GeometryHeight        = 52.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral19NoFireD1")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen19_D1R")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("	;SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	;SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 15.4")
    .Writeline("  GeometryMinorRadius   = 21.8")
    .Writeline("  GeometryHeight        = 52.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral19NoFireD2")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen19_D2R")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("	;SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	;SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 15.4")
    .Writeline("  GeometryMinorRadius   = 21.8")
    .Writeline("  GeometryHeight        = 52.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral20")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen20")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen20_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN20DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen20_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN20DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen20_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN20DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen20_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN20DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen20_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen20_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen20_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen20_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen20_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen20_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen20_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 15.2")
    .Writeline("  GeometryMinorRadius   = 27.8")
    .Writeline("  GeometryHeight        = 49.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral21")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen21")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen21_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN21DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen21_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN21DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen21_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN21DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen21_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN21DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen21_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen21_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen21_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen21_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen21_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen21_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen21_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.0")
    .Writeline("  GeometryMinorRadius   = 37.6")
    .Writeline("  GeometryHeight        = 41.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral22")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen22")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen22_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN22DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen22_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN22DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen22_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN22DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen22_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN22DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen22_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen22_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen22_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen22_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen22_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen22_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen22_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 10.4")
    .Writeline("  GeometryMinorRadius   = 29.8")
    .Writeline("  GeometryHeight        = 24.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral23")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen23")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen23_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN23DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen23_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN23DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen23_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN23DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen23_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN23DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen23_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen23_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen23_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen23_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen23_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen23_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen23_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 11.8")
    .Writeline("  GeometryMinorRadius   = 17.4")
    .Writeline("  GeometryHeight        = 59.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral24")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen24")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen24_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN24DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen24_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN24DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen24_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN24DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen24_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN24DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen24_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen24_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen24_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen24_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen24_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen24_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen24_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("    ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.2")
    .Writeline("  GeometryMinorRadius   = 34.0")
    .Writeline("  GeometryHeight        = 41.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 8.0")
    .Writeline("  GeometryMinorRadius   = 8.0")
    .Writeline("  GeometryHeight        = 77.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral25")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen25")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen25_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN25DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen25_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN25DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen25_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN25DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen25_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN25DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen25_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen25_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen25_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen25_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen25_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen25_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen25_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 17.6")
    .Writeline("  GeometryMinorRadius   = 42.6")
    .Writeline("  GeometryHeight        = 40.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral26")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen26")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen26_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN26DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen26_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN26DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen26_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN26DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen26_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN26DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen26_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen26_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen26_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen26_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen26_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen26_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen26_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.6")
    .Writeline("  GeometryMinorRadius   = 38.6")
    .Writeline("  GeometryHeight        = 40.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral27")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen27")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen27_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN27DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen27_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN27DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen27_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN27DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen27_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN27DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen27_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen27_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen27_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen27_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen27_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen27_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen27_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 11.4")
    .Writeline("  GeometryMinorRadius   = 30.6")
    .Writeline("  GeometryHeight        = 36.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral28")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen28")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen28_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN28DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen28_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN28DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen28_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN28DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen28_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN28DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen28_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen28_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen28_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen28_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen28_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen28_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen28_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 17.6")
    .Writeline("  GeometryMinorRadius   = 22.0")
    .Writeline("  GeometryHeight        = 39.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 4.6")
    .Writeline("  GeometryMinorRadius   = 5.0")
    .Writeline("  GeometryHeight        = 76.4")
    .Writeline("  GeometryOffset		= X:-1 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral29")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen29")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen29_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN29DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen29_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN29DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen29_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN29DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen29_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN29DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen29_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen29_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen29_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen29_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen29_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen29_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen29_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 22.8")
    .Writeline("  GeometryMinorRadius   = 22.4")
    .Writeline("  GeometryHeight        = 32.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 15.8")
    .Writeline("  GeometryMinorRadius   = 22.4")
    .Writeline("  GeometryHeight        = 91.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral30")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen30")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen30_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN30DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen30_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN30DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen30_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN30DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen30_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN30DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen30_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen30_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen30_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen30_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen30_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen30_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen30_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline(";;;;;;;;;;;;")
    .Writeline(";;;;;Imprecise Geometry")
    .Writeline(";  Geometry              = BOX")
    .Writeline(";  GeometryMajorRadius   = 11.2")
    .Writeline(";  GeometryMinorRadius   = 40.8")
    .Writeline(";  GeometryHeight        = 62.8")
    .Writeline(";  GeometryOffset		= X:0 Y:-12.2 Z:0")
    .Writeline(";  GeometryIsSmall       = No")
    .Writeline(";  Shadow                = SHADOW_VOLUME")
    .Writeline(";;;;;;;;;;;;")
    .Writeline("")
    .Writeline(";;;;;;;;;;;;")
    .Writeline(";;;;;Precise Geometry  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 11.2")
    .Writeline("  GeometryMinorRadius   = 17.0")
    .Writeline("  GeometryHeight        = -19.0")
    .Writeline("  GeometryOffset		= X:0 Y:-12.2 Z:23.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 11.2")
    .Writeline("  GeometryMinorRadius   = 17.0")
    .Writeline("  GeometryHeight        = 62.8")
    .Writeline("  GeometryOffset		= X:0 Y:15.6 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 11.2")
    .Writeline("  GeometryMinorRadius   = 17.0")
    .Writeline("  GeometryHeight        = 62.8")
    .Writeline("  GeometryOffset		= X:0 Y:-40.0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline(";;;;;;;;;;;;")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral31")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen31")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen31_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN31DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen31_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN31DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen31_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN31DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen31_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN31DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen31_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen31_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen31_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen31_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen31_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen31_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen31_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 11.4")
    .Writeline("  GeometryMinorRadius   = 12.0")
    .Writeline("  GeometryHeight        = 66.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral32")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen32")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen32_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN32DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen32_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN32DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen32_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN32DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen32_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN32DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen32_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen32_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen32_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen32_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen32_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen32_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen32_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 9.6")
    .Writeline("  GeometryMinorRadius   = 33.0")
    .Writeline("  GeometryHeight        = 35.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryName			= GondorBuildingGeneral32_leftSpire")
    .Writeline("  GeometryMajorRadius   = 9.6")
    .Writeline("  GeometryMinorRadius   = 12.0")
    .Writeline("  GeometryHeight        = 77.4")
    .Writeline("  GeometryOffset		= X:0 Y:-21 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryName			= GondorBuildingGeneral32_rightSpire")
    .Writeline("  GeometryMajorRadius   = 9.6")
    .Writeline("  GeometryMinorRadius   = 12.0")
    .Writeline("  GeometryHeight        = 77.4")
    .Writeline("  GeometryOffset		= X:0 Y:21 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral32NoFireD1")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen32_D1R")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("	;SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	;SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 9.6")
    .Writeline("  GeometryMinorRadius   = 32.0")
    .Writeline("  GeometryHeight        = 75.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral32NoFireD2")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen32_D2R")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 9.6")
    .Writeline("  GeometryMinorRadius   = 32.0")
    .Writeline("  GeometryHeight        = 75.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral33")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen33")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen33_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN33DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen33_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN33DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen33_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN33DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen33_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN33DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen33_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen33_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen33_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen33_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen33_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen33_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen33_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2200")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 14.4")
    .Writeline("  GeometryMinorRadius   = 24.0")
    .Writeline("  GeometryHeight        = 50.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral34")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen34")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen34_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN34DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen34_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN34DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen34_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN34DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen34_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN34DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen34_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen34_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen34_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("  ")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen34_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen34_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen34_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen34_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2200")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 11.2")
    .Writeline("  GeometryMinorRadius   = 13.2")
    .Writeline("  GeometryHeight        = 57.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline(";  AdditionalGeometry    = BOX")
    .Writeline(";  GeometryMajorRadius   = 11.2")
    .Writeline(";  GeometryMinorRadius   = 19.2")
    .Writeline(";  GeometryHeight        = 36.8")
    .Writeline(";  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral35")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen35")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen35_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN35DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen35_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN35DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen35_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN35DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen35_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN35DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen35_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen35_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen35_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen35_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen35_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen35_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen35_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2200")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 16.0")
    .Writeline("  GeometryHeight        = 46.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral36")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen36")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen36_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN36DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen36_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN36DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen36_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN36DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen36_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN36DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen36_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen36_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen36_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen36_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen36_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen36_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen36_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 26.8")
    .Writeline("  GeometryHeight        = 29.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral37")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen37")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen37_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN37DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen37_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN37DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen37_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN37DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen37_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN37DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen37_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen37_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen37_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen37_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen37_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen37_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen37_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.0")
    .Writeline("  GeometryMinorRadius   = 28.8")
    .Writeline("  GeometryHeight        = 23.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral38")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen38")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen38_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN38DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen38_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN38DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen38_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN38DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen38_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN38DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen38_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen38_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen38_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen38_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen38_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen38_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen38_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline(";;;;;;;;;;;;")
    .Writeline(";;;;;Imprecise Geometry")
    .Writeline(";  Geometry              = BOX")
    .Writeline(";  GeometryMajorRadius   = 12.8")
    .Writeline(";  GeometryMinorRadius   = 37.6")
    .Writeline(";  GeometryHeight        = 40.0")
    .Writeline(";  GeometryIsSmall       = No")
    .Writeline(";  Shadow                = SHADOW_VOLUME")
    .Writeline(";;;;;;;;;;;;")
    .Writeline("")
    .Writeline(";;;;;;;;;;;;")
    .Writeline(";;;;;Precise Geometry")
    .Writeline("  Geometry    = BOX")
    .Writeline("  GeometryName			= GondorBuildingGeneral38_mainStructure")
    .Writeline("  GeometryMajorRadius   = 11.8")
    .Writeline("  GeometryMinorRadius   = 16.0")
    .Writeline("  GeometryHeight        = 47.5")
    .Writeline("  GeometryOffset		= X:0 Y:-18.6 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryName			= GondorBuildingGeneral38_subStructure")
    .Writeline("  GeometryMajorRadius   = 11.8")
    .Writeline("  GeometryMinorRadius   = 20.6")
    .Writeline("  GeometryHeight        = 28.0")
    .Writeline("  GeometryOffset		= X:0 Y:18.0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline(";;;;;;;;;;;;")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral39")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen39")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen39_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN39DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen39_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN39DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen39_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN39DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen39_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN39DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen39_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen39_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen39_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen39_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen39_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen39_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen39_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 8.2")
    .Writeline("  GeometryMinorRadius   = 14.8")
    .Writeline("  GeometryHeight        = 51.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral40")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen40")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen40_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN40DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen40_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN40DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen40_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN40DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen40_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN40DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen40_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen40_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen40_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen40_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen40_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen40_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen40_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2700")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 13.6")
    .Writeline("  GeometryMinorRadius   = 22.4")
    .Writeline("  GeometryHeight        = 36.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 7.6")
    .Writeline("  GeometryMinorRadius   = 22.4")
    .Writeline("  GeometryHeight        = 78.0")
    .Writeline("  GeometryOffset		= X:3.6 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral41")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen41")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen41_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN41DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen41_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN41DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen41_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN41DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen41_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN41DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen41_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen41_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen41_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen41_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen41_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen41_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen41_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2400")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 15.2")
    .Writeline("  GeometryHeight        = 50.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral42")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen42")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen42_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN42DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen42_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN42DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen42_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN42DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen42_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN42DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen42_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen42_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen42_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen42_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen42_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen42_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen42_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2100")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 8.0")
    .Writeline("  GeometryMinorRadius   = 37.6")
    .Writeline("  GeometryHeight        = 38.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 18.0")
    .Writeline("  GeometryMinorRadius   = 18.6")
    .Writeline("  GeometryHeight        = 49.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral43")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen43")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen43_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN43DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen43_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN43DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen43_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN43DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen43_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN43DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen43_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen43_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen43_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen43_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen43_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen43_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen43_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2400")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 8.8")
    .Writeline("  GeometryMinorRadius   = 10.2")
    .Writeline("  GeometryHeight        = 70.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 15.2")
    .Writeline("  GeometryHeight        = 36.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral44")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen44")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen44_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN44DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen44_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN44DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen44_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN44DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen44_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN44DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen44_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen44_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen44_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen44_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen44_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen44_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen44_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2300")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline(" ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 13.6")
    .Writeline("  GeometryMinorRadius   = 28.6")
    .Writeline("  GeometryHeight        = 33.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral45")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen45")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen45_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN45DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen45_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN45DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen45_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN45DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen45_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN45DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen45_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen45_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen45_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen45_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen45_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen45_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen45_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2800")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 16.8")
    .Writeline("  GeometryMinorRadius   = 29.6")
    .Writeline("  GeometryHeight        = 42.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 4.0")
    .Writeline("  GeometryMinorRadius   = 7.6")
    .Writeline("  GeometryHeight        = 81.0")
    .Writeline("  GeometryOffset		= X:9.8 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral46")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen46")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen46_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN46DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen46_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN46DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen46_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN46DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen46_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN46DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen46_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen46_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen46_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen46_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen46_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen46_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen46_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 7.0")
    .Writeline("  GeometryMinorRadius   = 46.6")
    .Writeline("  GeometryHeight        = 13.2")
    .Writeline("  GeometryOffset		= X:-.8 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 11.8")
    .Writeline("  GeometryMinorRadius   = 18.6")
    .Writeline("  GeometryHeight        = 42.2")
    .Writeline("  GeometryOffset		= X:-.8 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 5.0")
    .Writeline("  GeometryMinorRadius   = 6.6")
    .Writeline("  GeometryHeight        = 78.2")
    .Writeline("  GeometryOffset		= X:-1.8 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral47")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen47")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen47_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN47DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen47_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN47DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen47_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN47DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen47_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN47DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen47_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen47_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen47_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen47_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen47_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen47_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen47_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2600")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior = CivilianSpawnCollide Tag_deleteGuys")
    .Writeline("	DeleteObjectFilter = ANY +GondorTownsman +GondorTownsmanTorch +GondorTownsWoman +GondorTownsPair")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 18.4")
    .Writeline("  GeometryMinorRadius   = 43.2")
    .Writeline("  GeometryHeight        = 35.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 8.0")
    .Writeline("  GeometryMinorRadius   = 7.2")
    .Writeline("  GeometryHeight        = 72.0")
    .Writeline("  GeometryOffset		= X:-4.4 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral48")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen48")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen48_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN48DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen48_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN48DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen48_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN48DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen48_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN48DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen48_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen48_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen48_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen48_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen48_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen48_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen48_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2400")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 11.2")
    .Writeline("  GeometryMinorRadius   = 30.2")
    .Writeline("  GeometryHeight        = 39.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 6.0")
    .Writeline("  GeometryMinorRadius   = 12.2")
    .Writeline("  GeometryHeight        = 69.4")
    .Writeline("  GeometryOffset		= X:-1.2 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral49")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen49")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen49_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN49DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen49_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN49DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen49_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN49DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen49_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN49DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen49_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen49_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen49_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen49_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen49_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen49_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen49_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2400")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 15.2")
    .Writeline("  GeometryMinorRadius   = 23.4")
    .Writeline("  GeometryHeight        = 36.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 6.2")
    .Writeline("  GeometryMinorRadius   = 8.4")
    .Writeline("  GeometryHeight        = 60.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral50")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen50")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen50_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN50DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen50_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN50DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen50_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN50DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen50_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN50DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen50_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen50_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen50_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen50_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen50_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen50_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen50_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2600")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 13.6")
    .Writeline("  GeometryMinorRadius   = 32.8")
    .Writeline("  GeometryHeight        = 41.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 4.8")
    .Writeline("  GeometryMinorRadius   = 5.8")
    .Writeline("  GeometryHeight        = 81.6")
    .Writeline("  GeometryOffset		= X:1.6 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral51")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen51")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen51_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN51DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen51_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN51DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen51_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN51DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen51_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN51DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen51_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen51_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen51_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen51_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen51_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen51_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen51_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 14.6")
    .Writeline("  GeometryMinorRadius   = 25.8")
    .Writeline("  GeometryHeight        = 40.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 3.6")
    .Writeline("  GeometryMinorRadius   = 5.8")
    .Writeline("  GeometryHeight        = 72.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral52")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen52")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen52_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN52DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen52_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN52DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen52_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN52DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen52_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN52DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen52_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen52_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen52_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen52_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen52_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen52_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen52_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("    Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2400")
    .Writeline("")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 15.4")
    .Writeline("  GeometryMinorRadius   = 44.6")
    .Writeline("  GeometryHeight        = 57.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral53")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen53")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen53_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN53DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen53_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN53DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen53_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN53DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen53_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN53DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen53_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen53_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen53_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen53_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen53_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen53_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen53_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 9.8")
    .Writeline("  GeometryMinorRadius   = 22.4")
    .Writeline("  GeometryHeight        = 53.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 4.5")
    .Writeline("  GeometryMinorRadius   = 5.4")
    .Writeline("  GeometryHeight        = 73.0")
    .Writeline("  GeometryOffset		= X:-1.8 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral54")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen54")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen54_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN54DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen54_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN54DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen54_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN54DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen54_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN54DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen54_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen54_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen54_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen54_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen54_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen54_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen54_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2300")
    .Writeline("")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 16.0")
    .Writeline("  GeometryMinorRadius   = 32.8")
    .Writeline("  GeometryHeight        = 27.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 4.5")
    .Writeline("  GeometryMinorRadius   = 5.8")
    .Writeline("  GeometryHeight        = 48.2")
    .Writeline("  GeometryOffset		= X:9 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral55")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen55")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen55_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN55DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen55_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN55DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen55_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN55DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen55_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN55DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen55_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen55_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen55_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen55_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen55_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen55_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen55_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2600")
    .Writeline("")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 16.8")
    .Writeline("  GeometryMinorRadius   = 29.6")
    .Writeline("  GeometryHeight        = 62.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral56")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen56")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen56_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN56DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen56_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN56DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen56_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN56DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen56_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN56DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen56_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen56_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen56_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen56_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen56_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen56_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen56_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2800")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 13.6")
    .Writeline("  GeometryMinorRadius   = 29.6")
    .Writeline("  GeometryHeight        = 45.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 5.0")
    .Writeline("  GeometryMinorRadius   = 6.6")
    .Writeline("  GeometryHeight        = 79.6")
    .Writeline("  GeometryOffset		= X:-2.6 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral57")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen57")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen57_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN57DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen57_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN57DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen57_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN57DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen57_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN57DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen57_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen57_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen57_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen57_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen57_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen57_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen57_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2700")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 7.2")
    .Writeline("  GeometryMinorRadius   = 7.2")
    .Writeline("  GeometryHeight        = 83.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 13.2")
    .Writeline("  GeometryMinorRadius   = 39.2")
    .Writeline("  GeometryHeight        = 44.8")
    .Writeline("  GeometryOffset		= X:2 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral58")
    .Writeline("")
    .Writeline("   ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen58")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen58_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN58DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen58_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN58DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen58_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN58DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen58_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN58DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen58_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen58_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen58_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen58_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen58_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen58_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen58_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 2500")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 15.2")
    .Writeline("  GeometryMinorRadius   = 44.8")
    .Writeline("  GeometryHeight        = 41.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 15.2")
    .Writeline("  GeometryMinorRadius   = 25.8")
    .Writeline("  GeometryHeight        = 51.6")
    .Writeline("  GeometryOffset		= X:0 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral59")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen59")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen59_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN59DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen59_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN59DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen59_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN59DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen59_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN59DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen59_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen59_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen59_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen59_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen59_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen59_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen59_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 11.2")
    .Writeline("  GeometryMinorRadius   = 14.2")
    .Writeline("  GeometryHeight        = 51.6")
    .Writeline("  GeometryOffset		= X:-5 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 16.0")
    .Writeline("  GeometryMinorRadius   = 51.2")
    .Writeline("  GeometryHeight        = 29.6")
    .Writeline("  GeometryOffset		= X:-1 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral60")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen60")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen60_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN60DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen60_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN60DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen60_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN60DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen60_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN60DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen60_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen60_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen60_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen60_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen60_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen60_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen60_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 35.2")
    .Writeline("  GeometryHeight        = 28.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 39.2")
    .Writeline("  GeometryHeight        = 47.0")
    .Writeline("  GeometryOffset		= X:-1 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral61")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen61")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen61_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN61DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen61_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN61DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen61_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN61DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen61_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN61DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen61_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen61_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen61_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen61_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen61_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen61_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen61_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 4.6")
    .Writeline("  GeometryMinorRadius   = 5.0")
    .Writeline("  GeometryHeight        = 57.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 7.0")
    .Writeline("  GeometryMinorRadius   = 27.0")
    .Writeline("  GeometryHeight        = 25.8")
    .Writeline("  GeometryOffset		= X:1.6 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral62")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen62")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen62_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN62DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen62_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN62DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen62_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN62DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen62_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN62DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen62_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen62_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen62_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen62_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen62_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen62_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen62_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 37.6")
    .Writeline("  GeometryHeight        = 32.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 8.2")
    .Writeline("  GeometryMinorRadius   = 39.2")
    .Writeline("  GeometryHeight        = 72.2")
    .Writeline("  GeometryOffset		= X:0 Y:-24.4 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral63")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen63")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen63_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN63DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen63_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN63DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen63_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN63DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen63_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN63DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen63_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen63_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen63_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("  ")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen63_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen63_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen63_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen63_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.8")
    .Writeline("  GeometryMinorRadius   = 29.6")
    .Writeline("  GeometryHeight        = 24.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 14.8")
    .Writeline("  GeometryMinorRadius   = 39.2")
    .Writeline("  GeometryHeight        = 60.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral64")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen64")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen64_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN64DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen64_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN64DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen64_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN64DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen64_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN64DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen64_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen64_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen64_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen64_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen64_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen64_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen64_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.0")
    .Writeline("  GeometryMinorRadius   = 34.4")
    .Writeline("  GeometryHeight        = 41.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 6.0")
    .Writeline("  GeometryMinorRadius   = 5.4")
    .Writeline("  GeometryHeight        = 74.0")
    .Writeline("  GeometryOffset		= X:0 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral65")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen65")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen65_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN65DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen65_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN65DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen65_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN65DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen65_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN65DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen65_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen65_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen65_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen65_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen65_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen65_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen65_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 20.0")
    .Writeline("  GeometryMinorRadius   = 47.2")
    .Writeline("  GeometryHeight        = 37.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 6.0")
    .Writeline("  GeometryMinorRadius   = 10.2")
    .Writeline("  GeometryHeight        = 79.6")
    .Writeline("  GeometryOffset		= X:8 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral66")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen66")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen66_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN66DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen66_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN66DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen66_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN66DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen66_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN66DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen66_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen66_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen66_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen66_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen66_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen66_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen66_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry				= BOX")
    .Writeline("  GeometryMajorRadius   = 15.2")
    .Writeline("  GeometryMinorRadius   = 30.4")
    .Writeline("  GeometryHeight        = 44.4")
    .Writeline("  GeometryOffset		= X:0 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("")
    .Writeline("")
    .Writeline(";  Geometry              = BOX")
    .Writeline(";  GeometryMajorRadius   = 15.2")
    .Writeline(";  GeometryMinorRadius   = 30.4")
    .Writeline(";  GeometryHeight        = 27.4")
    .Writeline(";  GeometryIsSmall       = No")
    .Writeline(";  ")
    .Writeline(";  AdditionalGeometry    = BOX")
    .Writeline(";  GeometryMajorRadius   = 4.0")
    .Writeline(";  GeometryMinorRadius   = 7.4")
    .Writeline(";  GeometryHeight        = 59.4")
    .Writeline(";  GeometryOffset		= X:-5.2 Y:0 Z:0")
    .Writeline(";  GeometryIsSmall       = No")
    .Writeline(";  ")
    .Writeline(";  AdditionalGeometry    = BOX")
    .Writeline(";  GeometryMajorRadius   = 8.0")
    .Writeline(";  GeometryMinorRadius   = 8.0")
    .Writeline(";  GeometryHeight        = 46.4")
    .Writeline(";  GeometryOffset		= X:8.2 Y:22.4 Z:0")
    .Writeline(";  GeometryIsSmall       = No")
    .Writeline(";  ")
    .Writeline(";  AdditionalGeometry    = BOX")
    .Writeline(";  GeometryMajorRadius   = 8.0")
    .Writeline(";  GeometryMinorRadius   = 8.0")
    .Writeline(";  GeometryHeight        = 46.4")
    .Writeline(";  GeometryOffset		= X:8.2 Y:-22.4 Z:0")
    .Writeline(";  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral67")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen67")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen67_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN67DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen67_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN67DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen67_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN67DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen67_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN67DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen67_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen67_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen67_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen67_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen67_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen67_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen67_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 17.4")
    .Writeline("  GeometryMinorRadius   = 21.8")
    .Writeline("  GeometryHeight        = 58.2")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 12.0")
    .Writeline("  GeometryMinorRadius   = 32.8")
    .Writeline("  GeometryHeight        = 14.2")
    .Writeline("  GeometryOffset		= X:5.4 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral68")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen68")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen68_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN68DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen68_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN68DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen68_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN68DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen68_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN68DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen68_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen68_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen68_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen68_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen68_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen68_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen68_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 14.4")
    .Writeline("  GeometryMinorRadius   = 48.0")
    .Writeline("  GeometryHeight        = 61.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral69")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen69")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen69_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN69DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen69_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN69DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen69_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN69DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen69_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN69DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen69_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen69_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen69_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen69_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen69_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen69_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen69_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 9.6")
    .Writeline("  GeometryMinorRadius   = 12.8")
    .Writeline("  GeometryHeight        = 36.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 5.6")
    .Writeline("  GeometryMinorRadius   = 7.8")
    .Writeline("  GeometryHeight        = 75")
    .Writeline("  GeometryOffset		= X:0 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral70")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen70")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen70_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN70DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen70_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN70DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen70_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN70DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen70_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN70DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen70_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen70_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen70_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen70_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen70_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen70_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen70_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 16.0")
    .Writeline("  GeometryMinorRadius   = 20.8")
    .Writeline("  GeometryHeight        = 68.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral71")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen71")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen71_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN71DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen71_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN71DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen71_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN71DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen71_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN71DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen71_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen71_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen71_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen71_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen71_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen71_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen71_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior                  = BuildingBehavior BuildingModuleTag")
    .Writeline("    NightWindowName         = Night01")
    .Writeline(";    FireWindowName          = win_f")
    .Writeline(";    NightFireWindowName     = win_nf")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 12.0")
    .Writeline("  GeometryMinorRadius   = 18.6")
    .Writeline("  GeometryHeight        = 26.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 8")
    .Writeline("  GeometryMinorRadius   = 12.6")
    .Writeline("  GeometryHeight        = 69.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral72")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen72")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen72_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN72DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen72_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN72DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen72_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN72DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen72_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN72DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen72_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen72_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen72_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen72_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen72_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen72_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen72_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 13.6")
    .Writeline("  GeometryMinorRadius   = 40.8")
    .Writeline("  GeometryHeight        = 43.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 11.8")
    .Writeline("  GeometryMinorRadius   = 40.8")
    .Writeline("  GeometryHeight        = 83.0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral73")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen73")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen73_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN73DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen73_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN73DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen73_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN73DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen73_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN73DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen73_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen73_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen73_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen73_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen73_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen73_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen73_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 8.8")
    .Writeline("  GeometryMinorRadius   = 11.4")
    .Writeline("  GeometryHeight        = 22.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 5.8")
    .Writeline("  GeometryMinorRadius   = 5.4")
    .Writeline("  GeometryHeight        = 59.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral74")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen74")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen74_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN74DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen74_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN74DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen74_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN74DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen74_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN74DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen74_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen74_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen74_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen74_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen74_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen74_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen74_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 10.4")
    .Writeline("  GeometryMinorRadius   = 39.2")
    .Writeline("  GeometryHeight        = 34.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 7.4")
    .Writeline("  GeometryMinorRadius   = 6.6")
    .Writeline("  GeometryHeight        = 63.6")
    .Writeline("  GeometryOffset		= X:0 Y:31.2 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral75")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen75")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen75_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN75DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen75_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN75DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen75_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN75DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen75_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN75DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen75_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen75_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen75_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen75_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen75_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen75_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen75_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 14.4")
    .Writeline("  GeometryMinorRadius   = 40.8")
    .Writeline("  GeometryHeight        = 33.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 10.4")
    .Writeline("  GeometryMinorRadius   = 4")
    .Writeline("  GeometryHeight        = 80.6")
    .Writeline("  GeometryOffset		= X:-1 Y:0 Z:0")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral76")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen76")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen76_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN76DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen76_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN76DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen76_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN76DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen76_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN76DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen76_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen76_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen76_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen76_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen76_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen76_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen76_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 11.2")
    .Writeline("  GeometryMinorRadius   = 27.2")
    .Writeline("  GeometryHeight        = 42.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral77")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen77")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen77_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN77DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen77_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN77DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen77_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN77DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen77_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN77DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen77_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen77_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen77_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen77_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen77_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen77_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen77_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = CYLINDER")
    .Writeline("  GeometryMajorRadius   = 24.2")
    .Writeline("  GeometryMinorRadius   = 22.4")
    .Writeline("  GeometryHeight        = 53.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 6.2")
    .Writeline("  GeometryMinorRadius   = 6.4")
    .Writeline("  GeometryHeight        = 83.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline("Object GondorBuildingGeneral78")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBGen78")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = GBGen09_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN78DP1" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = GBGen78_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN78DP2" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = GBGen78_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN78DP3" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = GBGen78_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "GBGEN78DP4" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = GBGen78_D1")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeMedium01 SmokeBuildingMedium")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = GBGen78_D2")
    .Writeline("      ParticleSysBone FireSmall01 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall02 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall03 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall04 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireSmall05 FireBuildingSmall")
    .Writeline("      ParticleSysBone FireMedium01 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireMedium02 FireBuildingMedium")
    .Writeline("      ParticleSysBone FireLarge01 FireBuildingLarge")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = GBGen78_D2")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("      Model         = None")
    .Writeline("      ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  SoundAmbientDamaged = GenericFireMediumLoop")
    .Writeline("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
    .Writeline("")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageStone")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:GondorBuildingGeneral")
    .Writeline("")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("    DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("")
    .Writeline("    DamageCreationList = OCL_Gen78_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen78_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen78_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList = OCL_Gen78_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3700")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ")
    .Writeline("  Behavior                = TransitionDamageFX ModuleTag_05")
    .Writeline("    ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 20.2")
    .Writeline("  GeometryMinorRadius   = 41.8")
    .Writeline("  GeometryHeight        = 39.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  ")
    .Writeline("  AdditionalGeometry    = BOX")
    .Writeline("  GeometryMajorRadius   = 5.2")
    .Writeline("  GeometryMinorRadius   = 6.8")
    .Writeline("  GeometryHeight        = 90.8")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline("")
    .Writeline("")
    .Writeline("")
    .Writeline(";-----------------------------------------------------------------------------------------------")
    .Writeline(";------------------------TESTING TESTING TESTING------------------------------------------------")
    .Writeline(";-----------------------------------------------------------------------------------------------")
    .Writeline(";-----------------------------------------------------------------------------------")
    .Writeline("")
    .Writeline("Object GBFSetTest")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBFSetTest")
    .Writeline("    End")
    .Writeline("    WallBoundsMesh = GBFactionSet1P")
    .Writeline(";    RampMesh1 = P1")
    .Writeline(";    RampMesh2 = P2")
    .Writeline(";    RampMesh3 = P3")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:Test")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL NOT_AUTOACQUIRABLE; SELECTABLE ")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus")
    .Writeline("		StartsActive	= Yes ;If no, requires upgrade to turn on.")
    .Writeline("		BonusName		= WallBonus")
    .Writeline("		RefreshDelay	= 2000")
    .Writeline("		;Range			= 120		; Range is overridden to affect people on us since we are a wall")
    .Writeline("		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall")
    .Writeline("	End	")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 20.8")
    .Writeline("  GeometryMinorRadius   = 88.0")
    .Writeline("  GeometryHeight        = 13.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";----------------------------------------------------------------------------------------------")
    .Writeline("")
    .Writeline("Object GBFSetTestRamp")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("      Model = GBFSetTestRamp")
    .Writeline("    End")
    .Writeline(";    WallBoundsMesh = GBFactionSet1P")
    .Writeline("    RampMesh1 = P1")
    .Writeline(";    RampMesh2 = P2")
    .Writeline(";    RampMesh3 = P3")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:Test")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL SELECTABLE NOT_AUTOACQUIRABLE")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus")
    .Writeline("		StartsActive	= Yes ;If no, requires upgrade to turn on.")
    .Writeline("		BonusName		= WallBonus")
    .Writeline("		RefreshDelay	= 2000")
    .Writeline("		;Range			= 120		; Range is overridden to affect people on us since we are a wall")
    .Writeline("		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall")
    .Writeline("	End	")
    .Writeline("")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 20.8")
    .Writeline("  GeometryMinorRadius   = 88.0")
    .Writeline("  GeometryHeight        = 13.6")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline(";  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------")
    .Writeline("")
    .Writeline("Object MTFinalTest")
    .Writeline("")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_01")
    .Writeline("  OkToChangeModelColor = Yes")
    .Writeline("  ")
    .Writeline("    ModelConditionState = NONE")
    .Writeline("      Model = GBMTNewFinal")
    .Writeline("    End")
    .Writeline("        ")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  ; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName      = OBJECT:Test")
    .Writeline("  EditorSorting   = STRUCTURE")
    .Writeline("")
    .Writeline("  ArmorSet")
    .Writeline("    Conditions        = None")
    .Writeline("    Armor             = NoArmor")
    .Writeline("    DamageFX          = None")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***  ")
    .Writeline("  KindOf                = STRUCTURE SELECTABLE IMMOBILE ")
    .Writeline("  RadarPriority = STRUCTURE")
    .Writeline("  Body                  = ActiveBody ModuleTag_02")
    .Writeline("    MaxHealth       = 2000.0")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  ; Note that structures with "  & chr(34) & "RUBBLE"  & chr(34) & " states should not use DestroyDie; such buildings are ")
    .Writeline("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
    .Writeline("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
    .Writeline("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
    .Writeline("      DestructionDelay  = 3000")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Geometry              = BOX")
    .Writeline("  GeometryMajorRadius   = 9.6")
    .Writeline("  GeometryMinorRadius   = 6.4")
    .Writeline("  GeometryHeight        = 98.4")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("End")
    .Writeline("")
    .Writeline("")
    .Writeline("")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline(";Lumber Mill")
    .Writeline("Object LumberMill")
    .Writeline(" ")
    .Writeline(" SelectPortrait = BPCLumberMill")
    .Writeline("  ; *** ART Parameters ***")
    .Writeline(";  SelectPortrait         = SNReactor_L")
    .Writeline(";  ButtonImage            = SNReactor")
    .Writeline("  ;day")
    .Writeline("")
    .Writeline(";  Draw                = W3DModelDraw ModuleTag_01")
    .Writeline(";    OkToChangeModelColor = Yes")
    .Writeline(";")
    .Writeline(";    DefaultConditionState")
    .Writeline(";      Model           = RBBarracks")
    .Writeline(";;     FXEvent = 1  FX_TrebuchetImpactHit ; sample of method to fire FXList at desired animation frames")
    .Writeline(";;     FXEvent = 30 FX_TrebuchetImpactHit ; sample of method to fire FXList at desired animation frames")
    .Writeline(";;     FXEvent = 50 FX_TrebuchetImpactHit ; sample of method to fire FXList at desired animation frames")
    .Writeline(";    End")
    .Writeline(";  End")
    .Writeline("")
    .Writeline("")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
    .Writeline("")
    .Writeline("	ExtraPublicBone = ARROW_01")
    .Writeline("	ExtraPublicBone = ARROW_02")
    .Writeline("	ExtraPublicBone = ARROW_03")
    .Writeline("	ExtraPublicBone = ARROW_04")
    .Writeline("	ExtraPublicBone = ARROW_05")
    .Writeline("	ExtraPublicBone = ARROW_06")
    .Writeline("	ExtraPublicBone = ARROW_07")
    .Writeline("	ExtraPublicBone = ARROW_08")
    .Writeline("")
    .Writeline("    OkToChangeModelColor  = Yes")
    .Writeline("    UseStandardModelNames = Yes")
    .Writeline("	StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD  ")
    .Writeline("	DefaultModelConditionState")
    .Writeline("		Model = MBLumMill_SKN")
    .Writeline("	  ")
    .Writeline("		;ParticleSysBone = Bone_Smoke01 forgeSmoke")
    .Writeline("		;ParticleSysBone = Bone_Fire01 FireBuildingLarge")
    .Writeline("")
    .Writeline(";		ParticleSysBone = Bone_Smoke01 CampFireSmoke")
    .Writeline(";		ParticleSysBone = Bone_Smoke01 CampfireGlow")
    .Writeline("		ParticleSysBone = Bone_Smoke01 CampfireEmbersReg")
    .Writeline("		WeaponLaunchBone = PRIMARY ARROW_")
    .Writeline("	End")
    .Writeline("          ")
    .Writeline("    IdleAnimationState")
    .Writeline("		StateName	=	STATE_Idle")
    .Writeline("		Animation = IdleA")
    .Writeline("			AnimationName		=	MBLumMill_SKL.MBLumMill_IDLD")
    .Writeline("			AnimationMode		=	LOOP ")
    .Writeline("			AnimationBlendTime	=	0")
    .Writeline("		End")
    .Writeline("		FXEvent				= Frame:193 Name:FX_LumberFire")
    .Writeline("		Flags               = RANDOMSTART ")
    .Writeline("	End")
    .Writeline("	")
    .Writeline("	")
    .Writeline("	")
    .Writeline("    ;------------ Build Up States")
    .Writeline("    ModelConditionState   = AWAITING_CONSTRUCTION ")
    .Writeline("      Model               = MBLumMill_A")
    .Writeline(";		ParticleSysBone	  = NONE BuildingDoughnutCloud")
    .Writeline("    End;")
    .Writeline("    AnimationState        = AWAITING_CONSTRUCTION")
    .Writeline("      Animation           =  MBLumMill_A")
    .Writeline("        AnimationName     =  MBLumMill_ASKL.MBLumMill_ABLD")
    .Writeline("        AnimationMode     = MANUAL")
    .Writeline("        AnimationBlendTime = 0")
    .Writeline("      End")
    .Writeline("	Flags				  = START_FRAME_FIRST")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED")
    .Writeline("      Model               = MBLumMill_A")
    .Writeline("		ParticleSysBone   = CONSTDUSTBONE01 BuildingContructDust FollowBone:Yes")
    .Writeline("    End;")
    .Writeline("    AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED")
    .Writeline("		Animation           = MBLumMill_A")
    .Writeline("			AnimationName     = MBLumMill_ASKL.MBLumMill_ABLD")
    .Writeline("			AnimationMode     = MANUAL")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags				  = START_FRAME_FIRST")
    .Writeline("		StateName			  = BeingConstructed")
    .Writeline("	BeginScript")
            .WriteLine("		CurDrawablePlaySound(" & Chr(34) & "GondorBarracksBeginConstruction" & Chr(34) & ")")
    .Writeline("	EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ")
    .Writeline("        ;--damaged building")
    .Writeline("      ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = MBLumMill_D2  ")
    .Writeline("        ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall04 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall05 FireBuildingLarge ")
    .Writeline("    End")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBLumMill_D2a" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("        ModelConditionState  = DESTROYED_RIGHT")
    .Writeline("      Model         = MBLumMill_D2  ")
    .Writeline("        ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall04 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall05 FireBuildingLarge ")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_RIGHT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBLumMill_D2b" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("")
    .Writeline("    ModelConditionState  = DESTROYED_BACK")
    .Writeline("      Model         = MBLumMill_D2  ")
    .Writeline("        ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall04 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall05 FireBuildingLarge ")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    AnimationState = DESTROYED_BACK")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBLumMill_D2c" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("	ModelConditionState  = DESTROYED_LEFT")
    .Writeline("      Model         = MBLumMill_D2  ")
    .Writeline("        ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall04 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall05 FireBuildingLarge ")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = DESTROYED_LEFT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBLumMill_D2d" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ")
    .Writeline("    ModelConditionState  = DAMAGED")
    .Writeline("      Model         = MBLumMill_D1")
    .Writeline("        ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall04 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall05 FireBuildingMedium ")
    .Writeline("    End")
    .Writeline("    AnimationState = DAMAGED")
    .Writeline("     EnteringStateFX	= FX_BuildingDamaged")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = REALLYDAMAGED")
    .Writeline("      Model         = MBLumMill_D2  ")
    .Writeline("        ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall04 FireBuildingMedium")
    .Writeline("		ParticleSysBone FireSmall05 FireBuildingLarge ")
    .Writeline("    End")
    .Writeline("    AnimationState = REALLYDAMAGED")
    .Writeline("     	EnteringStateFX	= FX_BuildingReallyDamaged")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = RUBBLE")
    .Writeline("      Model         = MBLumMill_D2  ")
    .Writeline("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    AnimationState = RUBBLE")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBLumMill_D2a" & Chr(34) & ")")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBLumMill_D2b" & Chr(34) & ")")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBLumMill_D2c" & Chr(34) & ")")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBLumMill_D2d" & Chr(34) & ")")
    .Writeline("      EndScript")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_RUBBLE")
    .Writeline("		Model         = None")
    .Writeline("		ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState  = POST_COLLAPSE")
    .Writeline("		 Model         = None")
    .Writeline("		ParticleSysBone NONE SmokeBuildingMediumRubble")
    .Writeline("    End")
    .Writeline("")
    .Writeline("	;------------- With fuels the fire effect	")
    .Writeline(" ;   AnimationState = UPGRADE_ECONOMY_BONUS")
    .Writeline(";		StateName	=	STATE_Idle")
    .Writeline(";		Animation = IdleA")
    .Writeline(";			AnimationName		=	MBLumMill_SKL.MBLumMill_IDLD")
    .Writeline(";			AnimationMode		=	LOOP ")
    .Writeline(";			AnimationBlendTime	=	0")
    .Writeline(";		End")
    .Writeline(";		FXEvent			= Frame:193 Name:FX_LumberFire")
    .Writeline(";		ParticleSysBone		= None FueltheFiresEmbers")
    .Writeline(";	End")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Draw = W3DFloorDraw DrawFloor_Bib    ")
    .Writeline("	StaticModelLODMode = Yes		; THIS NEEDS TO BE COMMENTED OUT WHEN ENGINEERING ENABLES LOD'S IN THE FLOOR DRAW - Sean O.")
    .Writeline("    ModelName = MBLumMill_Bib")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  Draw = W3DFloorDraw DrawFloor_V1")
    .Writeline("     ModelName = MBLumMill_V1")
    .Writeline("	 StartHidden = Yes")
    .Writeline("  End")
    .Writeline("")
    .Writeline("	Draw = W3DScriptedModelDraw Draw_BonusEffects")
    .Writeline("	    DefaultModelConditionState")
    .Writeline("	      Model = None")
    .Writeline("	    End")
    .Writeline("	    AnimationState = ACTIVELY_BEING_CONSTRUCTED")
    .Writeline("	    End")
    .Writeline("		AnimationState = UPGRADE_ECONOMY_BONUS")
    .Writeline(";			FXEvent			= Frame:193 Name:FX_LumberFire")
    .Writeline("			ParticleSysBone	= None FueltheFiresEmbers")
    .Writeline("		End")
    .Writeline("	End")
    .Writeline("  ")
    .Writeline("; Not working correctly, so taken out.")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_Draw_HCBanner")
    .Writeline("    OkToChangeModelColor  = Yes")
    .Writeline("	 DefaultModelConditionState")
    .Writeline("	   Model = MBHCLumberMill")
    .Writeline("    End")
    .Writeline("    MultiPlayerOnly = Yes ")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("  PlacementViewAngle  = 0")
    .Writeline(" ")
    .Writeline("  ; ***DESIGN parameters ***")
    .Writeline("  DisplayName         = OBJECT:LumberMill")
    .Writeline("  Description         = OBJECT:LumberMillDescription")
    .Writeline("  Side                = Civilian")
    .Writeline("  EditorSorting       = STRUCTURE")
    .Writeline("  ThreatLevel = 1.0")
    .Writeline(" ")
    .Writeline("  BuildCost           = MORDOR_LUMBERMILL_BUILDCOST")
    .Writeline("  BuildTime           = MORDOR_LUMBERMILL_BUILDTIME")
    .Writeline("  BountyValue         = MORDOR_LUMBERMILL_BOUNTY_VALUE")
    .Writeline("  VisionRange         = 160.0          ; Shroud clearing distance")
    .Writeline("  ShroudClearingRange = MORDOR_LUMBERMILL_SHROUD_CLEAR")
    .Writeline("")
    .Writeline("	ArmorSet")
    .Writeline("	  Conditions        = None")
    .Writeline("	  Armor             = StructureArmor")
    .Writeline("	  ;DamageFX          = StructureDamageFXNoShake")
    .Writeline("	End")
    .Writeline("")
    .Writeline("	WeaponSet")
    .Writeline("		Conditions			= None")
    .Writeline("	End")
    .Writeline("")
    .Writeline("	WeaponSet")
    .Writeline("		Weapon				= PRIMARY EvilStructureBow")
    .Writeline("		Conditions			= PLAYER_UPGRADE")
    .Writeline("		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI")
    .Writeline("	End")
    .Writeline("")
    .Writeline(" CommandSet = LumberMillCommandSet")
    .Writeline("")
    .Writeline("	; *** AUDIO Parameters ***")
    .Writeline("")
    .Writeline("	VoiceSelect				= MordorLumberMillSelect")
    .Writeline("")
    .Writeline("	SoundAmbient			= Campfire1AmbientLoop")
    .Writeline("	SoundOnDamaged			= BuildingLightDamageWood")
    .Writeline("	SoundOnReallyDamaged		= BuildingHeavyDamageWood")
    .Writeline(" ")
    .Writeline("	VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction")
    .Writeline("")
    .Writeline("	UnitSpecificSounds")
    .Writeline("		UnderConstruction		= BuildingConstructionLoop  ; Built first time")
    .Writeline("		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound")
    .Writeline("		UnderRepairFromRubble	= BuildingConstructionLoop	; Repaired from completely destroyed (not used???)")
    .Writeline("	End")
    .Writeline("")
    .Writeline("	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior")
    .Writeline("		MaxUpdateRangeCap = 800")
    .Writeline("		AnimationSound = Sound:MordorLumbermillSawForward 	Animation:MBLumMill_SKL.MBLumMill_IDLD 	Frames:168 241 265 286 311 330")
    .Writeline("		AnimationSound = Sound:MordorLumbermillSawForward 	Animation:MBLumMill_SKL.MBLumMill_IDLD 	Frames:12 37 57 80 98 122 142")
    .Writeline("		AnimationSound = Sound:MordorLumbermillSawBack 		Animation:MBLumMill_SKL.MBLumMill_IDLD 	Frames:3 25 47 66 89 110 131")
    .Writeline("		AnimationSound = Sound:MordorLumbermillSawBack 		Animation:MBLumMill_SKL.MBLumMill_IDLD 	Frames:153 229 252 274 297 322")
    .Writeline("")
    .Writeline("		AnimationSound = Sound:MordorLumbermillLog 		Animation:MBLumMill_SKL.MBLumMill_IDLD 	Frames:174 190")
    .Writeline("		AnimationSound = Sound:MordorLumbermillFireBurst	Animation:MBLumMill_SKL.MBLumMill_IDLD 	Frames:193")
    .Writeline("	End")
    .Writeline("")
    .Writeline("")
    .Writeline("  ; *** ENGINEERING Parameters ***")
    .Writeline("")
    .Writeline("  RadarPriority       = STRUCTURE")
    .Writeline("  KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE NEED_BASE_FOUNDATION CASTLE_KEEP SUPPLY_GATHERING_CENTER AUTO_RALLYPOINT FS_FACTORY FS_CASH_PRODUCER CAN_ATTACK")
    .Writeline("							;MP_COUNT_FOR_VICTORY;removed so econ plots will not keep zombie games going")
    .Writeline("")
    .Writeline("")
    .Writeline("  Body                = StructureBody ModuleTag_05")
    .Writeline("    MaxHealth               = MORDOR_LUMBERMILL_HEALTH")
    .Writeline("    MaxHealthDamaged        = MORDOR_LUMBERMILL_HEALTH_DAMAGED")
    .Writeline("	MaxHealthReallyDamaged  = MORDOR_LUMBERMILL_HEALTH_REALLY_DAMAGED")
    .Writeline("	 DamageCreationList		= OCL_BuildingDamageList01 CATAPULT_ROCK")
    .Writeline("  ")
    .Writeline("    DamageCreationList		= OCL_MBLumMill_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
    .Writeline("    DamageCreationList		= OCL_MBLumMill_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
    .Writeline("    DamageCreationList		= OCL_MBLumMill_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
    .Writeline("    DamageCreationList		= OCL_MBLumMill_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
    .Writeline("    ")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("	Behavior = TooltipUpgrade ModuleTag_MordorTooltip")
    .Writeline("		TriggeredBy				= Upgrade_MordorFaction")
    .Writeline("		DisplayName				= OBJECT:MordorLumberMill")
    .Writeline("	End")
    .Writeline("	Behavior = TooltipUpgrade ModuleTag_IsengardTooltip")
    .Writeline("		TriggeredBy				= Upgrade_IsengardFaction")
    .Writeline("		DisplayName				= OBJECT:IsengardLumberMill")
    .Writeline("	End")
    .Writeline("")
    .Writeline("	Behavior = CostModifierUpgrade ModuleTag_CostModifier")
    .Writeline("		LabelForPalantirString = GUI:WOOD_DISCOUNT")
    .Writeline("		StartsActive = Yes ; Run on build complete, not upgrade")
    .Writeline("		ObjectFilter		= ANY +STRUCTURE")
    .Writeline("		Percentage		= 0%")
    .Writeline("		Percentage		= -10%")
    .Writeline("		Percentage		= -20%")
    .Writeline("		Percentage		= -30%")
    .Writeline("	End")
    .Writeline(" ")
    .Writeline("  Behavior = ProductionUpdate ProductionUpdateModuleTag")
    .Writeline("    ; nothing, but is required if we have any Object-level Upgrades!")
    .Writeline("  End")
    .Writeline(" ")
    .Writeline("  Behavior            = GettingBuiltBehavior GetBuiltBehaviorTag")
    .Writeline("    WorkerName		  = MordorWorkerNoSelect")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior = SupplyCenterCreate ModuleTag_RegisterAsSupplyCenter")
    .Writeline("    ;nothing")
    .Writeline("  End")
    .Writeline("")
    .Writeline("	Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon")
    .Writeline("		AutoAcquireEnemiesWhenIdle	= Yes")
    .Writeline("		MoodAttackCheckRate			= 250")
    .Writeline("	End")
    .Writeline("")
    .Writeline("  Behavior = SupplyCenterProductionExitUpdate ModuleTag_GuysMadeFromMeGoHarvest")
    .Writeline("    UnitCreatePoint   = X:  0.0  Y:  0.0   Z:0.0")
    .Writeline("    NaturalRallyPoint = X: 60.0  Y:  0.0   Z:0.0;NaturalRallyPointX must always match GeometryMajorRadius! -ML")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior            = SpawnBehavior ModuleTag_FreeWorker")
    .Writeline("    SpawnNumber       = 4")
    .Writeline("    SpawnReplaceDelay = 9999")
    .Writeline("    SpawnTemplateName = MordorWorker")
    .Writeline("    OneShot           = Yes")
    .Writeline("    CanReclaimOrphans = No")
    .Writeline("    RespectCommandLimit = Yes")
    .Writeline("  End")
    .Writeline("")
    .Writeline("  Behavior = SupplyCenterDockUpdate ModuleTag_SupplyCenter")
    .Writeline("	AllowsPassthrough = No ")
    .Writeline("    NumberApproachPositions = -1 ; No bones, just touch")
    .Writeline("    BonusScience = SCIENCE_FueltheFires")
    .Writeline("    BonusScienceMultiplier = 200%")
    .Writeline(";   ValueMultiplier = 2.0 ; this value will be used to multiply the value set in gamedata.ini to get the final amount")
    .Writeline("  End")
    .Writeline("  ")
    .Writeline("   	Behavior = SubObjectsUpgrade ModuleTag_HideAll")
    .Writeline("		TriggeredBy		= Upgrade_StructureLevel1")
    .Writeline("		HideSubObjects	= V2 DrawFloor_V1")
    .Writeline("	End")
    .Writeline("	")
    .Writeline("  	Behavior = SubObjectsUpgrade ModuleTag_ShowWalls ")
    .Writeline("		TriggeredBy		= Upgrade_StructureLevel2")
    .Writeline("		ShowSubObjects	= DrawFloor_V1")
    .Writeline("		HideSubObjects	= V2 DrawFloor_Bib")
    .Writeline("	End")
    .Writeline("	")
    .Writeline("	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower ")
    .Writeline("		TriggeredBy		= Upgrade_StructureLevel3")
    .Writeline("		ShowSubObjects	= DrawFloor_V1 V2")
    .Writeline("		HideSubObjects	= DrawFloor_Bib")
    .Writeline("	End")
    .Writeline("  	Behavior = WeaponSetUpgrade ModuleTag_ThirdLevelBuildingArrows")
    .Writeline("		TriggeredBy		= Upgrade_StructureLevel3")
    .Writeline("		ConflictsWith	= Upgrade_EasyAIMultiPlayer")
    .Writeline("	End")
    .Writeline(" ")
    .Writeline(";  Behavior           = CreateObjectDie ModuleTag_08")
    .Writeline(";    CreationList     = OCL_SmallStructureDebris")
    .Writeline(";  End")
    .Writeline(" ")
    .Writeline(";  Behavior = ProductionUpdate ModuleTag_10")
    .Writeline(";    ; nothing, but is required if we have any Object-level Upgrades!")
    .Writeline(";  End")
    .Writeline(" ")
    .Writeline(";  Behavior = FlammableUpdate ModuleTag_14")
    .Writeline(";    AflameDuration = 5000         ; If I catch fire, I'll burn for this long...")
    .Writeline(";    AflameDamageAmount = 5       ; taking this much damage...")
    .Writeline(";    AflameDamageDelay = 500       ; this often.")
    .Writeline(";  End")
    .Writeline(" ")
    .Writeline(";  Behavior = TransitionDamageFX ModuleTag_15")
    .Writeline(";    ;-------------DESIGNED FOR SMALL SIZED FACTION BUILDING TRANSITIONS-------------------")
    .Writeline(";    DamagedParticleSystem1       = Bone:None RandomBone:No PSys:StructureTransitionSmallSmoke")
    .Writeline(";    ;---------------------------------------------------------------------------------------")
    .Writeline(";    ReallyDamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionSmallSmoke")
    .Writeline(";    ReallyDamagedParticleSystem2 = Bone:None RandomBone:No PSys:StructureTransitionSmallExplosion")
    .Writeline(";    ReallyDamagedParticleSystem3 = Bone:None RandomBone:No PSys:StructureTransitionSmallShockwave")
    .Writeline(";  End")
    .Writeline(" ")
    .Writeline(";  Behavior             = FXListDie ModuleTag_16")
    .Writeline(";    DeathFX       = FX_BuildingDie")
    .Writeline(";  End")
    .Writeline(" ")
    .Writeline(" ")
    .Writeline("  Behavior                  = StructureCollapseUpdate ModuleTag_08")
    .Writeline("    MinCollapseDelay        = 000")
    .Writeline("    MaxCollapseDelay        = 000")
    .Writeline("    CollapseDamping         = .5")
    .Writeline("    MaxShudder              = 0.6")
    .Writeline("    MinBurstDelay           = 250")
    .Writeline("    MaxBurstDelay           = 800")
    .Writeline("    BigBurstFrequency       = 4")
    .Writeline("    FXList                  = INITIAL   FX_StructureMediumCollapse")
    .Writeline("    FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse")
    .Writeline("	DestroyObjectWhenDone	= Yes")
    .Writeline("	CollapseHeight			= 89")
    .Writeline("  End")
    .Writeline("")
    .Writeline("    Behavior = CastleMemberBehavior ModuleTag_CMB")
    .Writeline("		; Special Eva events when attacked")
    .Writeline("		UnderAttackEvaEventIfKeep = EconPlotUnderAttack")
    .Writeline("		UnderAttackAllyEvaEventIfKeep = None")
    .Writeline("")
    .Writeline("		; Special Eva events if an econ plot is taken down")
    .Writeline("		CampDestroyedOwnerEvaEvent = EconPlotDestroyed")
    .Writeline("		CampDestroyedAllyEvaEvent = AllyEconPlotDestroyed")
    .Writeline("		CampDestroyedAttackerEvaEvent = EnemyEconPlotDestroyed")
    .Writeline("    End ")
    .Writeline("")
    .Writeline("	Behavior = GeometryUpgrade Geom_ModuleTag_HideAll")
    .Writeline("		TriggeredBy		= Upgrade_StructureLevel1")
    .Writeline("		ShowGeometry	= Geom_Orig")
    .Writeline("		HideGeometry	= Geom_V2")
    .Writeline("	End")
    .Writeline("	Behavior = GeometryUpgrade Geom_ModuleTag_ShowWalls ")
    .Writeline("		TriggeredBy		= Upgrade_StructureLevel2")
    .Writeline("		ShowGeometry	= Geom_Orig")
    .Writeline("		HideGeometry	= Geom_V2 ")
    .Writeline("	End")
    .Writeline("	Behavior = GeometryUpgrade Geom_ModuleTag_ShowFlagsAndTower ")
    .Writeline("		TriggeredBy		= Upgrade_StructureLevel3")
    .Writeline("		ShowGeometry	= Geom_Orig Geom_V2")
    .Writeline("	End")
    .Writeline("")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryName			= Geom_Orig")
    .Writeline("  GeometryMajorRadius   = 55.0")
    .Writeline("  GeometryMinorRadius   = 55.0")
    .Writeline("  GeometryHeight        = 40.0")
    .Writeline("  GeometryOffset		= X:-8 Y:3.5 Z:0")
    .Writeline("    ")
    .Writeline("  AdditionalGeometry    = CYLINDER")
    .Writeline("  GeometryName			= Geom_V2")
    .Writeline("  GeometryMajorRadius   = 16")
    .Writeline("  GeometryMinorRadius   = 16")
    .Writeline("  GeometryHeight        = 76.0")
    .Writeline("  GeometryOffset		= X:-40 Y:-33 Z:0")
    .Writeline("  ")
    .Writeline("  GeometryIsSmall       = No")
    .Writeline("  Shadow                = SHADOW_VOLUME")
    .Writeline("  BuildCompletion     = PLACED_BY_PLAYER")
    .Writeline("  ")
    .Writeline("  GeometryContactPoint	= X:-34.46		Y:58.195	Z:0			Repair")
    .Writeline("  GeometryContactPoint	= X:32.816		Y:-12.328	Z:0			Repair")
    .Writeline("  GeometryContactPoint	= X:37.903		Y:52.182	Z:0")
    .Writeline("  GeometryContactPoint	= X:-61.108		Y:-23.796	Z:0")
    .Writeline("  GeometryContactPoint	= X:-38.697		Y:-10.41	Z:45.943	Swoop")
    .Writeline("End")
    .Writeline("")
    .Writeline(";------------------------------------------------------------------------------")
    .Writeline(";Slaughter House")
    .Writeline("Object SlaughterHouse")
    .Writeline("")
    .Writeline("SelectPortrait = BPCSlaughterHouse")
    .Writeline("")
    .Writeline("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
    .Writeline(" 	ExtraPublicBone = Arrow_01")
    .Writeline(" 	ExtraPublicBone = Arrow_02")
    .Writeline(" 	ExtraPublicBone = Arrow_03")
    .Writeline(" 	ExtraPublicBone = Arrow_04")
    .Writeline(" 	ExtraPublicBone = Arrow_05")
    .Writeline(" 	ExtraPublicBone = Arrow_06")
    .Writeline(" 	ExtraPublicBone = Arrow_07")
    .Writeline(" 	ExtraPublicBone = Arrow_08")
    .Writeline(" 	ExtraPublicBone = Arrow_09")
    .Writeline(" 	ExtraPublicBone = Arrow_10")
    .Writeline(" 	ExtraPublicBone = Arrow_11")
    .Writeline(" 	ExtraPublicBone = Arrow_12")
    .Writeline(" 	")
    .Writeline("   OkToChangeModelColor  = Yes")
    .Writeline("    UseStandardModelNames = Yes")
    .Writeline("	StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD  ")
    .Writeline("    DefaultModelConditionState")
    .Writeline("		Model = MBSltrHs_SKN")
    .Writeline("		WeaponLaunchBone = PRIMARY Arrow_")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    IdleAnimationState")
    .Writeline("		StateName					=   STATE_Idle")
    .Writeline("		Animation = IdleA")
    .Writeline("			AnimationName			=	MBSltrHs_SKL.MBSltrHs_LOOP		")
    .Writeline("			AnimationMode		=	ONCE ")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("")
    .Writeline("		Flags               = RESTART_ANIM_WHEN_COMPLETE ")
    .Writeline("")
    .Writeline("		;BeginScript")
    .Writeline("		;	Prev = CurDrawablePrevAnimationState()")
            .WriteLine("		;	if Prev == " & Chr(34) & "BeingConstructed" & Chr(34) & " then ")
    .Writeline("		;	    ; Don't play completed sound when canceling build-in-progress or when")
    .Writeline("		;	    ; destroyed halfway")
            .WriteLine("		;		if not CurDrawableModelcondition( " & Chr(34) & "DYING" & Chr(34) & " ) then ")
            .WriteLine("		;			CurDrawablePlaySound(" & Chr(34) & "CampOrcCompleteGeneric" & Chr(34) & ")")
    .Writeline("		;		end")
    .Writeline("		;	end")
    .Writeline("		;EndScript")
    .Writeline("	End")
    .Writeline("	")
    .Writeline("	")
    .Writeline("")
    .Writeline("    ;------------ Build Up States ")
    .Writeline("    ModelConditionState   = AWAITING_CONSTRUCTION ")
    .Writeline("      Model               = MBSltrHs_A")
    .Writeline(";		ParticleSysBone	  = NONE BuildingDoughnutCloud")
    .Writeline("    End;")
    .Writeline("    AnimationState        = AWAITING_CONSTRUCTION")
    .Writeline("      Animation           =  MBSltrHs_A")
    .Writeline("        AnimationName     =  MBSltrHs_ASKL.MBSltrHs_ABLD")
    .Writeline("        AnimationMode     = MANUAL")
    .Writeline("        AnimationBlendTime = 0")
    .Writeline("      End")
    .Writeline("	Flags				  = START_FRAME_FIRST")
    .Writeline("    End")
    .Writeline("")
    .Writeline("    ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED")
    .Writeline("      Model               = MBSltrHs_A")
    .Writeline("		ParticleSysBone   = CONSTDUSTBONE01 BuildingContructDust FollowBone:Yes")
    .Writeline("    End")
    .Writeline("    AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED")
    .Writeline("		Animation           = MBSltrHs_A")
    .Writeline("			AnimationName     = MBSltrHs_ASKL.MBSltrHs_ABLD")
    .Writeline("			AnimationMode     = MANUAL")
    .Writeline("			AnimationBlendTime = 0")
    .Writeline("		End")
    .Writeline("		Flags				  = START_FRAME_FIRST")
    .Writeline("		StateName			  = BeingConstructed")
    .Writeline("	BeginScript")
            .WriteLine("		CurDrawablePlaySound(" & Chr(34) & "GondorBarracksBeginConstruction" & Chr(34) & ")")
    .Writeline("	EndScript")
    .Writeline("    End")
    .Writeline("    ")
    .Writeline("    ")
    .Writeline("        ;--damaged building")
    .Writeline("      ModelConditionState  = DESTROYED_FRONT")
    .Writeline("      Model         = MBSltrHs_D2  ")
    .Writeline("      	ParticleSysBone FireSmall01 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall02 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall04 FireBuildingLarge")
    .Writeline("		ParticleSysBone FireSmall05 FireBuildingMedium ")
    .Writeline("    End")
    .Writeline("    AnimationState = DESTROYED_FRONT")
    .Writeline("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "D2A" & Chr(34) & ")")
            .WriteLine("      EndScript")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("        ModelConditionState  = DESTROYED_RIGHT")
            .WriteLine("      Model         = MBSltrHs_D2  ")
            .WriteLine("      	ParticleSysBone FireSmall01 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall02 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall04 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall05 FireBuildingMedium ")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    AnimationState = DESTROYED_RIGHT")
            .WriteLine("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "D2B" & Chr(34) & ")")
            .WriteLine("      EndScript")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = DESTROYED_BACK")
            .WriteLine("      Model         = MBSltrHs_D2  ")
            .WriteLine("      	ParticleSysBone FireSmall01 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall02 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall04 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall05 FireBuildingMedium ")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    AnimationState = DESTROYED_BACK")
            .WriteLine("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "D2C" & Chr(34) & ")")
            .WriteLine("      EndScript")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("	ModelConditionState  = DESTROYED_LEFT")
            .WriteLine("      Model         = MBSltrHs_D2  ")
            .WriteLine("      	ParticleSysBone FireSmall01 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall02 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall04 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall05 FireBuildingMedium ")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("    AnimationState = DESTROYED_LEFT")
            .WriteLine("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "D2D" & Chr(34) & ")")
            .WriteLine("      EndScript")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("    ")
            .WriteLine("    ModelConditionState  = DAMAGED")
            .WriteLine("      Model         = MBSltrHs_D1")
            .WriteLine("      	ParticleSysBone FireSmall01 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall02 FireBuildingMedium")
            .WriteLine("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall04 FireBuildingMedium")
            .WriteLine("		ParticleSysBone FireSmall05 FireBuildingMedium ")
            .WriteLine("	")
            .WriteLine("    End")
            .WriteLine("    AnimationState = DAMAGED")
            .WriteLine("     EnteringStateFX	= FX_BuildingDamaged")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = REALLYDAMAGED")
            .WriteLine("      Model         = MBSltrHs_D2  ")
            .WriteLine("      	ParticleSysBone FireSmall01 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall02 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall04 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall05 FireBuildingMedium ")
            .WriteLine("		")
            .WriteLine("    End")
            .WriteLine("    AnimationState = REALLYDAMAGED")
            .WriteLine("     	EnteringStateFX	= FX_BuildingReallyDamaged")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = MBSltrHs_D2  ")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("    AnimationState = RUBBLE")
            .WriteLine("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "D2A" & Chr(34) & ")")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "D2B" & Chr(34) & ")")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "D2C" & Chr(34) & ")")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "D2D" & Chr(34) & ")")
            .WriteLine("      EndScript")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("		Model         = None")
            .WriteLine("		ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("		 Model         = None")
            .WriteLine("		ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("	;------------- With industry effect")
            .WriteLine(";    AnimationState = UPGRADE_ECONOMY_BONUS")
            .WriteLine(";		StateName	=	STATE_Idle")
            .WriteLine(";		Animation = IdleA")
            .WriteLine(";			AnimationName		=	MBSltrHs_SKL.MBSltrHs_LOOP")
            .WriteLine(";			AnimationMode		=	LOOP ")
            .WriteLine(";			AnimationBlendTime	=	0")
            .WriteLine(";		End")
            .WriteLine(";		ParticleSysBone		= None Industry")
            .WriteLine(";	End    ")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Draw = W3DFloorDraw DrawFloor_Bib    ")
            .WriteLine("		StaticModelLODMode = Yes		; THIS NEEDS TO BE COMMENTED OUT WHEN ENGINEERING ENABLES LOD'S IN THE FLOOR DRAW - Sean O.")
            .WriteLine("     ModelName = MBSltrHs_Bib")
            .WriteLine("  End")
            .WriteLine(" ")
            .WriteLine("  Draw = W3DFloorDraw DrawFloor_V1    ")
            .WriteLine("     ModelName = MBSltrHs_V1")
            .WriteLine("	 StartHidden = Yes")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DScriptedModelDraw Draw_BonusEffects")
            .WriteLine("	    DefaultModelConditionState")
            .WriteLine("	      Model = None")
            .WriteLine("	    End")
            .WriteLine("	    AnimationState = ACTIVELY_BEING_CONSTRUCTED")
            .WriteLine("	    End")
            .WriteLine("		AnimationState = UPGRADE_ECONOMY_BONUS")
            .WriteLine("			ParticleSysBone = None Industry")
            .WriteLine("		End")
            .WriteLine("	End")
            .WriteLine("  ")
            .WriteLine("; Not working correctly, so taken out.  ")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw_HCBanner")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("	DefaultModelConditionState")
            .WriteLine("		Model = MBHCSltrHs")
            .WriteLine("    End")
            .WriteLine("    MultiPlayerOnly = Yes ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ")
            .WriteLine("	WeaponSet")
            .WriteLine("		Conditions			= None")
            .WriteLine("	End")
            .WriteLine("	WeaponSet")
            .WriteLine("		Conditions			= PLAYER_UPGRADE")
            .WriteLine("		Weapon				= PRIMARY KeepBow")
            .WriteLine("		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI")
            .WriteLine("	End")
            .WriteLine("  ")
            .WriteLine("  ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:MordorSlaughterHouse")
            .WriteLine("  Description         = OBJECT:SlaughterHouseDescription")
            .WriteLine("  Side                = Mordor")
            .WriteLine("  EditorSorting       = STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("  ")
            .WriteLine("  CommandSet = SellableCommandSet")
            .WriteLine("  ")
            .WriteLine("  PlacementViewAngle  = 0  ; 45")
            .WriteLine("")
            .WriteLine("	 ")
            .WriteLine("  BuildCost           = MORDOR_SLAUGHTERHOUSE_BUILDCOST ")
            .WriteLine("  BuildTime           = MORDOR_SLAUGHTERHOUSE_BUILDTIME")
            .WriteLine("  VisionRange         = MORDOR_SLAUGHTERHOUSE_VISION_RANGE")
            .WriteLine("  ShroudClearingRange = MORDOR_SLAUGHTERHOUSE_SHROUD_CLEAR")
            .WriteLine("  BountyValue         = MORDOR_SLAUGHTERHOUSE_BOUNTY_VALUE")
            .WriteLine("")
            .WriteLine("	ArmorSet")
            .WriteLine("		Conditions        = None")
            .WriteLine("		Armor             = StructureArmor")
            .WriteLine("		;DamageFX          = StructureDamageFXNoShake")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	VoiceSelect				= MordorSlaughterHouseSelect")
            .WriteLine("")
            .WriteLine("	SoundOnDamaged			= BuildingLightDamageStone")
            .WriteLine("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
            .WriteLine("	SoundAmbientDamaged		= GenericFireMediumLoop")
            .WriteLine("	SoundAmbientReallyDamaged	= GenericFireLargeLoop")
            .WriteLine(" ")
            .WriteLine("	VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction")
            .WriteLine("")
            .WriteLine("	UnitSpecificSounds")
            .WriteLine("		UnderConstruction		= BuildingConstructionLoop  ; Built first time")
            .WriteLine("		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound")
            .WriteLine("		UnderRepairFromRubble	= BuildingConstructionLoop	; Repaired from completely destroyed (not used???)")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior")
            .WriteLine("		MaxUpdateRangeCap = 800")
            .WriteLine("		AnimationSound = Sound:MordorSlaughterhouseBuildUp1 	Animation:MBSltrHs_ASKL.MBSltrHs_ABLD	Frames:0 ")
            .WriteLine("		AnimationSound = Sound:MordorSlaughterhouseBuildUp2 	Animation:MBSltrHs_ASDL.MBSltrHs_ABLD	Frames:460")
            .WriteLine(" ")
            .WriteLine("		AnimationSound = Sound:MordorSlaughterhouseOrcYell 	Animation:MBSltrHs_SKL.MBSltrHs_LOOP	Frames:72")
            .WriteLine("		AnimationSound = Sound:MordorSlaughterhouseWhistle 	Animation:MBSltrHs_SKL.MBSltrHs_LOOP	Frames:49")
            .WriteLine("		AnimationSound = Sound:MordorSlaughterhouseHooves 	Animation:MBSltrHs_SKL.MBSltrHs_LOOP	Frames:111 122 138 154 158 160 173 188 204 217 232 244 264 272 ")
            .WriteLine("		AnimationSound = Sound:MordorSlaughterhouseSnicker 	Animation:MBSltrHs_SKL.MBSltrHs_LOOP	Frames:294 ")
            .WriteLine("		AnimationSound = Sound:MordorSlaughterhouseCowDie 	Animation:MBSltrHs_SKL.MBSltrHs_LOOP	Frames:378 ")
            .WriteLine("		AnimationSound = Sound:MordorSlaughterhouseDieFall 	Animation:MBSltrHs_SKL.MBSltrHs_LOOP	Frames:377")
            .WriteLine("		AnimationSound = Sound:MordorSlaughterhouseHookMeat 	Animation:MBSltrHs_SKL.MBSltrHs_LOOP	Frames:830")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE NEED_BASE_FOUNDATION CASTLE_KEEP GARRISONABLE_UNTIL_DESTROYED FS_CASH_PRODUCER CAN_ATTACK GARRISON INDUSTRY_AFFECTED ;for the slaughterhordecontain")
            .WriteLine("									;MP_COUNT_FOR_VICTORY;removed so econ plots will not keep zombie games going")
            .WriteLine("  Behavior = TooltipUpgrade ModuleTag_TooltipUpgrade")
            .WriteLine("	TriggeredBy				= Upgrade_IsengardFaction")
            .WriteLine("	DisplayName				= OBJECT:IsengardSlaughterHouse")
            .WriteLine("	Description				= OBJECT:IsengardSlaughterHouseDescription")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Behavior = ProductionUpdate ProductionUpdateModuleTag")
            .WriteLine("    ; nothing, but is required if we have any Object-level Upgrades!")
            .WriteLine("  End")
            .WriteLine(" ")
            .WriteLine("  Behavior            = GettingBuiltBehavior GetBuiltBehaviorTag")
            .WriteLine("    WorkerName		  = MordorWorkerNoSelect")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("    Behavior = CastleMemberBehavior ModuleTag_CMB")
            .WriteLine("		; Special Eva events when attacked")
            .WriteLine("		UnderAttackEvaEventIfKeep = EconPlotUnderAttack")
            .WriteLine("		UnderAttackAllyEvaEventIfKeep = None")
            .WriteLine("")
            .WriteLine("		; Special Eva events if an econ plot is taken down")
            .WriteLine("		CampDestroyedOwnerEvaEvent = EconPlotDestroyed")
            .WriteLine("		CampDestroyedAllyEvaEvent = AllyEconPlotDestroyed")
            .WriteLine("		CampDestroyedAttackerEvaEvent = EnemyEconPlotDestroyed")
            .WriteLine("    End ")
            .WriteLine("")
            .WriteLine("	Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon")
            .WriteLine(" 		AutoAcquireEnemiesWhenIdle	= Yes")
            .WriteLine(" 		MoodAttackCheckRate			= 250")
            .WriteLine(" 	End")
            .WriteLine("")
            .WriteLine("  Body						        = ActiveBody ModuleTag_05")
            .WriteLine("    MaxHealth				      = MORDOR_SLAUGHTERHOUSE_HEALTH")
            .WriteLine("    MaxHealthDamaged	  	= MORDOR_SLAUGHTERHOUSE_HEALTH_DAMAGED")
            .WriteLine("	MaxHealthReallyDamaged	= MORDOR_SLAUGHTERHOUSE_HEALTH_REALLY_DAMAGED")
            .WriteLine("    DamageCreationList		= OCL_BuildingDamageList01 CATAPULT_ROCK")
            .WriteLine("  ")
            .WriteLine("    DamageCreationList		= OCL_MBSlaughterHouse_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
            .WriteLine("    DamageCreationList		= OCL_MBSlaughterHouse_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
            .WriteLine("    DamageCreationList		= OCL_MBSlaughterHouse_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
            .WriteLine("    DamageCreationList		= OCL_MBSlaughterHouse_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
            .WriteLine("    ")
            .WriteLine("  End")
            .WriteLine(" ")
            .WriteLine("   Behavior                  = StructureCollapseUpdate ModuleTag_StructureCollapseUpdate ")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse")
            .WriteLine("	DestroyObjectWhenDone	= Yes")
            .WriteLine("	CollapseHeight			= 89")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("	Behavior = AutoDepositUpdate AutoDepositModuleTag")
            .WriteLine("		DepositTiming       = MORDOR_SLAUGHTERHOUSE_MONEY_TIME ")
            .WriteLine("		DepositAmount       = MORDOR_SLAUGHTERHOUSE_MONEY_AMOUNT")
            .WriteLine("		InitialCaptureBonus = 0  ; no initial bonus")
            .WriteLine("	End")
            .WriteLine("  ")
            .WriteLine("	Behavior = CostModifierUpgrade ModuleTag_CostModifier")
            .WriteLine("		LabelForPalantirString = GUI:FOOD_DISCOUNT")
            .WriteLine("		StartsActive = Yes ; Run on build complete, not upgrade")
            .WriteLine("		ObjectFilter		= ANY +CAVALRY +MordorMountainTroll +MordorDrummerTroll +MordorMumakil")
            .WriteLine("		Percentage		= 0%")
            .WriteLine("		Percentage		= -10%")
            .WriteLine("		Percentage		= -15%")
            .WriteLine("		Percentage		= -20%")
            .WriteLine("		Percentage		= -25%")
            .WriteLine("		Percentage		= -30%")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("   	Behavior = SubObjectsUpgrade ModuleTag_HideAll")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel1")
            .WriteLine("		HideSubObjects	= V2 DrawFloor_V1")
            .WriteLine("	End")
            .WriteLine("	Behavior = GeometryUpgrade Geom_ModuleTag_HideAll")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel1")
            .WriteLine("		ShowGeometry	= Geom_Orig")
            .WriteLine("		HideGeometry	= Geom_V2")
            .WriteLine("	End")
            .WriteLine("	")
            .WriteLine("	")
            .WriteLine("  	Behavior = SubObjectsUpgrade ModuleTag_ShowWalls ")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel2")
            .WriteLine("		ShowSubObjects	= DrawFloor_V1")
            .WriteLine("		HideSubObjects	= V2 DrawFloor_Bib")
            .WriteLine("	End")
            .WriteLine("	")
            .WriteLine(";	Behavior = GeometryUpgrade Geom_ModuleTag_ShowWalls ")
            .WriteLine(";		TriggeredBy		= Upgrade_StructureLevel2")
            .WriteLine(";		HideGeometry	= Geom_V2")
            .WriteLine(";	End")
            .WriteLine("	")
            .WriteLine("	")
            .WriteLine("	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower ")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel3")
            .WriteLine("		ShowSubObjects	= V2 DrawFloor_V1")
            .WriteLine("		HideSubObjects	= DrawFloor_Bib")
            .WriteLine("	End  ")
            .WriteLine("	Behavior = GeometryUpgrade Geom_ModuleTag_ShowFlagsAndTower ")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel3")
            .WriteLine("		ShowGeometry	= Geom_Orig Geom_V2")
            .WriteLine("	End  ")
            .WriteLine("  	Behavior = WeaponSetUpgrade ModuleTag_ThirdLevelBuildingArrows")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel3")
            .WriteLine("		ConflictsWith	= Upgrade_EasyAIMultiPlayer")
            .WriteLine("	End")
            .WriteLine("  ")
            .WriteLine("	Behavior = SlaughterHordeContain ModuleTag_SlaughterMe")
            .WriteLine("		PassengerFilter			= ANY +ORC +URUK +BANNER -CAVALRY -HERO")
            .WriteLine("		ObjectStatusOfContained	= UNSELECTABLE BLOODTHIRSTY")
            .WriteLine("		CashBackPercent			= 100%		")
            .WriteLine("		ContainMax              = 99; give it a huge capacity, just in case player sends his whole army in at once")
            .WriteLine("		MaxHordeCapacity        = 99; give it a huge capacity, just in case player sends his whole army in at once")
            .WriteLine("		AllowEnemiesInside      = No")
            .WriteLine("		AllowNeutralInside      = No")
            .WriteLine("		EnterSound			= MordorSlaughterhouseEnterSound")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	Geometry              = BOX")
            .WriteLine("	GeometryName		  = Geom_Orig")
            .WriteLine("	GeometryMajorRadius   = 16.0")
            .WriteLine("	GeometryMinorRadius   = 32.0")
            .WriteLine("	GeometryHeight        = 34.0")
            .WriteLine("	GeometryOffset		  = X:-28 Y:-40 Z:0")
            .WriteLine("")
            .WriteLine("	AdditionalGeometry    = BOX")
            .WriteLine("	GeometryName		  = Geom_Orig")
            .WriteLine("	GeometryMajorRadius   = 42.5")
            .WriteLine("	GeometryMinorRadius   = 30.0")
            .WriteLine("	GeometryHeight        = 60.0")
            .WriteLine("	GeometryOffset		  = X:-5 Y:14 Z:0")
            .WriteLine("	")
            .WriteLine("	AdditionalGeometry    = BOX")
            .WriteLine("	GeometryName		  = Geom_V2")
            .WriteLine("	GeometryMajorRadius   = 16.0")
            .WriteLine("	GeometryMinorRadius   = 16.0")
            .WriteLine("	GeometryHeight        = 85.0")
            .WriteLine("	GeometryOffset		  = X:-28 Y:-56 Z:0	")
            .WriteLine(";	GeometryActive		  = no")
            .WriteLine("		")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("  BuildCompletion     = PLACED_BY_PLAYER")
            .WriteLine("  ")
            .WriteLine("	GeometryContactPoint	= X:-31.995		Y:52.998	Z:0			Repair")
            .WriteLine("	GeometryContactPoint	= X:-19.467		Y:-73.703	Z:0			Repair")
            .WriteLine("	GeometryContactPoint	= X:52.078		Y:32.503	Z:0")
            .WriteLine("	GeometryContactPoint	= X:-47.27		Y:-20.312	Z:0")
            .WriteLine("	GeometryContactPoint	= X:-30.442		Y:0.326		Z:64.914	Swoop")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";ChildObject IsengardSlaughterHouse	SlaughterHouse")
            .WriteLine(";")
            .WriteLine(";	DisplayName				= OBJECT:IsengardSlaughterHouse")
            .WriteLine(";	Description				= OBJECT:IsengardSlaughterHouseDescription")
            .WriteLine(";	Side					= Isengard")
            .WriteLine(";	EditorSorting			= STRUCTURE")
            .WriteLine(";")
            .WriteLine(";End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Furnace")
            .WriteLine("Object Furnace")
            .WriteLine("")
            .WriteLine("	SelectPortrait = BPCFurnace")
            .WriteLine(" ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("	ExtraPublicBone = Arrow_01")
            .WriteLine("	ExtraPublicBone = Arrow_02")
            .WriteLine("	ExtraPublicBone = Arrow_03")
            .WriteLine("	ExtraPublicBone = Arrow_04")
            .WriteLine("	ExtraPublicBone = Arrow_05")
            .WriteLine("")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("	StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("		Model = MBFurnace_SKN")
            .WriteLine("		ParticleSysBone = Bone_Smoke04 furnaceFireGlow")
            .WriteLine("		ParticleSysBone = Bone_Smoke04 furnaceSparks")
            .WriteLine("		ParticleSysBone = Bone_Smoke04 furnaceSmoke")
            .WriteLine("		ParticleSysBone = Bone_Fire01 furnaceFire")
            .WriteLine("		ParticleSysBone = glowBone1 furnaceFireGlow1")
            .WriteLine("		ParticleSysBone = glowBone2 furnaceFireGlow1")
            .WriteLine("		ParticleSysBone = steamBone2 furnaceSteam2 FollowBone:Yes")
            .WriteLine("		WeaponLaunchBone = PRIMARY Arrow_")
            .WriteLine("    End ")
            .WriteLine(" ")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		StateName					=   STATE_Idle")
            .WriteLine("		Animation = IdleA")
            .WriteLine("			AnimationName			=	MBFurnace_SKL.MBFurnace_IDLA")
            .WriteLine("			AnimationMode		=	ONCE ")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags               = RESTART_ANIM_WHEN_COMPLETE ")
            .WriteLine("		FXEvent = Frame:30  Name:FX_FurnaceSteamPool")
            .WriteLine("	End")
            .WriteLine("	")
            .WriteLine("    ;------------ New Build Up States coming soon. ")
            .WriteLine("    ModelConditionState   = AWAITING_CONSTRUCTION ")
            .WriteLine("      Model               = MBFurnace_A")
            .WriteLine(";		ParticleSysBone	  = NONE BuildingDoughnutCloud")
            .WriteLine("    End;")
            .WriteLine("    AnimationState        = AWAITING_CONSTRUCTION")
            .WriteLine("      Animation           =  MBFurnace_A")
            .WriteLine("        AnimationName     =  MBFurnace_ASKL.MBFurnace_ABLD")
            .WriteLine("        AnimationMode     = MANUAL")
            .WriteLine("        AnimationBlendTime = 0")
            .WriteLine("      End")
            .WriteLine("	Flags				  = START_FRAME_FIRST")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED")
            .WriteLine("      Model               = MBFurnace_A")
            .WriteLine("		ParticleSysBone   = CONSTDUSTBONE01 BuildingContructDust FollowBone:Yes")
            .WriteLine("    End;")
            .WriteLine("    ")
            .WriteLine("    AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED")
            .WriteLine("		Animation           = MBFurnace_A")
            .WriteLine("			AnimationName     = MBFurnace_ASKL.MBFurnace_ABLD")
            .WriteLine("			AnimationMode     = MANUAL")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags				  = START_FRAME_FIRST")
            .WriteLine("		StateName			  = BeingConstructed")
            .WriteLine("	BeginScript")
            .WriteLine("		CurDrawablePlaySound(" & Chr(34) & "GondorBarracksBeginConstruction" & Chr(34) & ")")
            .WriteLine("	EndScript")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("    ")
            .WriteLine("        ;--damaged building")
            .WriteLine("      ModelConditionState  = DESTROYED_FRONT")
            .WriteLine("      Model         = MBFurnace_D2  ")
            .WriteLine("        ParticleSysBone FireSmall01 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall02 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall04 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall05 FireBuildingMedium 	")
            .WriteLine("    End")
            .WriteLine("    AnimationState = DESTROYED_FRONT")
            .WriteLine("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBfurnaceDP_1" & Chr(34) & ")")
            .WriteLine("      EndScript")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("        ModelConditionState  = DESTROYED_RIGHT")
            .WriteLine("      Model         = MBFurnace_D2  ")
            .WriteLine("        ParticleSysBone FireSmall01 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall02 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall04 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall05 FireBuildingMedium 	")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    AnimationState = DESTROYED_RIGHT")
            .WriteLine("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBfurnaceDP_2" & Chr(34) & ")")
            .WriteLine("      EndScript")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = DESTROYED_BACK")
            .WriteLine("      Model         = MBFurnace_D2  ")
            .WriteLine("        ParticleSysBone FireSmall01 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall02 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall04 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall05 FireBuildingMedium 	")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    AnimationState = DESTROYED_BACK")
            .WriteLine("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBfurnaceDP_3" & Chr(34) & ")")
            .WriteLine("      EndScript")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("	ModelConditionState  = DESTROYED_LEFT")
            .WriteLine("      Model         = MBFurnace_D2  ")
            .WriteLine("        ParticleSysBone FireSmall01 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall02 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall04 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall05 FireBuildingMedium 	")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("    AnimationState = DESTROYED_LEFT")
            .WriteLine("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBfurnaceDP_4" & Chr(34) & ")")
            .WriteLine("      EndScript")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("    ")
            .WriteLine("    ModelConditionState  = DAMAGED")
            .WriteLine("      Model         = MBFurnace_D1  ")
            .WriteLine("        ParticleSysBone FireSmall01 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall02 FireBuildingMedium")
            .WriteLine("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall04 FireBuildingMedium")
            .WriteLine("		ParticleSysBone FireSmall05 FireBuildingMedium 	")
            .WriteLine("    End")
            .WriteLine("    AnimationState = DAMAGED")
            .WriteLine("     EnteringStateFX	= FX_BuildingDamaged")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = REALLYDAMAGED")
            .WriteLine("      Model         = MBFurnace_D2  ")
            .WriteLine("        ParticleSysBone FireSmall01 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall02 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall03 SmokeBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall04 FireBuildingLarge")
            .WriteLine("		ParticleSysBone FireSmall05 FireBuildingMedium 	")
            .WriteLine("	")
            .WriteLine("    End")
            .WriteLine("    AnimationState = REALLYDAMAGED")
            .WriteLine("     	EnteringStateFX	= FX_BuildingReallyDamaged")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = MBFurnace_D2  ")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("    AnimationState = RUBBLE")
            .WriteLine("      BeginScript")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBfurnaceDP_1" & Chr(34) & ")")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBfurnaceDP_2" & Chr(34) & ")")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBfurnaceDP_3" & Chr(34) & ")")
            .WriteLine("        CurDrawableHideSubObject(" & Chr(34) & "MBfurnaceDP_4" & Chr(34) & ")")
            .WriteLine("      EndScript")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("		Model         = None")
            .WriteLine("		ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("		 Model         = None")
            .WriteLine("		ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("	;------------- With industry effect")
            .WriteLine(";    AnimationState = UPGRADE_ECONOMY_BONUS")
            .WriteLine(";		StateName	=	STATE_Idle")
            .WriteLine(";		Animation = IdleA")
            .WriteLine(";			AnimationName		=	MBFurnace_SKL.MBFurnace_IDLA")
            .WriteLine(";			AnimationMode		=	LOOP ")
            .WriteLine(";			AnimationBlendTime	=	0")
            .WriteLine(";		End")
            .WriteLine(";		ParticleSysBone		= None Industry")
            .WriteLine(";	End")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Draw = W3DFloorDraw DrawFloor_Bib    ")
            .WriteLine("	 StaticModelLODMode = Yes		; THIS NEEDS TO BE COMMENTED OUT WHEN ENGINEERING ENABLES LOD'S IN THE FLOOR DRAW - Sean O.")
            .WriteLine("     ModelName = MBFurnace_Bib")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Draw = W3DFloorDraw DrawFloor_V1    ")
            .WriteLine("     ModelName = MBFurnace_V1")
            .WriteLine("	  StartHidden = Yes")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("	Draw = W3DScriptedModelDraw Draw_BonusEffects")
            .WriteLine("	    DefaultModelConditionState")
            .WriteLine("	      Model = None")
            .WriteLine("	    End")
            .WriteLine("	    AnimationState = ACTIVELY_BEING_CONSTRUCTED")
            .WriteLine("	    End")
            .WriteLine("		AnimationState = UPGRADE_ECONOMY_BONUS")
            .WriteLine("			ParticleSysBone = None Industry")
            .WriteLine("		End")
            .WriteLine("	End")
            .WriteLine("    ")
            .WriteLine("  PlacementViewAngle  = 0")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:Furnace")
            .WriteLine("  Description         = OBJECT:FurnaceDescription")
            .WriteLine("  Side                = Civilian")
            .WriteLine("  EditorSorting       = STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine(" ")
            .WriteLine("  BuildCost           = MORDOR_FURNACE_BUILDCOST")
            .WriteLine("  BuildTime           = MORDOR_FURNACE_BUILDTIME")
            .WriteLine("  VisionRange         = MORDOR_FURNACE_VISION_RANGE")
            .WriteLine("  ShroudClearingRange = MORDOR_FURNACE_SHROUD_CLEAR")
            .WriteLine("  BountyValue         = MORDOR_FURNACE_BOUNTY_VALUE")
            .WriteLine("")
            .WriteLine("	ArmorSet")
            .WriteLine("		Conditions        = None")
            .WriteLine("		Armor             = StructureArmor")
            .WriteLine("		;DamageFX          = StructureDamageFXNoShake")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	WeaponSet")
            .WriteLine("		Conditions			= None")
            .WriteLine("	End")
            .WriteLine("	WeaponSet")
            .WriteLine("		Conditions			= PLAYER_UPGRADE")
            .WriteLine("		Weapon				= PRIMARY KeepBow")
            .WriteLine("		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	CommandSet = FurnaceCommandSet")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	VoiceSelect = MordorFurnaceSelect")
            .WriteLine("")
            .WriteLine("	SoundOnDamaged			= BuildingLightDamageStone")
            .WriteLine("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
            .WriteLine("")
            .WriteLine("	VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction")
            .WriteLine("")
            .WriteLine("	UnitSpecificSounds")
            .WriteLine("		UnderConstruction		= BuildingConstructionLoop  ; Built first time")
            .WriteLine("		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound")
            .WriteLine("		UnderRepairFromRubble	= BuildingConstructionLoop	; Repaired from completely destroyed (not used???)")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior")
            .WriteLine("		MaxUpdateRangeCap = 800")
            .WriteLine("		AnimationSound = Sound: MordorFurnaceLava		Animation:MBFurnace_SKL.MBFurnace_IDLA Frames: 32")
            .WriteLine("		AnimationSound = Sound: MordorFurnaceBricksDrop		Animation:MBFurnace_SKL.MBFurnace_IDLA Frames: 185")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("	; *** ENGINEERING Parameters ***")
            .WriteLine("	RadarPriority       = STRUCTURE")
            .WriteLine("	KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE NEED_BASE_FOUNDATION CAN_ATTACK FS_CASH_PRODUCER INDUSTRY_AFFECTED")
            .WriteLine("")
            .WriteLine("	Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon")
            .WriteLine(" 		AutoAcquireEnemiesWhenIdle	= Yes")
            .WriteLine(" 		MoodAttackCheckRate			= 250")
            .WriteLine(" 	End")
            .WriteLine("")
            .WriteLine("	Behavior = ProductionUpdate ProductionUpdateModuleTag")
            .WriteLine("		; nothing, but is required if we have any Object-level Upgrades!")
            .WriteLine("	End")
            .WriteLine(" ")
            .WriteLine("	Behavior            = GettingBuiltBehavior GetBuiltBehaviorTag")
            .WriteLine("		WorkerName		  = MordorWorkerNoSelect")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	Behavior = CastleMemberBehavior ModuleTag_CMB")
            .WriteLine("	End ")
            .WriteLine("")
            .WriteLine("	Body                = StructureBody ModuleTag_05")
            .WriteLine("		MaxHealth               = MORDOR_FURNACE_HEALTH")
            .WriteLine("		MaxHealthDamaged        = MORDOR_FURNACE_HEALTH_DAMAGED")
            .WriteLine("		MaxHealthReallyDamaged  = MORDOR_FURNACE_HEALTH_REALLY_DAMAGED")
            .WriteLine("   ")
            .WriteLine("		DamageCreationList		= OCL_BuildingDamageList01 CATAPULT_ROCK")
            .WriteLine("  ")
            .WriteLine("	    DamageCreationList		= OCL_Furnace_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
            .WriteLine("		DamageCreationList		= OCL_Furnace_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
            .WriteLine("		DamageCreationList		= OCL_Furnace_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
            .WriteLine("		DamageCreationList		= OCL_Furnace_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
            .WriteLine("    ")
            .WriteLine("	End")
            .WriteLine(" ")
            .WriteLine("	Behavior                  = StructureCollapseUpdate ModuleTag_StructureCollapseUpdate ")
            .WriteLine("		MinCollapseDelay        = 000")
            .WriteLine("		MaxCollapseDelay        = 000")
            .WriteLine("		CollapseDamping         = .5")
            .WriteLine("		MaxShudder              = 0.6")
            .WriteLine("		MinBurstDelay           = 250")
            .WriteLine("		MaxBurstDelay           = 800")
            .WriteLine("		BigBurstFrequency       = 4")
            .WriteLine("		FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("		FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse")
            .WriteLine("		DestroyObjectWhenDone	= Yes")
            .WriteLine("		CollapseHeight			= 89")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("  ")
            .WriteLine("	Behavior = AutoDepositUpdate AutoDepositModuleTag")
            .WriteLine("		DepositTiming       = MORDOR_FURNACE_MONEY_TIME ")
            .WriteLine("		DepositAmount       = MORDOR_FURNACE_MONEY_AMOUNT")
            .WriteLine("		InitialCaptureBonus = 0  ; no initial bonus")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine(";  Behavior           = CreateObjectDie ModuleTag_08")
            .WriteLine(";    CreationList     = OCL_SmallStructureDebris")
            .WriteLine(";  End")
            .WriteLine("")
            .WriteLine("	Behavior = CostModifierUpgrade ModuleTag_CostModifierUpgrades")
            .WriteLine("		LabelForPalantirString = GUI:STEEL_DISCOUNT")
            .WriteLine("		StartsActive = Yes ; Run on build complete, not upgrade")
            .WriteLine("		UpgradeDiscount	= Yes")
            .WriteLine("		Percentage		= 0%")
            .WriteLine("		Percentage		= -10%")
            .WriteLine("		Percentage		= -15%")
            .WriteLine("		Percentage		= -20%")
            .WriteLine("		Percentage		= -30%")
            .WriteLine("		Percentage		= -40%")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	Behavior = CostModifierUpgrade ModuleTag_CostModifierMachines")
            .WriteLine("		LabelForPalantirString = GUI:STEEL_DISCOUNT")
            .WriteLine("		StartsActive = Yes ; Run on build complete, not upgrade")
            .WriteLine("		ObjectFilter	= ANY +MACHINE")
            .WriteLine("		Percentage		= 0%")
            .WriteLine("		Percentage		= -10%")
            .WriteLine("		Percentage		= -15%")
            .WriteLine("		Percentage		= -20%")
            .WriteLine("		Percentage		= -30%")
            .WriteLine("		Percentage		= -40%")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("  	Behavior = SubObjectsUpgrade ModuleTag_HideAll")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel1")
            .WriteLine("		HideSubObjects	= V2 DrawFloor_V1")
            .WriteLine("	End")
            .WriteLine("	Behavior = GeometryUpgrade Geom_ModuleTag_HideAll")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel1")
            .WriteLine("		HideGeometry	= Geom_V2 Geom_Base2")
            .WriteLine("	End")
            .WriteLine("	")
            .WriteLine("	")
            .WriteLine("  	Behavior = SubObjectsUpgrade ModuleTag_ShowWalls ")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel2")
            .WriteLine("		ShowSubObjects	= DrawFloor_V1")
            .WriteLine("		HideSubObjects	= V2 DrawFloor_Bib")
            .WriteLine("	End")
            .WriteLine("	Behavior = GeometryUpgrade Geom_ModuleTag_ShowWalls ")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel2")
            .WriteLine("		ShowGeometry	= Geom_V1")
            .WriteLine("		HideGeometry	= Geom_V2 Geom_Base")
            .WriteLine("	End")
            .WriteLine("	")
            .WriteLine("	")
            .WriteLine("	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower ")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel3")
            .WriteLine("		ShowSubObjects	= V2 DrawFloor_V1")
            .WriteLine("		HideSubObjects	= DrawFloor_Bib")
            .WriteLine("	End")
            .WriteLine("	Behavior = GeometryUpgrade Geom_ModuleTag_ShowFlagsAndTower ")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel3")
            .WriteLine("		ShowGeometry	= Geom_V2 Geom_Orig Geom_V1")
            .WriteLine("		HideGeometry	= Geom_Base")
            .WriteLine("	End")
            .WriteLine("  	Behavior = WeaponSetUpgrade ModuleTag_ThirdLevelBuildingArrows")
            .WriteLine("		TriggeredBy		= Upgrade_StructureLevel3")
            .WriteLine("		ConflictsWith	= Upgrade_EasyAIMultiPlayer")
            .WriteLine("	End")
            .WriteLine("	 ")
            .WriteLine("	Behavior = QueueProductionExitUpdate ModuleTag_11")
            .WriteLine("		UnitCreatePoint   = X:0.0 Y:5.0 Z:0.0")
            .WriteLine("		NaturalRallyPoint = X:50.0 Y:5.0 Z:0.0;NaturalRallyPointX must always match GeometryMajorRadius! -ML")
            .WriteLine("		ExitDelay = 300 ; Mainly for the multiple produced Red Guard.  Make them come out one at a time.")
            .WriteLine("	End  ")
            .WriteLine("")
            .WriteLine(";  Behavior = FlammableUpdate ModuleTag_14")
            .WriteLine(";    AflameDuration = 5000         ; If I catch fire, I'll burn for this long...")
            .WriteLine(";    AflameDamageAmount = 5       ; taking this much damage...")
            .WriteLine(";    AflameDamageDelay = 500       ; this often.")
            .WriteLine(";  End")
            .WriteLine(" ")
            .WriteLine("	Behavior = TransitionDamageFX ModuleTag_15")
            .WriteLine("		;-------------DESIGNED FOR SMALL SIZED FACTION BUILDING TRANSITIONS-------------------")
            .WriteLine("		DamagedParticleSystem1       = Bone:None RandomBone:No PSys:StructureTransitionSmallSmoke")
            .WriteLine("		;---------------------------------------------------------------------------------------")
            .WriteLine("		ReallyDamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionSmallSmoke")
            .WriteLine("		ReallyDamagedParticleSystem2 = Bone:None RandomBone:No PSys:StructureTransitionSmallExplosion")
            .WriteLine("		ReallyDamagedParticleSystem3 = Bone:None RandomBone:No PSys:StructureTransitionSmallShockwave")
            .WriteLine("	End")
            .WriteLine(" ")
            .WriteLine(";	Behavior             = FXListDie ModuleTag_16")
            .WriteLine(";		DeathFX       = FX_BuildingDie")
            .WriteLine(";	End")
            .WriteLine(" ")
            .WriteLine("	Geometry              = CYLINDER")
            .WriteLine("	GeometryName		  = Geom_Orig")
            .WriteLine("	GeometryMajorRadius   = 28.6")
            .WriteLine("	GeometryHeight        = 80.8")
            .WriteLine("	GeometryOffset		  = X:5 Y:-5 Z:0")
            .WriteLine("")
            .WriteLine("    AdditionalGeometry    = BOX")
            .WriteLine("    GeometryName		  = Geom_Base")
            .WriteLine("    GeometryMajorRadius   = 45.0")
            .WriteLine("    GeometryMinorRadius   = 35.0")
            .WriteLine("    GeometryHeight        = 25.0	")
            .WriteLine("    GeometryOffset		  = X:20 Y:-10 Z:0")
            .WriteLine("    ")
            .WriteLine("    AdditionalGeometry    = CYLINDER")
            .WriteLine("    GeometryName		  = Geom_V1")
            .WriteLine("    GeometryMajorRadius   = 66.0")
            .WriteLine("    GeometryMinorRadius   = 66.0")
            .WriteLine("    GeometryHeight        = 20.0	")
            .WriteLine("    GeometryOffset		  = X:8 Y:-8 Z:0	")
            .WriteLine(";    GeometryActive		  = no")
            .WriteLine("")
            .WriteLine("	AdditionalGeometry    = CYLINDER")
            .WriteLine("	GeometryName		  = Geom_V2")
            .WriteLine("    GeometryMajorRadius   = 25.0")
            .WriteLine("    GeometryMinorRadius   = 25.0")
            .WriteLine("    GeometryHeight        = 80.0	")
            .WriteLine("    GeometryOffset		  = X:-10 Y:-20 Z:0")
            .WriteLine(";	GeometryActive		  = no")
            .WriteLine("	")
            .WriteLine("	GeometryIsSmall       = No")
            .WriteLine("	Shadow                = SHADOW_VOLUME")
            .WriteLine("	BuildCompletion     = PLACED_BY_PLAYER")
            .WriteLine("	")
            .WriteLine("	GeometryContactPoint	= X:-18.325		Y:20.726	Z:0			Repair")
            .WriteLine("	GeometryContactPoint	= X:69.049		Y:-12.807	Z:0			Repair")
            .WriteLine("	GeometryContactPoint	= X:49.467		Y:31.862	Z:0")
            .WriteLine("	GeometryContactPoint	= X:-18.325		Y:-53.891	Z:0")
            .WriteLine("	GeometryContactPoint	= X:3.534		Y:0.006		Z:97.644	Swoop")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object PreBuiltCampFlag_01")
            .WriteLine("")
            .WriteLine("SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NCampsite_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NCampsite_Bib")
            .WriteLine("	End")
            .WriteLine("	")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 99999.0")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Camp_(f))
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("")
            .WriteLine("	;FactionDecal = Gondor		GBCampFloor		675.0")
            .WriteLine("	;FactionDecal = Rohan		CinMrdBnr01		650.0")
            .WriteLine("	;FactionDecal = Mordor		MBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Isengard		IBCampFloor		650.0")
            .WriteLine("")
            .WriteLine("	PreBuiltList = GondorBarracks 1	")
            .WriteLine("	PreBuiltList = GondorFarm 2	")
            .WriteLine("	PreBuiltPlyr = PlyrGondor")
            .WriteLine("	")
            .WriteLine("	MaxCastleRadius = 280.0")
            .WriteLine("	FadeTime = 2.0 ; 2 seconds	")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 24.0")
            .WriteLine("  GeometryMinorRadius = 24.0")
            .WriteLine("  GeometryHeight      = 24.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object PreBuiltCampFlag_02")
            .WriteLine("")
            .WriteLine("SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NCampsite_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NCampsite_Bib")
            .WriteLine("	End")
            .WriteLine("	")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag    ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
            .WriteLine("  Body                = ImmortalBody  ModuleTag_02")
            .WriteLine("    MaxHealth       = 99999.0")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Camp_(f))
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("")
            .WriteLine("	;FactionDecal = Gondor		GBCampFloor		675.0")
            .WriteLine("	;FactionDecal = Rohan		CinMrdBnr01		650.0")
            .WriteLine("	;FactionDecal = Mordor		MBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Isengard		IBCampFloor		650.0")
            .WriteLine("")
            .WriteLine("	PreBuiltList = GondorBarracks 1	")
            .WriteLine("	PreBuiltList = GondorFarm 2	")
            .WriteLine("	PreBuiltPlyr = PlyrGondor")
            .WriteLine("	")
            .WriteLine("	MaxCastleRadius = 280.0")
            .WriteLine("	FadeTime = 2.0 ; 2 seconds	")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 24.0")
            .WriteLine("  GeometryMinorRadius = 24.0")
            .WriteLine("  GeometryHeight      = 24.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object PreBuiltCampFlag_03")
            .WriteLine("")
            .WriteLine("SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NCampsite_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NCampsite_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag    ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
            .WriteLine("  Body                = ImmortalBody  ModuleTag_02")
            .WriteLine("    MaxHealth       = 99999.0")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Camp_(f))
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("")
            .WriteLine("	;FactionDecal = Gondor		GBCampFloor		675.0")
            .WriteLine("	;FactionDecal = Rohan		CinMrdBnr01		650.0")
            .WriteLine("	;FactionDecal = Mordor		MBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Isengard		IBCampFloor		650.0")
            .WriteLine("")
            .WriteLine("	PreBuiltList = GondorBarracks 1	")
            .WriteLine("	PreBuiltList = GondorFarm 2	")
            .WriteLine("	PreBuiltPlyr = PlyrGondor")
            .WriteLine("	")
            .WriteLine("	MaxCastleRadius = 280.0")
            .WriteLine("	FadeTime = 2.0 ; 2 seconds	")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 24.0")
            .WriteLine("  GeometryMinorRadius = 24.0")
            .WriteLine("  GeometryHeight      = 24.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object PreBuiltCampFlag_04")
            .WriteLine("")
            .WriteLine("SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NCampsite_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NCampsite_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 99999.0")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Camp_(f))
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("")
            .WriteLine("	;FactionDecal = Gondor		GBCampFloor		675.0")
            .WriteLine("	;FactionDecal = Rohan		CinMrdBnr01		650.0")
            .WriteLine("	;FactionDecal = Mordor		MBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Isengard		IBCampFloor		650.0")
            .WriteLine("")
            .WriteLine("     PreBuiltList = GondorBarracks 0")
            .WriteLine("     PreBuiltList = GondorArcherRange 1")
            .WriteLine("     PreBuiltList = GondorFarm 2")
            .WriteLine("	 PreBuiltList = GondorFarm 3")
            .WriteLine("	 PreBuiltList = GondorMarketPlace 4")
            .WriteLine("	 PreBuiltList = GondorFarm 5")
            .WriteLine("     PreBuiltPlyr = PlyrGondor")
            .WriteLine("	")
            .WriteLine("	MaxCastleRadius = 280.0")
            .WriteLine("	FadeTime = 2.0 ; 2 seconds	")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 24.0")
            .WriteLine("  GeometryMinorRadius = 24.0")
            .WriteLine("  GeometryHeight      = 24.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object PreBuiltCampFlag_05")
            .WriteLine("")
            .WriteLine("SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NCampsite_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NCampsite_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 99999.0")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Camp_(f))
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("")
            .WriteLine("	;FactionDecal = Gondor		GBCampFloor		675.0")
            .WriteLine("	;FactionDecal = Rohan		CinMrdBnr01		650.0")
            .WriteLine("	;FactionDecal = Mordor		MBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Isengard		IBCampFloor		650.0")
            .WriteLine("")
            .WriteLine("	PreBuiltList = GondorBarracks 1	")
            .WriteLine("	PreBuiltList = GondorFarm 2	")
            .WriteLine("	PreBuiltPlyr = PlyrGondor")
            .WriteLine("	")
            .WriteLine("	MaxCastleRadius = 280.0")
            .WriteLine("	FadeTime = 2.0 ; 2 seconds	")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 24.0")
            .WriteLine("  GeometryMinorRadius = 24.0")
            .WriteLine("  GeometryHeight      = 24.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object PreBuiltCampFlag_06")
            .WriteLine("")
            .WriteLine("SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NCampsite_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NCampsite_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 99999.0")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Camp_(f))
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("")
            .WriteLine("	;FactionDecal = Gondor		GBCampFloor		675.0")
            .WriteLine("	;FactionDecal = Rohan		CinMrdBnr01		650.0")
            .WriteLine("	;FactionDecal = Mordor		MBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Isengard		IBCampFloor		650.0")
            .WriteLine("")
            .WriteLine("	PreBuiltList = GondorBarracks 1	")
            .WriteLine("	PreBuiltList = GondorFarm 2	")
            .WriteLine("	PreBuiltPlyr = PlyrGondor")
            .WriteLine("")
            .WriteLine("	MaxCastleRadius = 280.0")
            .WriteLine("	FadeTime = 2.0 ; 2 seconds	")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 24.0")
            .WriteLine("  GeometryMinorRadius = 24.0")
            .WriteLine("  GeometryHeight      = 24.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object PreBuiltCampFlag_07")
            .WriteLine("")
            .WriteLine("SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NCampsite_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NCampsite_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 99999.0")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Camp_(f))
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("")
            .WriteLine("	;FactionDecal = Gondor		GBCampFloor		675.0")
            .WriteLine("	;FactionDecal = Rohan		CinMrdBnr01		650.0")
            .WriteLine("	;FactionDecal = Mordor		MBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Isengard		IBCampFloor		650.0")
            .WriteLine("")
            .WriteLine("	PreBuiltList = GondorBarracks 1	")
            .WriteLine("	PreBuiltList = GondorFarm 2	")
            .WriteLine("	PreBuiltPlyr = PlyrGondor")
            .WriteLine("	")
            .WriteLine("	MaxCastleRadius = 280.0")
            .WriteLine("	FadeTime = 2.0 ; 2 seconds	")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 24.0")
            .WriteLine("  GeometryMinorRadius = 24.0")
            .WriteLine("  GeometryHeight      = 24.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object PreBuiltCampFlag_08")
            .WriteLine("")
            .WriteLine("SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NCampsite_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NCampsite_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 99999.0")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Camp_(f))
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("")
            .WriteLine("	;FactionDecal = Gondor		GBCampFloor		675.0")
            .WriteLine("	;FactionDecal = Rohan		CinMrdBnr01		650.0")
            .WriteLine("	;FactionDecal = Mordor		MBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Isengard		IBCampFloor		650.0")
            .WriteLine("")
            .WriteLine("	PreBuiltList = GondorBarracks 1	")
            .WriteLine("	PreBuiltList = GondorFarm 2	")
            .WriteLine("	PreBuiltPlyr = PlyrGondor")
            .WriteLine("	")
            .WriteLine("	MaxCastleRadius = 280.0")
            .WriteLine("	FadeTime = 2.0 ; 2 seconds	")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 24.0")
            .WriteLine("  GeometryMinorRadius = 24.0")
            .WriteLine("  GeometryHeight      = 24.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";-----------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object CampFlagNE")
            .WriteLine("")
            .WriteLine(";SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NCampsite_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("		;BeginScript")
            .WriteLine("		;	CurDrawablePlaySound(" & Chr(34) & "GondorBarracksBeginConstruction" & Chr(34) & ")")
            .WriteLine("		;EndScript")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NCampsite_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	;------------- AUDIO ----------------")
            .WriteLine("")
            .WriteLine("	VoiceSelect		= Gui_PlotSelect")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE ")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 1")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & CampNE_(f) & " 2000")
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("")
            .WriteLine("	;FactionDecal = Gondor		GBCampFloor		675.0")
            .WriteLine("	;FactionDecal = Rohan		IBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Mordor		MBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Isengard		IBCampFloor		650.0")
            .WriteLine("	")
            .WriteLine("	MaxCastleRadius = 280.0")
            .WriteLine("	FadeTime = 2.0 ; 2 seconds")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 24.0")
            .WriteLine("  GeometryMinorRadius = 24.0")
            .WriteLine("  GeometryHeight      = 24.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";-----------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object CampFlagNW")
            .WriteLine("")
            .WriteLine(";SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NCampsite_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NCampsite_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("	;------------- AUDIO ----------------")
            .WriteLine("")
            .WriteLine("	VoiceSelect		= Gui_PlotSelect")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE ")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 1")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & CampNW_(f) & " 2000")
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("")
            .WriteLine("	;FactionDecal = Gondor		GBCampFloor		675.0")
            .WriteLine("	;FactionDecal = Rohan		IBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Mordor		MBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Isengard		IBCampFloor		650.0")
            .WriteLine("	")
            .WriteLine("	MaxCastleRadius = 280.0")
            .WriteLine("	FadeTime = 2.0 ; 2 seconds")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 24.0")
            .WriteLine("  GeometryMinorRadius = 24.0")
            .WriteLine("  GeometryHeight      = 24.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";-----------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object CampFlagSE")
            .WriteLine("")
            .WriteLine(";SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NCampsite_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NCampsite_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	;------------- AUDIO ----------------")
            .WriteLine("")
            .WriteLine("	VoiceSelect		= Gui_PlotSelect")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE ")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 1")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & CampSE_(f) & " 2000")
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("")
            .WriteLine("	;FactionDecal = Gondor		GBCampFloor		675.0")
            .WriteLine("	;FactionDecal = Rohan		IBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Mordor		MBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Isengard		IBCampFloor		650.0")
            .WriteLine("	")
            .WriteLine("	MaxCastleRadius = 280.0")
            .WriteLine("	FadeTime = 2.0 ; 2 seconds")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 24.0")
            .WriteLine("  GeometryMinorRadius = 24.0")
            .WriteLine("  GeometryHeight      = 24.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";-----------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object CampFlagSW")
            .WriteLine("")
            .WriteLine(";SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NCampsite_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("		;BeginScript")
            .WriteLine("		;	CurDrawablePlaySound(" & Chr(34) & "GondorBarracksBeginConstruction" & Chr(34) & ")")
            .WriteLine("		;EndScript")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NCampsite_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("	;------------- AUDIO ----------------")
            .WriteLine("")
            .WriteLine("	VoiceSelect		= Gui_PlotSelect")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE ")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 1")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & CampSW_(f) & " 2000")
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("")
            .WriteLine("	;FactionDecal = Gondor		GBCampFloor		675.0")
            .WriteLine("	;FactionDecal = Rohan		IBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Mordor		MBCampFloor		650.0")
            .WriteLine("	;FactionDecal = Isengard		IBCampFloor		650.0")
            .WriteLine("	")
            .WriteLine("	MaxCastleRadius = 280.0")
            .WriteLine("	FadeTime = 2.0 ; 2 seconds")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 24.0")
            .WriteLine("  GeometryMinorRadius = 24.0")
            .WriteLine("  GeometryHeight      = 24.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("Object StructureRubblePileLarge")
            .WriteLine("	Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("		DefaultModelConditionState")
            .WriteLine("			Model = GBGenRubble_A")
            .WriteLine("		End")
            .WriteLine("		")
            .WriteLine("")
            .WriteLine("		AnimationState = JUST_BUILT")
            .WriteLine("			StateName = JustBuilt")
            .WriteLine("			Animation = GBGenRubble_A")
            .WriteLine("				AnimationName = GBGenRubble_A.GBGenRubble_A")
            .WriteLine("				AnimationMode = MANUAL")
            .WriteLine("			End")
            .WriteLine("		End    ")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("		IdleAnimationState  ")
            .WriteLine("			Animation = GBGenRubble2_A")
            .WriteLine("				AnimationName = GBGenRubble2_A.GBGenRubble2_A")
            .WriteLine("				AnimationMode = MANUAL")
            .WriteLine("			End")
            .WriteLine("			Flags = START_FRAME_LAST")
            .WriteLine("			BeginScript")
            .WriteLine("				Prev = CurDrawablePrevAnimationState()")
            .WriteLine("				if Prev == " & Chr(34) & "JustBuilt" & Chr(34) & "	then CurDrawableSetTransitionAnimState(" & Chr(34) & "TRANS_Rise" & Chr(34) & ") return end")
            .WriteLine("				;CurDrawableSetTransitionAnimState(" & Chr(34) & "TRANS_Rise" & Chr(34) & ") return ")
            .WriteLine("			EndScript")
            .WriteLine("		End    ")
            .WriteLine("		TransitionState = TRANS_Rise ")
            .WriteLine("			Animation = GBGenRubble2_A")
            .WriteLine("				AnimationName = GBGenRubble2_A.GBGenRubble2_A")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationSpeedFactorRange = 2.5 2.5")
            .WriteLine("			End")
            .WriteLine("		End    ")
            .WriteLine("	End")
            .WriteLine("	")
            .WriteLine("	KindOf = INERT")
            .WriteLine("	")
            .WriteLine("		")
            .WriteLine("End")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("Object StructureRubblePileSmall")
            .WriteLine("	Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("		DefaultModelConditionState")
            .WriteLine("			Model = GBGenRubble_A")
            .WriteLine("		End")
            .WriteLine("		")
            .WriteLine("		AnimationState = JUST_BUILT")
            .WriteLine("			StateName = JustBuilt")
            .WriteLine("			Animation = GBGenRubble")
            .WriteLine("				AnimationName = GBGenRubble.GBGenRubble")
            .WriteLine("				AnimationMode = MANUAL")
            .WriteLine("			End")
            .WriteLine("		End    ")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("		IdleAnimationState  ")
            .WriteLine("			Animation = GBGenRubble2_A")
            .WriteLine("				AnimationName = GBGenRubble_A.GBGenRubble_A")
            .WriteLine("				AnimationMode = MANUAL")
            .WriteLine("			End")
            .WriteLine("			Flags = START_FRAME_LAST")
            .WriteLine("			BeginScript")
            .WriteLine("				Prev = CurDrawablePrevAnimationState()")
            .WriteLine("				if Prev == " & Chr(34) & "JustBuilt" & Chr(34) & "	then CurDrawableSetTransitionAnimState(" & Chr(34) & "TRANS_Rise" & Chr(34) & ")" & Chr(34) & " return end)")
            .WriteLine("				;CurDrawableSetTransitionAnimState(" & Chr(34) & "TRANS_Rise" & Chr(34) & ") return ")
            .WriteLine("			EndScript")
            .WriteLine("		End    ")
            .WriteLine("		TransitionState = TRANS_Rise ")
            .WriteLine("			Animation = GBGenRubble_A")
            .WriteLine("				AnimationName = GBGenRubble_A.GBGenRubble_A")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationSpeedFactorRange = 2.5 2.5")
            .WriteLine("			End")
            .WriteLine("		End    ")
            .WriteLine("	End")
            .WriteLine("	")
            .WriteLine("	KindOf = INERT")
            .WriteLine("		")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("Object StructureRubblePileSinkAway")
            .WriteLine("	Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("		DefaultModelConditionState")
            .WriteLine("			Model = GBGenRubble2_A")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("		AnimationState = None ")
            .WriteLine("			Animation = GBGenRubble2_A")
            .WriteLine("				AnimationName = GBGenRubble2_A.GBGenRubble2_A")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationSpeedFactorRange = 2.0 2.0")
            .WriteLine("			End")
            .WriteLine("		End    ")
            .WriteLine("	End")
            .WriteLine("	")
            .WriteLine("	Behavior = SlowDeathBehavior ModuleTagSinkAway")
            .WriteLine("		DeathTypes = ALL ")
            .WriteLine("		SinkDelay = 0")
            .WriteLine("		SinkRate = 2.0     ; in Dist/Sec")
            .WriteLine("		DestructionDelay = 12000")
            .WriteLine("	End")
            .WriteLine("	; To force to immediately go to DYING state ")
            .WriteLine("	Behavior = LifetimeUpdate ModuleTag_06")
            .WriteLine("		MinLifetime = 1000   ; min lifetime in msec")
            .WriteLine("		MaxLifetime = 1000   ; max lifetime in msec")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	Body                  = ActiveBody ModuleTag_02")
            .WriteLine("		MaxHealth       = 1.0")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	KindOf = INERT")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("Object Helm'sDeep_MainWall")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = NBHDMainWall")
            .WriteLine("    End")
            .WriteLine("        ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	SoundOnDamaged			= BuildingLightDamageStone")
            .WriteLine("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:NBHDMainWall")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("  Body                  = ActiveBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 2000.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 3000")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 24.8")
            .WriteLine("  GeometryMinorRadius   = 80.2")
            .WriteLine("  GeometryHeight        = 100.4")
            .WriteLine("  GeometryOffset		= X:-22.8 Y:0 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = CYLINDER")
            .WriteLine("  GeometryMajorRadius   = 22.0")
            .WriteLine("  GeometryMinorRadius   = 7.2")
            .WriteLine("  GeometryHeight        = 110.4")
            .WriteLine("  GeometryOffset		= X:13.8 Y:0 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 22.8")
            .WriteLine("  GeometryMinorRadius   = 56.2")
            .WriteLine("  GeometryHeight        = 100.4")
            .WriteLine("  GeometryOffset		= X:-12.8 Y:0 Z:0")
            .WriteLine("  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object Helm'sDeep_Ramp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = NBHDRamp")
            .WriteLine("    End")
            .WriteLine("        ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	SoundOnDamaged			= BuildingLightDamageStone")
            .WriteLine("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:NBHDRamp")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("  Body                  = ActiveBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 2000.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 3000")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 4.8")
            .WriteLine("  GeometryMinorRadius   = 7.2")
            .WriteLine("  GeometryHeight        = 26.4")
            .WriteLine("  GeometryActive		= no")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 33.0")
            .WriteLine("  GeometryMinorRadius   = 35.0")
            .WriteLine("  GeometryHeight        = 107.4")
            .WriteLine("  GeometryOffset		= X:8.8 Y:-65.2 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 36.0")
            .WriteLine("  GeometryMinorRadius   = 33.0")
            .WriteLine("  GeometryHeight        = 107.4")
            .WriteLine("  GeometryOffset		= X:5.8 Y:83.2 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 18.8")
            .WriteLine("  GeometryMinorRadius   = 45.2")
            .WriteLine("  GeometryHeight        = 38.4")
            .WriteLine("  GeometryOffset		= X:0 Y:10 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 18.8")
            .WriteLine("  GeometryMinorRadius   = 41.2")
            .WriteLine("  GeometryHeight        = 38.4")
            .WriteLine("  GeometryOffset		= X:37.6 Y:10 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 30.8")
            .WriteLine("  GeometryMinorRadius   = 41.2")
            .WriteLine("  GeometryHeight        = 22.4")
            .WriteLine("  GeometryOffset		= X:85.4 Y:10 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 60.8")
            .WriteLine("  GeometryMinorRadius   = 41.2")
            .WriteLine("  GeometryHeight        = 11.4")
            .WriteLine("  GeometryOffset		= X:177.0+ Y:10 Z:0")
            .WriteLine("  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object Helm'sDeep_KeepWall")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = NBHDKeepWall")
            .WriteLine("    End")
            .WriteLine("        ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	SoundOnDamaged			= BuildingLightDamageStone")
            .WriteLine("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:NBHDKeepWall")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE SELECTABLE IMMOBILE")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("  Body                  = ActiveBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 2000.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 3000")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 22.8")
            .WriteLine("  GeometryMinorRadius   = 38.2")
            .WriteLine("  GeometryHeight        = 138.4")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = CYLINDER")
            .WriteLine("  GeometryMajorRadius   = 26.8")
            .WriteLine("  GeometryMinorRadius   = 20.2")
            .WriteLine("  GeometryHeight        = 138.4")
            .WriteLine("  GeometryOffset		= X:-13.4 Y:58 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = CYLINDER")
            .WriteLine("  GeometryMajorRadius   = 26.8")
            .WriteLine("  GeometryMinorRadius   = 20.2")
            .WriteLine("  GeometryHeight        = 138.4")
            .WriteLine("  GeometryOffset		= X:-13.4 Y:-58 Z:0")
            .WriteLine("  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object Helm'sDeep_DeepingWall")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = NBHDDeepingW")
            .WriteLine("    End")
            .WriteLine("        ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	SoundOnDamaged			= BuildingLightDamageStone")
            .WriteLine("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:NBHDDeepingW")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE SELECTABLE IMMOBILE DEFENSIVE_WALL NOT_AUTOACQUIRABLE")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("  Body                  = ActiveBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 2000.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 3000")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 31.0")
            .WriteLine("  GeometryMinorRadius   = 87.2")
            .WriteLine("  GeometryHeight        = 62.4")
            .WriteLine("  GeometryOffset		= X:-8.8 Y:0 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry	= CYLINDER")
            .WriteLine("  GeometryMajorRadius   = 21.0")
            .WriteLine("  GeometryMinorRadius   = 0")
            .WriteLine("  GeometryHeight        = 71.4")
            .WriteLine("  GeometryOffset		= X:20.8 Y:0 Z:0")
            .WriteLine("  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("Object Helm'sDeep_DeepingWallDrain")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = NBHDDeepingWDrn")
            .WriteLine("    End")
            .WriteLine("        ")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	SoundOnDamaged			= BuildingLightDamageStone")
            .WriteLine("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Bridge")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE SELECTABLE IMMOBILE DEFENSIVE_WALL NOT_AUTOACQUIRABLE")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("  Body                  = ActiveBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 2000.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 3000")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 30.8")
            .WriteLine("  GeometryMinorRadius   = 87.2")
            .WriteLine("  GeometryHeight        = 59.4")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------------------")
            .WriteLine(";Gondorian (civilian) Standalone battle tower")
            .WriteLine("Object GondorBattleTower_S ; civilian, really")
            .WriteLine("  ")
            .WriteLine("  SelectPortrait = BPGBattleTower")
            .WriteLine("   ")
            .WriteLine("    ; *** ART Parameters ***")
            .WriteLine("    ButtonImage = BRBattleTower")
            .WriteLine("    ")
            .WriteLine("    Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("      OkToChangeModelColor  = Yes")
            .WriteLine("      UseStandardModelNames = Yes")
            .WriteLine("      ExtraPublicBone = ARROW_ ; Firing points")
            .WriteLine("  ")
            .WriteLine("      DefaultModelConditionState")
            .WriteLine("        ;Model = GBKeep")
            .WriteLine("        Model = GBBtlTwrs")
            .WriteLine("      End")
            .WriteLine("      ")
            .WriteLine("      IdleAnimationState")
            .WriteLine("  		Animation = IDLE")
            .WriteLine("  			AnimationName		=	GBBtlTwrS.GBBtlTwrS")
            .WriteLine("  			AnimationMode			=	ONCE	")
            .WriteLine("  		End		")
            .WriteLine("  ")
            .WriteLine("  		BeginScript")
            .WriteLine("  			CurDrawableHideSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  			CurDrawableHideSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  			CurDrawableHideSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("  		EndScript")
            .WriteLine("  			")
            .WriteLine("  	End	")
            .WriteLine("      ")
            .WriteLine("      ")
            .WriteLine("      ;---------------damage states-- garrisoned---------------")
            .WriteLine("  	    ")
            .WriteLine("          ;--damaged building")
            .WriteLine("      ModelConditionState  = GARRISONED DESTROYED_FRONT")
            .WriteLine("        Model         = GBBtlTwrS_D2  ")
            .WriteLine("  		ParticleSysBone FireSmall01 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall02 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall03 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall04 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireMedium01 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireMedium02 FireBuildingMedium")
            .WriteLine("       	ParticleSysBone FireLarge01 FireBuildingLarge")
            .WriteLine("       	ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("      End")
            .WriteLine("      AnimationState = GARRISONED DESTROYED_FRONT")
            .WriteLine("  		Animation	= GBBtlTwrS_D2.GBBtlTwrS_D2")
            .WriteLine("  			AnimationName		=	GBBtlTwrS_D2.GBBtlTwrS_D2")
            .WriteLine("  			AnimationMode		=	LOOP	")
            .WriteLine("  		End")
            .WriteLine("        BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2A" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("        EndScript")
            .WriteLine("      End")
            .WriteLine("      ")
            .WriteLine("      ModelConditionState  = GARRISONED DESTROYED_RIGHT")
            .WriteLine("        Model         = GBBtlTwrS_D2  ")
            .WriteLine("  		ParticleSysBone FireSmall01 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall02 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall03 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall04 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireMedium01 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireMedium02 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireLarge01 FireBuildingLarge")
            .WriteLine("  		ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("      End")
            .WriteLine("      AnimationState = GARRISONED DESTROYED_RIGHT")
            .WriteLine("  		Animation	= GBBtlTwrS_D2.GBBtlTwrS_D2")
            .WriteLine("  			AnimationName		=	GBBtlTwrS_D2.GBBtlTwrS_D2")
            .WriteLine("  			AnimationMode		=	LOOP	")
            .WriteLine("  		End	")
            .WriteLine("        BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2B" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("        EndScript")
            .WriteLine("      End")
            .WriteLine("      ")
            .WriteLine("  ")
            .WriteLine("      ModelConditionState  = GARRISONED DESTROYED_BACK")
            .WriteLine("        Model         = GBBtlTwrS_D2  ")
            .WriteLine("  		ParticleSysBone FireSmall01 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall02 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall03 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall04 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireMedium01 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireMedium02 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireLarge01 FireBuildingLarge")
            .WriteLine("  		ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("      End")
            .WriteLine("      AnimationState = GARRISONED DESTROYED_BACK")
            .WriteLine("  		Animation	= GBBtlTwrS_D2.GBBtlTwrS_D2")
            .WriteLine("  			AnimationName		=	GBBtlTwrS_D2.GBBtlTwrS_D2")
            .WriteLine("  			AnimationMode		=	LOOP	")
            .WriteLine("  		End")
            .WriteLine("        BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2C" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("        EndScript")
            .WriteLine("      End")
            .WriteLine("  ")
            .WriteLine("  	ModelConditionState  = GARRISONED DESTROYED_LEFT")
            .WriteLine("        Model         = GBBtlTwrS_D2  ")
            .WriteLine("  		ParticleSysBone FireSmall01 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall02 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall03 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall04 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireMedium01 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireMedium02 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireLarge01 FireBuildingLarge")
            .WriteLine("  		ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("      End")
            .WriteLine("      AnimationState = GARRISONED DESTROYED_LEFT")
            .WriteLine("  		Animation	= GBBtlTwrS_D2.GBBtlTwrS_D2")
            .WriteLine("  			AnimationName		=	GBBtlTwrS_D2.GBBtlTwrS_D2")
            .WriteLine("  			AnimationMode		=	LOOP	")
            .WriteLine("  		End	")
            .WriteLine("        BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2D" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("        EndScript")
            .WriteLine("      End")
            .WriteLine("  ")
            .WriteLine("      AnimationState = GARRISONED DAMAGED")
            .WriteLine("        Animation           = GBBtlTwrs")
            .WriteLine("          AnimationName     = GBBtlTwrs_D1.GBBtlTwrs_D1")
            .WriteLine("          AnimationMode     = LOOP")
            .WriteLine("        End")
            .WriteLine("  	  BeginScript")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("  	  EndScript")
            .WriteLine("      End")
            .WriteLine("  ")
            .WriteLine("      AnimationState = GARRISONED REALLYDAMAGED")
            .WriteLine("  		Animation	= GBBtlTwrS_D2.GBBtlTwrS_D2")
            .WriteLine("  			AnimationName		=	GBBtlTwrS_D2.GBBtlTwrS_D2")
            .WriteLine("  			AnimationMode		=	LOOP	")
            .WriteLine("  		End")
            .WriteLine("  	  BeginScript")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("  	  EndScript")
            .WriteLine("      End")
            .WriteLine("      ")
            .WriteLine("      AnimationState = GARRISONED RUBBLE")
            .WriteLine("  		Animation	= GBBtlTwrS_D2.GBBtlTwrS_D2")
            .WriteLine("  			AnimationName		=	GBBtlTwrS_D2.GBBtlTwrS_D2")
            .WriteLine("  			AnimationMode		=	LOOP	")
            .WriteLine("  		End	")
            .WriteLine("        BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2A" & Chr(34) & ")")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2B" & Chr(34) & ")")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2C" & Chr(34) & ")")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2D" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("        EndScript")
            .WriteLine("      End")
            .WriteLine("  ")
            .WriteLine("      AnimationState = GARRISONED CONSTRUCTION_COMPLETE")
            .WriteLine("        Animation           = GBBtlTwrs")
            .WriteLine("          AnimationName     = GBBtlTwrs.GBBtlTwrs")
            .WriteLine("          AnimationMode     = LOOP")
            .WriteLine("        End")
            .WriteLine("  	  BeginScript")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("  	  EndScript")
            .WriteLine("      End")
            .WriteLine("  ")
            .WriteLine("      AnimationState = GARRISONED")
            .WriteLine("        Animation           = GBBtlTwrs")
            .WriteLine("          AnimationName     = GBBtlTwrs.GBBtlTwrs")
            .WriteLine("          AnimationMode     = LOOP")
            .WriteLine("        End")
            .WriteLine("  	  BeginScript")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("  	  EndScript")
            .WriteLine("      End")
            .WriteLine("  ")
            .WriteLine("  	")
            .WriteLine("  	;---------------damage states- non-garrisoned----------------")
            .WriteLine("  	    ")
            .WriteLine("          ;--damaged building")
            .WriteLine("      ModelConditionState  = DESTROYED_FRONT")
            .WriteLine("        Model         = GBBtlTwrS_D2  ")
            .WriteLine("  		ParticleSysBone FireSmall01 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall02 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall03 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall04 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireMedium01 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireMedium02 FireBuildingMedium")
            .WriteLine("       	ParticleSysBone FireLarge01 FireBuildingLarge")
            .WriteLine("       	ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("      End")
            .WriteLine("      AnimationState = DESTROYED_FRONT")
            .WriteLine("        BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2A" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("        EndScript")
            .WriteLine("      End")
            .WriteLine("      ")
            .WriteLine("      ModelConditionState  = DESTROYED_RIGHT")
            .WriteLine("        Model         = GBBtlTwrS_D2  ")
            .WriteLine("  		ParticleSysBone FireSmall01 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall02 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall03 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall04 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireMedium01 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireMedium02 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireLarge01 FireBuildingLarge")
            .WriteLine("  		ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("      End")
            .WriteLine("      ")
            .WriteLine("      AnimationState = DESTROYED_RIGHT")
            .WriteLine("        BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2B" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableShowSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("        EndScript")
            .WriteLine("      End")
            .WriteLine("      ")
            .WriteLine("  ")
            .WriteLine("      ModelConditionState  = DESTROYED_BACK")
            .WriteLine("        Model         = GBBtlTwrS_D2  ")
            .WriteLine("  		ParticleSysBone FireSmall01 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall02 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall03 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall04 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireMedium01 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireMedium02 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireLarge01 FireBuildingLarge")
            .WriteLine("  		ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("      End")
            .WriteLine("      AnimationState = DESTROYED_BACK")
            .WriteLine("        BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2C" & Chr(34) & ")")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableHideSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableHideSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("        EndScript")
            .WriteLine("      End")
            .WriteLine("  ")
            .WriteLine("  	ModelConditionState  = DESTROYED_LEFT")
            .WriteLine("        Model         = GBBtlTwrS_D2  ")
            .WriteLine("  		ParticleSysBone FireSmall01 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall02 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall03 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireSmall04 FireBuildingSmall")
            .WriteLine("  		ParticleSysBone FireMedium01 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireMedium02 FireBuildingMedium")
            .WriteLine("  		ParticleSysBone FireLarge01 FireBuildingLarge")
            .WriteLine("  		ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("      End")
            .WriteLine("      AnimationState = DESTROYED_LEFT")
            .WriteLine("        BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2D" & Chr(34) & ")")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableHideSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableHideSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("        EndScript")
            .WriteLine("      End")
            .WriteLine("      ")
            .WriteLine("      ")
            .WriteLine("      ModelConditionState  = DAMAGED ")
            .WriteLine("        Model         = GBBtlTwrs_D1")
            .WriteLine("	")
            .WriteLine("      End ")
            .WriteLine("          AnimationState = DAMAGED")
            .WriteLine("     		EnteringStateFX	= FX_BuildingDamaged")
            .WriteLine("  	  BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableHideSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableHideSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("  	  EndScript")
            .WriteLine("      End")
            .WriteLine("  ")
            .WriteLine("      AnimationState = REALLYDAMAGED")
            .WriteLine("  	  BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableHideSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableHideSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("  	  EndScript")
            .WriteLine("     	EnteringStateFX	= FX_BuildingReallyDamaged")
            .WriteLine("      End")
            .WriteLine("  ")
            .WriteLine("     ")
            .WriteLine("  ")
            .WriteLine("      ModelConditionState  = REALLYDAMAGED ")
            .WriteLine("        Model         = GBBtlTwrs_D2")
            .WriteLine("	")
            .WriteLine("      End    ")
            .WriteLine("      ")
            .WriteLine("  ")
            .WriteLine("      ModelConditionState  = RUBBLE")
            .WriteLine("        Model         = GBBtlTwrS_D2  ")
            .WriteLine("        ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("      End")
            .WriteLine("      ")
            .WriteLine("  ")
            .WriteLine("      AnimationState = RUBBLE")
            .WriteLine("        BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2A" & Chr(34) & ")")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2B" & Chr(34) & ")")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2C" & Chr(34) & ")")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "D2D" & Chr(34) & ")")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableHideSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableHideSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("        EndScript")
            .WriteLine("      End")
            .WriteLine("  ")
            .WriteLine("      ModelConditionState  = POST_RUBBLE")
            .WriteLine("        Model         = None")
            .WriteLine("  		ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("      End")
            .WriteLine("      ")
            .WriteLine("      AnimationState = POST_RUBBLE")
            .WriteLine("      End")
            .WriteLine("  ")
            .WriteLine("      ModelConditionState  = POST_COLLAPSE")
            .WriteLine("        Model         = None")
            .WriteLine("  		ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("      End")
            .WriteLine("      AnimationState = POST_COLLAPSE")
            .WriteLine("      End")
            .WriteLine("      ")
            .WriteLine("      ")
            .WriteLine("     AnimationState = CONSTRUCTION_COMPLETE")
            .WriteLine("  	  BeginScript")
            .WriteLine("          CurDrawableHideSubObject(" & Chr(34) & "GARRISON_01" & Chr(34) & ")")
            .WriteLine("  		CurDrawableHideSubObject(" & Chr(34) & "GARRISON_02" & Chr(34) & ")")
            .WriteLine("  		CurDrawableHideSubObject(" & Chr(34) & "GARRISON_03" & Chr(34) & ")")
            .WriteLine("  	  EndScript")
            .WriteLine("  	End")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Draw = W3DFloorDraw ModuleTag_DrawFloor    ")
            .WriteLine("     ModelName = GBBtlTwrS_Bib")
            .WriteLine("  End")
            .WriteLine("    ")
            .WriteLine("   ")
            .WriteLine("    ; ***DESIGN parameters ***")
            .WriteLine("    DisplayName         = OBJECT:CivilianBattleTower")
            .WriteLine("    Side                = Civilian")
            .WriteLine("    EditorSorting       = STRUCTURE")
            .WriteLine("    ThreatLevel = 1.0")
            .WriteLine("   ")
            .WriteLine("    BuildCost           = 1000")
            .WriteLine("    BuildTime           = 30.0           ; in seconds")
            .WriteLine("    VisionRange         = 160.0          ; Shroud clearing distance")
            .WriteLine("    ShroudClearingRange = 160")
            .WriteLine("  ")
            .WriteLine("  ")
            .WriteLine("    ; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	VoiceSelect			= Gui_PlotSelect")
            .WriteLine("")
            .WriteLine("	SoundOnDamaged			= BuildingLightDamageStone")
            .WriteLine("	SoundOnReallyDamaged		= BuildingHeavyDamageStone")
            .WriteLine("  ")
            .WriteLine("  ")
            .WriteLine("    ; *** ENGINEERING Parameters ***")
            .WriteLine("    RadarPriority       = STRUCTURE")
            .WriteLine("    KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE NEED_BASE_FOUNDATION CAN_ATTACK	; GARRISONABLE_UNTIL_DESTROYED GARRISON")
            .WriteLine(" 	CommandSet			= NeutralBattleTowerCommandSet")
            .WriteLine("  ")
            .WriteLine("    Behavior            = GettingBuiltBehavior ModuleTag_04")
            .WriteLine("		SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker")
            .WriteLine("		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound")
            .WriteLine("		SelfRepairFromRubbleLoop  = BuildingConstructionLoop")
            .WriteLine("    End")
            .WriteLine("  ")
            .WriteLine("  ")
            .WriteLine("    Body                = StructureBody ModuleTag_05")
            .WriteLine("      MaxHealth         = 1500.0")
            .WriteLine("  	MaxHealthDamaged  = 750.0")
            .WriteLine("  	MaxHealthReallyDamaged = 325.0")
            .WriteLine("  	DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK")
            .WriteLine("      ")
            .WriteLine("      DamageCreationList = OCL_GBBtlTwrSD2_Chunk1 CATAPULT_ROCK FRONT_DESTROYED")
            .WriteLine("      DamageCreationList = OCL_GBBtlTwrSD2_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED")
            .WriteLine("      DamageCreationList = OCL_GBBtlTwrSD2_Chunk3 CATAPULT_ROCK BACK_DESTROYED")
            .WriteLine("      DamageCreationList = OCL_GBBtlTwrSD2_Chunk4 CATAPULT_ROCK LEFT_DESTROYED")
            .WriteLine("    End")
            .WriteLine("  ")
            .WriteLine("    Behavior                  = BuildingBehavior BuildingModuleTag")
            .WriteLine("      NightWindowName         = WINDOW_N01")
            .WriteLine("      ;FireWindowName          = WINDOW_F01")
            .WriteLine("      ;GlowWindowName	    = WINDOW_G01")
            .WriteLine("    End")
            .WriteLine("   ")
            .WriteLine("    Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("        DestructionDelay  = 5000")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("    Behavior                  = StructureCollapseUpdate ModuleTag_StructureCollapseUpdate")
            .WriteLine("      MinCollapseDelay        = 000")
            .WriteLine("      MaxCollapseDelay        = 000")
            .WriteLine("      CollapseDamping         = .5")
            .WriteLine("      MaxShudder              = 0.6")
            .WriteLine("      MinBurstDelay           = 250")
            .WriteLine("      MaxBurstDelay           = 800")
            .WriteLine("      BigBurstFrequency       = 4")
            .WriteLine("      FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("      OCL						= INITIAL   OCL_StructureRubblePileLarge")
            .WriteLine("  ")
            .WriteLine("    End")
            .WriteLine("  ")
            .WriteLine("    ")
            .WriteLine("  ")
            .WriteLine("  	Behavior       = EvacuateDamage ModuleTag_evacuateDamage")
            .WriteLine("  		WeaponThatCausesEvacuation  = MordorCatapultHumanHeads")
            .WriteLine("  	End")
            .WriteLine("  ")
            .WriteLine(";    Behavior            = HordeGarrisonContain ModuleTag_hordeGarrison")
            .WriteLine(";		ObjectStatusOfContained			= UNSELECTABLE CAN_ATTACK")
            .WriteLine(";		ContainMax						= 4")
            .WriteLine(";		MaxHordeCapacity				= 4")
            .WriteLine(";		;PassengersTestCollisionHeight	= 80")
            .WriteLine(";		;Slots							= 1")
            .WriteLine(";	;   EnterSound						= GarrisonEnter")
            .WriteLine(";	;   ExitSound						= GarrisonExit")
            .WriteLine(";		DamagePercentToUnits			= 0%")
            .WriteLine(";		PassengerFilter					= ANY +INFANTRY +HORDE")
            .WriteLine(";		AllowEnemiesInside				= No")
            .WriteLine(";		AllowNeutralInside				= Yes")
            .WriteLine(";		;ExitDelay						= 250")
            .WriteLine(";		NumberOfExitPaths				= 1 ; Defaults to 1.  Set 0 to not use ExitStart/ExitEnd, set higher than 1 to use ExitStart01-nn/ExitEnd01-nn")
            .WriteLine(";	;   GoAggressiveOnExit				= Yes ; AI Will tell people to set their mood to Aggressive on exiting")
            .WriteLine(";		;ForceOrientationContainer		= No  ; otherwise contained units can't orient themselves towards their targets...")
            .WriteLine(";		PassengerBonePrefix				= PassengerBone:ARROW_0 KindOf:INFANTRY")
            .WriteLine(";   End;")
            .WriteLine("  ")
            .WriteLine("    Geometry              = CYLINDER")
            .WriteLine("    GeometryMajorRadius   = 26.4")
            .WriteLine("    GeometryMinorRadius   = 26.4")
            .WriteLine("    GeometryHeight        = 112.0")
            .WriteLine("    ")
            .WriteLine("    GeometryIsSmall       = No")
            .WriteLine("    Shadow                = SHADOW_VOLUME")
            .WriteLine("    BuildCompletion     = PLACED_BY_PLAYER")
            .WriteLine("    ")
            .WriteLine("    GeometryContactPoint				= X:-12.566		Y:20.258	Z:0			Repair")
            .WriteLine("    GeometryContactPoint				= X:6.209		Y:-21.579	Z:0			Repair")
            .WriteLine("    GeometryContactPoint				= X:-21.83		Y:-10.356	Z:0")
            .WriteLine("    GeometryContactPoint				= X:18.362		Y:16.444	Z:0")
            .WriteLine("    GeometryContactPoint				= X:-0.459		Y:-0.275	Z:116.828	Swoop")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ;------------------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object GondorBuildingSizeTemplate")
            .WriteLine("")
            .WriteLine("    ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBSizeTemplate")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName = OBJECT:GBSizeTemplate")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  KindOf =  IMMOBILE UNATTACKABLE")
            .WriteLine("  Shadow = SHADOW_VOLUME")
            .WriteLine("  Body = ActiveBody ModuleTag_03")
            .WriteLine("    MaxHealth = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 13.6")
            .WriteLine("  GeometryMinorRadius = 12.0")
            .WriteLine("  GeometryHeight = 72.0")
            .WriteLine("  GeometryIsSmall = No")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object RohanBuildingSizeTemplate")
            .WriteLine("")
            .WriteLine("    ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = RBSizeTemplate")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName = OBJECT:RBSizeTemplate")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  KindOf =  IMMOBILE UNATTACKABLE")
            .WriteLine("  Shadow = SHADOW_VOLUME")
            .WriteLine("  Body = ActiveBody ModuleTag_03")
            .WriteLine("    MaxHealth = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 13.6")
            .WriteLine("  GeometryMinorRadius = 12.0")
            .WriteLine("  GeometryHeight = 72.0")
            .WriteLine("  GeometryIsSmall = No")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object MordorBuildingSizeTemplate")
            .WriteLine("")
            .WriteLine("    ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBSizeTemplate")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName = OBJECT:MBSizeTemplate")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  KindOf =  IMMOBILE UNATTACKABLE")
            .WriteLine("  Shadow = SHADOW_VOLUME")
            .WriteLine("  Body = ActiveBody ModuleTag_03")
            .WriteLine("    MaxHealth = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 13.6")
            .WriteLine("  GeometryMinorRadius = 12.0")
            .WriteLine("  GeometryHeight = 72.0")
            .WriteLine("  GeometryIsSmall = No")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object ExpansionFlag")
            .WriteLine("")
            .WriteLine(";SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("      OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NMiniCamp_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = ExpnCampFlag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NMiniCamp_SKL.NMiniCamp_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NMiniCamp_SKL.NMiniCamp_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NMiniCamp_SKL.NMiniCamp_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NMiniCamp_SKL.NMiniCamp_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NMiniCamp_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";--------------------- AUDIO ------------------------")
            .WriteLine("")
            .WriteLine("	VoiceSelect			= Gui_PlotSelect")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:OutpostFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = OutpostFlagCommandSet ;CastleFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 1")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Expansion_(f) & " 800")
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("	MaxCastleRadius = 180.0")
            .WriteLine("	FadeTime = 1.0 ; 2 seconds")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 12.0")
            .WriteLine("  GeometryMinorRadius = 12.0")
            .WriteLine("  GeometryHeight      = 12.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("ChildObject OutpostFlag ExpansionFlag")
            .WriteLine("	CommandSet = OutpostFlagCommandSet")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("ChildObject PrebuiltOutpost01 ExpansionFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("	  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Expansion_(f) & " 800")
                End If
            Next
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		MaxCastleRadius = 180")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("ChildObject PrebuiltOutpost02 ExpansionFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("	  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Expansion_(f) & " 800")
                End If
            Next
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		MaxCastleRadius = 180")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("ChildObject PrebuiltOutpost03 ExpansionFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("	  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Expansion_(f) & " 800")
                End If
            Next
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		MaxCastleRadius = 180")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("ChildObject PrebuiltOutpost04 ExpansionFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("	  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Expansion_(f) & " 800")
                End If
            Next
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		MaxCastleRadius = 180")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("ChildObject PrebuiltOutpost05 ExpansionFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("	  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Expansion_(f) & " 800")
                End If
            Next
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		MaxCastleRadius = 180")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("ChildObject PrebuiltOutpost06 ExpansionFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("	  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Expansion_(f) & " 800")
                End If
            Next
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		MaxCastleRadius = 180")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("ChildObject PrebuiltOutpost07 ExpansionFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("	  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Expansion_(f) & " 800")
                End If
            Next
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		MaxCastleRadius = 180")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("ChildObject PrebuiltOutpost08 ExpansionFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("	  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Expansion_(f) & " 800")
                End If
            Next
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		MaxCastleRadius = 180")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object AIFlag")
            .WriteLine("")
            .WriteLine(";SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("      OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = AICamp_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NMiniCamp_SKL.NMiniCamp_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NMiniCamp_SKL.NMiniCamp_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NMiniCamp_SKL.NMiniCamp_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NMiniCamp_SKL.NMiniCamp_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NMiniCamp_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";--------------------- AUDIO ------------------------")
            .WriteLine("")
            .WriteLine("	VoiceSelect			= Gui_PlotSelect")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:CampFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = CampFlagCommandSet ;CastleFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 1")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Expansion_(f) & " 800")
                End If
            Next
            .WriteLine(" ")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("	MaxCastleRadius = 180.0")
            .WriteLine("	FadeTime = 1.0 ; 2 seconds")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 12.0")
            .WriteLine("  GeometryMinorRadius = 12.0")
            .WriteLine("  GeometryHeight      = 12.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow				= SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenW5")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenW5")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenW5")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 5.5")
            .WriteLine("  GeometryMinorRadius   = 47.0")
            .WriteLine("  GeometryHeight        = 45.0")
            .WriteLine("  GeometryOffset		= X:20 Y:0 Z:0")
            .WriteLine("")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 15.0")
            .WriteLine("  GeometryMinorRadius   = 5.5")
            .WriteLine("  GeometryHeight        = 20.0	")
            .WriteLine("  GeometryOffset		= X:-5.5 Y:20 Z:0  ")
            .WriteLine("  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenW4")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenW4")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenW4")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 6.2")
            .WriteLine("  GeometryMinorRadius   = 100.0")
            .WriteLine("  GeometryHeight        = 45.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenW3")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenW3")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenW3")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 5.4")
            .WriteLine("  GeometryMinorRadius   = 55.0")
            .WriteLine("  GeometryHeight        = 44.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenW2")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenW2")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenW2")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 5.0")
            .WriteLine("  GeometryMinorRadius   = 28.0")
            .WriteLine("  GeometryHeight        = 44.8")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenW1")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenW1")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenW1")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 5.2")
            .WriteLine("  GeometryMinorRadius   = 80.0")
            .WriteLine("  GeometryHeight        = 42.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenSP")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenSP")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenSP")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Canoe")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 52.0")
            .WriteLine("  GeometryMinorRadius   = 7.0")
            .WriteLine("  GeometryHeight        = 11.2")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenS5")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenS5")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenS5")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 7.1")
            .WriteLine("  GeometryMinorRadius   = 7.0")
            .WriteLine("  GeometryHeight        = 39.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenS4")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenS4")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenS4")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 5.0")
            .WriteLine("  GeometryMinorRadius   = 4.5")
            .WriteLine("  GeometryHeight        = 41.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME_NEW")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenS3")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenS3")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenS3")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 5.1")
            .WriteLine("  GeometryMinorRadius   = 4.7")
            .WriteLine("  GeometryHeight        = 45.7")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenS2")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenS2")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenS2")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = CYLINDER")
            .WriteLine("  GeometryMajorRadius   = 22.0")
            .WriteLine("  GeometryMinorRadius   = 22.0")
            .WriteLine("  GeometryHeight        = 24.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenS1")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenS1")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenS1")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 20.0")
            .WriteLine("  GeometryMinorRadius   = 10.0")
            .WriteLine("  GeometryHeight        = 28.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenR3")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenR3")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine(";  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine(";  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Rocks")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine(" ")
            .WriteLine("  TransportSlotCount  = 1")
            .WriteLine("   ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 20.0")
            .WriteLine("  GeometryMinorRadius   = 11.5")
            .WriteLine("  GeometryHeight        = 13.0")
            .WriteLine("  GeometryOffset		= X:-8 Y:0 Z:0  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME_NEW")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenR2")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenR2")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine(";  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine(";  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Rocks")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  TransportSlotCount  = 1  ")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine(" ")
            .WriteLine("  Geometry              = CYLINDER")
            .WriteLine("  GeometryMajorRadius   = 21.0")
            .WriteLine("  GeometryMinorRadius   = 21.0")
            .WriteLine("  GeometryHeight        = 9.7")
            .WriteLine("  GeometryOffset		= X:0 Y:7.7 Z:0  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME_NEW")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenR1")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenR1")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine(";  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine(";  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Rocks")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("  TransportSlotCount  = 1  ")
            .WriteLine("	")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = CYLINDER")
            .WriteLine("  GeometryMajorRadius   = 18.0")
            .WriteLine("  GeometryMinorRadius   = 18.0")
            .WriteLine("  GeometryHeight        = 16.5")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow              = SHADOW_VOLUME_NEW")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenC5")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenC5")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenC5")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 7.3")
            .WriteLine("  GeometryMinorRadius   = 7.3")
            .WriteLine("  GeometryHeight        = 33.7")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenC4")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenC4")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenC4")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 11.1")
            .WriteLine("  GeometryMinorRadius   = 10.0")
            .WriteLine("  GeometryHeight        = 55.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenC3")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenC3")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenC3")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = CYLINDER")
            .WriteLine("  GeometryMajorRadius   = 33.0")
            .WriteLine("  GeometryMinorRadius   = 33.0")
            .WriteLine("  GeometryHeight        = 61.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenC2")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenC2")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenC2")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 8.1")
            .WriteLine("  GeometryMinorRadius   = 10.4")
            .WriteLine("  GeometryHeight        = 44.3")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenC1")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenC1")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenC1")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 6.3")
            .WriteLine("  GeometryMinorRadius   = 6.6")
            .WriteLine("  GeometryHeight        = 40.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenBg")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenBg")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("    WallBoundsMesh = P2")
            .WriteLine("	RampMesh1 = P1")
            .WriteLine("	RampMesh2 = P3")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenBg")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Bridge")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI WALK_ON_TOP_OF_WALL")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus")
            .WriteLine("		StartsActive	= Yes ;If no, requires upgrade to turn on.")
            .WriteLine("		BonusName		= WallBonus")
            .WriteLine("		RefreshDelay	= 2000")
            .WriteLine("		;Range			= 120		; Range is overridden to affect people on us since we are a wall")
            .WriteLine("		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall")
            .WriteLine("	End	")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 45.0")
            .WriteLine("  GeometryMinorRadius   = 50.0")
            .WriteLine("  GeometryHeight        = 20.0")
            .WriteLine("  GeometryOffset		= X:0 Y:72 Z:0 ")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 45.0")
            .WriteLine("  GeometryMinorRadius   = 50.0")
            .WriteLine("  GeometryHeight        = 20.0")
            .WriteLine("  GeometryOffset		= X:0 Y:-72 Z:0 ")
            .WriteLine("  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenB2")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenB2")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("    WallBoundsMesh = P2")
            .WriteLine("	RampMesh1 = P1")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenB2")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus")
            .WriteLine("		StartsActive	= Yes ;If no, requires upgrade to turn on.")
            .WriteLine("		BonusName		= WallBonus")
            .WriteLine("		RefreshDelay	= 2000")
            .WriteLine("		;Range			= 120		; Range is overridden to affect people on us since we are a wall")
            .WriteLine("		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall")
            .WriteLine("	End	")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 60.0")
            .WriteLine("  GeometryMinorRadius   = 33.0")
            .WriteLine("  GeometryHeight        = 49.0")
            .WriteLine("  ")
            .WriteLine(";  AdditionalGeometry    = BOX")
            .WriteLine(";  GeometryMajorRadius   = 12.5")
            .WriteLine(";  GeometryMinorRadius   = 12.5")
            .WriteLine(";  GeometryHeight        = 55.0")
            .WriteLine(";  GeometryOffset		= X:32 Y:0 Z:48 ")
            .WriteLine("  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenB1")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenB1")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenB1")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 65.4")
            .WriteLine("  GeometryMinorRadius   = 98.8")
            .WriteLine("  GeometryHeight        = 134.8")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenB3")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenB3")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenB3")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine(" ")
            .WriteLine("")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine("; By removing this the building is no longer damagable")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine(";  KindOf                = STRUCTURE SELECTABLE IMMOBILE NOT_AUTOACQUIRABLE CHUNK_VENDOR")
            .WriteLine(";  RadarPriority = STRUCTURE")
            .WriteLine(";")
            .WriteLine(";  Body                  = ActiveBody ModuleTag_02")
            .WriteLine(";    MaxHealth       = 2000.0")
            .WriteLine(";    ")
            .WriteLine(";	GrabObject = EntThrownBuildingRock")
            .WriteLine(";	GrabFX = FX_WallGrab")
            .WriteLine(";	GrabOffset = X:16 Y:0  		    ")
            .WriteLine(";  End")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 33.0")
            .WriteLine("  GeometryMinorRadius   = 37.5")
            .WriteLine("  GeometryHeight        = 100.0")
            .WriteLine("  GeometryOffset		= X:-72 Y:45 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 72.5")
            .WriteLine("  GeometryMinorRadius   = 45.0")
            .WriteLine("  GeometryHeight        = 145.0")
            .WriteLine("  GeometryOffset		= X:0 Y:-5 Z:0")
            .WriteLine("    ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 30.0")
            .WriteLine("  GeometryMinorRadius   = 20.0")
            .WriteLine("  GeometryHeight        = 130")
            .WriteLine("  GeometryOffset		= X:70 Y:45 Z:0")
            .WriteLine("")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenB4")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenB4")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenB4")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine(" ")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine("; By removing this the building is no longer damagable")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine(";")
            .WriteLine(";  KindOf                = STRUCTURE SELECTABLE IMMOBILE NOT_AUTOACQUIRABLE CHUNK_VENDOR")
            .WriteLine(";  RadarPriority = STRUCTURE")
            .WriteLine(";")
            .WriteLine(";  Body                  = ActiveBody ModuleTag_02")
            .WriteLine(";    MaxHealth       = 2000.0")
            .WriteLine(";   ")
            .WriteLine(";	GrabObject = EntThrownBuildingRock")
            .WriteLine(";	GrabFX = FX_WallGrab")
            .WriteLine(";	GrabOffset = X:16 Y:0  		    ")
            .WriteLine(";  End")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 55.0")
            .WriteLine("  GeometryHeight        = 130.0")
            .WriteLine("  GeometryOffset		= X:50 Y:-16 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 32.5")
            .WriteLine("  GeometryMinorRadius   = 90.0")
            .WriteLine("  GeometryHeight        = 140.0")
            .WriteLine("  GeometryOffset		= X:-3 Y:-5 Z:0")
            .WriteLine("    ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 30.0")
            .WriteLine("  GeometryMinorRadius   = 45.0")
            .WriteLine("  GeometryHeight        = 75.0")
            .WriteLine("  GeometryOffset		= X:-62 Y:-48 Z:0")
            .WriteLine("")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 15.0")
            .WriteLine("  GeometryMinorRadius   = 15.0")
            .WriteLine("  GeometryHeight        = 50.0")
            .WriteLine("  GeometryOffset		= X:-72 Y:45 Z:0")
            .WriteLine("    ")
            .WriteLine("    ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("Object GondorAmonHenB5")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("  OkToChangeModelColor = Yes")
            .WriteLine("  ")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBAmonHenB5")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = RUBBLE")
            .WriteLine("      Model         = GBAmonHenB5")
            .WriteLine("      ParticleSysBone SmokeLarge01 SmokeBuildingLarge")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_RUBBLE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ModelConditionState  = POST_COLLAPSE")
            .WriteLine("      Model         = None")
            .WriteLine("      ParticleSysBone NONE SmokeBuildingMediumRubble")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("  SoundAmbientDamaged = GenericFireMediumLoop")
            .WriteLine("  SoundAmbientReallyDamaged = GenericFireLargeLoop")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName      = OBJECT:Ruins")
            .WriteLine("")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = NoArmor")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine("; By removing this the building is no longer damagable")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine(";  ")
            .WriteLine(";  KindOf                = STRUCTURE SELECTABLE IMMOBILE NOT_AUTOACQUIRABLE CHUNK_VENDOR")
            .WriteLine(";  RadarPriority = STRUCTURE")
            .WriteLine(";")
            .WriteLine(";  Body                  = ActiveBody ModuleTag_02")
            .WriteLine(";    MaxHealth       = 2000.0")
            .WriteLine(";    ")
            .WriteLine(";	GrabObject = EntThrownBuildingRock")
            .WriteLine(";	GrabFX = FX_WallGrab")
            .WriteLine(";	GrabOffset = X:16 Y:0  		    ")
            .WriteLine(";  End")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  KindOf                = STRUCTURE IMMOBILE IGNORED_IN_GUI")
            .WriteLine("  RadarPriority = STRUCTURE")
            .WriteLine("")
            .WriteLine("  Body                  = InactiveBody ModuleTag_02")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  ; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 2100")
            .WriteLine("  End")
            .WriteLine("  ")
            .WriteLine("  Behavior                  = StructureCollapseUpdate ModuleTag_03")
            .WriteLine("    MinCollapseDelay        = 000")
            .WriteLine("    MaxCollapseDelay        = 000")
            .WriteLine("    CollapseDamping         = .5")
            .WriteLine("    MaxShudder              = 0.6")
            .WriteLine("    MinBurstDelay           = 250")
            .WriteLine("    MaxBurstDelay           = 800")
            .WriteLine("    BigBurstFrequency       = 4")
            .WriteLine("    FXList                  = INITIAL   FX_StructureMediumCollapse")
            .WriteLine("    OCL						= INITIAL	OCL_StructureRubblePileLarge ; creates a rising pile of debris halfway-done")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 25.0")
            .WriteLine("  GeometryMinorRadius   = 95.0")
            .WriteLine("  GeometryHeight        = 130.0")
            .WriteLine("  GeometryOffset		= X:3 Y:0 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 70.0")
            .WriteLine("  GeometryMinorRadius   = 20.0")
            .WriteLine("  GeometryHeight        = 130.0")
            .WriteLine("  GeometryOffset		= X:28 Y:-23 Z:0")
            .WriteLine("    ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 45.0")
            .WriteLine("  GeometryHeight        = 75.0")
            .WriteLine("  GeometryOffset		= X:-55 Y:-48 Z:0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("Object ElvenBridge")
            .WriteLine("")
            .WriteLine("	; *** ART Parameters ***")
            .WriteLine("		Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("			OkToChangeModelColor = Yes")
            .WriteLine("			")
            .WriteLine("			StaticModelLODMode = yes")
            .WriteLine("			")
            .WriteLine("			DefaultModelConditionState")
            .WriteLine("				Model = LBBridge")
            .WriteLine("			End")
            .WriteLine("		")
            .WriteLine("		    WallBoundsMesh	= P2")
            .WriteLine("		    RampMesh1		= P1")
            .WriteLine("		    RampMesh2		= P3		    ")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("	; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	; ***DESIGN parameters ***")
            .WriteLine("		DisplayName      = OBJECT:ElvenBridge")
            .WriteLine("		EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("		ArmorSet")
            .WriteLine("			Conditions        = None")
            .WriteLine("			Armor             = NoArmor")
            .WriteLine("			DamageFX          = None")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("	; *** ENGINEERING Parameters ***  ")
            .WriteLine("		KindOf                = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL CHUNK_VENDOR  NOT_AUTOACQUIRABLE NONOCCLUDING")
            .WriteLine("		RadarPriority		= STRUCTURE")
            .WriteLine("		Body                  = InactiveBody ModuleTag_03")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("		; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("		; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("		; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("		Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 4000")
            .WriteLine("		End")
            .WriteLine("		  ")
            .WriteLine("  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus")
            .WriteLine("		StartsActive	= Yes ;If no, requires upgrade to turn on.")
            .WriteLine("		BonusName		= WallBonus")
            .WriteLine("		RefreshDelay	= 2000")
            .WriteLine("		;Range			= 120		; Range is overridden to affect people on us since we are a wall")
            .WriteLine("		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall")
            .WriteLine("	End	")
            .WriteLine("")
            .WriteLine("		Geometry              = BOX")
            .WriteLine("		GeometryMajorRadius   = 120.0")
            .WriteLine("		GeometryMinorRadius   = 60.0")
            .WriteLine("		GeometryHeight        = 32.6")
            .WriteLine("		GeometryIsSmall       = No")
            .WriteLine("		Shadow                = SHADOW_VOLUME")
            .WriteLine("		")
            .WriteLine("		GeometryContactPoint			= X:80		Y: -48		Z:7 Grab")
            .WriteLine("		GeometryContactPoint			= X:80		Y: 48		Z:7 Grab")
            .WriteLine("		")
            .WriteLine("		GeometryContactPoint			= X:0		Y: 48		Z:12 Grab")
            .WriteLine("		")
            .WriteLine("		GeometryContactPoint			= X:-80		Y: 48		Z:7 Grab")
            .WriteLine("		GeometryContactPoint			= X:-80		Y: -48		Z:7 Grab")
            .WriteLine("		")
            .WriteLine("		GeometryContactPoint			= X:0		Y: -48		Z:12 Grab")
            .WriteLine("		")
            .WriteLine("		GeometryContactPoint			= X:80		Y: -48		Z:7 ")
            .WriteLine("		")
            .WriteLine("		")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("Object LavaBridge")
            .WriteLine("")
            .WriteLine("	; *** ART Parameters ***")
            .WriteLine("		Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("			OkToChangeModelColor = Yes")
            .WriteLine("			DefaultModelConditionState")
            .WriteLine("				Model = PMLavaBridge01")
            .WriteLine("			End")
            .WriteLine("		")
            .WriteLine("		    WallBoundsMesh	= P2")
            .WriteLine("		    RampMesh1		= P1")
            .WriteLine("		    RampMesh2		= P3		    ")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("	; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	; ***DESIGN parameters ***")
            .WriteLine("		DisplayName      = OBJECT:LavaBridge")
            .WriteLine("		EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("		ArmorSet")
            .WriteLine("			Conditions        = None")
            .WriteLine("			Armor             = NoArmor")
            .WriteLine("			DamageFX          = None")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("	; *** ENGINEERING Parameters ***  ")
            .WriteLine("		KindOf                = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL CHUNK_VENDOR  NOT_AUTOACQUIRABLE")
            .WriteLine("		RadarPriority		= STRUCTURE")
            .WriteLine("		Body                  = InactiveBody ModuleTag_03")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("		; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("		; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("		; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("		Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 4000")
            .WriteLine("		End")
            .WriteLine("		  ")
            .WriteLine("  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus")
            .WriteLine("		StartsActive	= Yes ;If no, requires upgrade to turn on.")
            .WriteLine("		BonusName		= WallBonus")
            .WriteLine("		RefreshDelay	= 2000")
            .WriteLine("		;Range			= 120		; Range is overridden to affect people on us since we are a wall")
            .WriteLine("		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall")
            .WriteLine("	End	")
            .WriteLine("")
            .WriteLine("		Geometry              = BOX")
            .WriteLine("		GeometryMajorRadius   = 68.0")
            .WriteLine("		GeometryMinorRadius   = 100.0")
            .WriteLine("		GeometryHeight        = 65.6")
            .WriteLine("		GeometryIsSmall       = No")
            .WriteLine("		Shadow                = SHADOW_VOLUME")
            .WriteLine("		")
            .WriteLine("		GeometryContactPoint			= X:40		Y: -60		Z:20 Grab")
            .WriteLine("		GeometryContactPoint			= X:40		Y: 0		Z:45 Grab")
            .WriteLine("		GeometryContactPoint			= X:40		Y: 60		Z:20 Grab ")
            .WriteLine("		GeometryContactPoint			= X:-40		Y: 60		Z:20 Grab")
            .WriteLine("		GeometryContactPoint			= X:-38		Y: 0		Z:45 Grab")
            .WriteLine("		GeometryContactPoint			= X:-38		Y: -60		Z:20 Grab")
            .WriteLine("		GeometryContactPoint			= X:40		Y: -60		Z:20")
            .WriteLine("		")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("Object SinglePlotCampFlag")
            .WriteLine("")
            .WriteLine("	SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("      OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = NMiniCamp_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = ExpnCampFlag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NMiniCamp_SKL.NMiniCamp_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NMiniCamp_SKL.NMiniCamp_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NMiniCamp_SKL.NMiniCamp_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NMiniCamp_SKL.NMiniCamp_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("  ;-------------Floor bib")
            .WriteLine("  ")
            .WriteLine("	Draw = W3DFloorDraw DrawFloorBib    ")
            .WriteLine("		ModelName = NMiniCamp_Bib")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine(";--------------------- AUDIO ------------------------")
            .WriteLine("")
            .WriteLine("	VoiceSelect			= Gui_PlotSelect")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName         = OBJECT:OutpostFlag  ")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Side            = Civilian")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions      = None")
            .WriteLine("    Armor           = InvulnerableArmor")
            .WriteLine("    DamageFX        = EmptyDamageFX   ; just to avoid an assert")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  CommandSet = OutpostFlagCommandSet")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY BASE_SITE")
            .WriteLine("  Body                = ImmortalBody ModuleTag_02")
            .WriteLine("    MaxHealth       = 1")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("	UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("")
            .WriteLine("  	UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Single_(f) & " 500")
                End If
            Next
            .WriteLine("")
            .WriteLine("	FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("	")
            .WriteLine("	MaxCastleRadius = 180")
            .WriteLine("	FadeTime = 1.0 ; 2 seconds")
            .WriteLine("  End  ")
            .WriteLine("  ")
            .WriteLine("  Geometry            = CYLINDER")
            .WriteLine("  GeometryMajorRadius = 12.0")
            .WriteLine("  GeometryMinorRadius = 12.0")
            .WriteLine("  GeometryHeight      = 12.0")
            .WriteLine("  GeometryIsSmall     = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";--------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject SinglePlotPrebuilt01 SinglePlotCampFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("		")
            .WriteLine("		UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Single_(f) & " 2000")
                End If
            Next
            .WriteLine("")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject SinglePlotPrebuilt02 SinglePlotCampFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("		")
            .WriteLine("		UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Single_(f) & " 2000")
                End If
            Next
            .WriteLine("		")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject SinglePlotPrebuilt03 SinglePlotCampFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("		")
            .WriteLine("		UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Single_(f) & " 2000")
                End If
            Next
            .WriteLine("		")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject SinglePlotPrebuilt04 SinglePlotCampFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("		")
            .WriteLine("		UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Single_(f) & " 2000")
                End If
            Next
            .WriteLine("		")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";-----------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject SinglePlotPrebuilt05 SinglePlotCampFlag")
            .WriteLine("	Behavior = CastleBehavior ModuleTag_castle")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                SidesAllowed = " & Fact(f).Side & " FROM_PLAYER FROM_AI FROM_SCRIPT")
                End If
            Next
            .WriteLine("		UseSecondaryBuildList = No  ; NOTE: Castles and lumber mills use Secondary Build lists. Only Camps use Primary Build lists.")
            .WriteLine("		")
            .WriteLine("		UseTheNewCastleSystemInsteadOfTheClunkyBuildList = Yes")
            For f As Integer = 0 To FactNum
                If Fact(f).CreateCB = True Then
                    .WriteLine("                CastleToUnpackForFaction = " & Fact(f).Side & " " & Single_(f) & " 2000")
                End If
            Next
            .WriteLine("		")
            .WriteLine("		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		;Anything that does not fit this filter will be given to the neutral player, so the template can have rocks and props.")
            .WriteLine("		")
            .WriteLine("		FadeTime = 1.0 ; 2 seconds")
            .WriteLine("	  	PreBuiltList = GondorFarm 1	")
            .WriteLine("	  	PreBuiltPlyr = PlyrGondor 	")
            .WriteLine("	End  ")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";")
            .WriteLine(";  Cirith Ungol")
            .WriteLine(";")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolBridgeA")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUBridgeA")
            .WriteLine("    End")
            .WriteLine("        RaisedWallMesh = P2")
            .WriteLine("        RampMesh1 = P1")
            .WriteLine("        RampMesh2 = P3")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE STRUCTURE WALK_ON_TOP_OF_WALL")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 35.0")
            .WriteLine("  GeometryHeight        = 120.0")
            .WriteLine("    GeometryOffset		= X:0 Y:130 Z:0")
            .WriteLine("    ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 35.0")
            .WriteLine("  GeometryHeight        = 120.0")
            .WriteLine("    GeometryOffset		= X:0 Y:-130 Z:0")
            .WriteLine("    ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 100.0")
            .WriteLine("  GeometryHeight        = 0.0")
            .WriteLine("  GeometryOffset		= X:0 Y:0 Z:90")
            .WriteLine("      ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolBridgeB")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUBridgeB")
            .WriteLine("    End")
            .WriteLine("        RaisedWallMesh = P2")
            .WriteLine("        RampMesh1 = P1")
            .WriteLine("        RampMesh2 = P3")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol_B")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE STRUCTURE WALK_ON_TOP_OF_WALL")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 35.0")
            .WriteLine("  GeometryHeight        = 120.0")
            .WriteLine("    GeometryOffset		= X:0 Y:130 Z:0")
            .WriteLine("    ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 35.0")
            .WriteLine("  GeometryHeight        = 120.0")
            .WriteLine("    GeometryOffset		= X:0 Y:-130 Z:0")
            .WriteLine("    ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 100.0")
            .WriteLine("  GeometryHeight        = 0.0")
            .WriteLine("  GeometryOffset		= X:0 Y:0 Z:90")
            .WriteLine("      ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolBridgeC")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUBridgeC")
            .WriteLine("    End")
            .WriteLine("    WallBoundsMesh = P2")
            .WriteLine("    RampMesh1 = P1")
            .WriteLine("    RampMesh2 = P3")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:Bridge")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = IMMOBILE STRUCTURE WALK_ON_TOP_OF_WALL UNATTACKABLE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ImmortalBody ModuleTag_03")
            .WriteLine("	MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 35.0")
            .WriteLine("  GeometryHeight        = 120.0")
            .WriteLine("    GeometryOffset		= X:0 Y:130 Z:0")
            .WriteLine("    ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 35.0")
            .WriteLine("  GeometryHeight        = 120.0")
            .WriteLine("    GeometryOffset		= X:0 Y:-130 Z:0")
            .WriteLine("    ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 100.0")
            .WriteLine("  GeometryHeight        = 0.0")
            .WriteLine("  GeometryOffset		= X:0 Y:0 Z:90")
            .WriteLine("      ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------------------")
            .WriteLine("Object MordorCirithUngolGateDoor")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("")
            .WriteLine("    DefaultModelConditionState  ")
            .WriteLine("      Model = MBCUGateDr")
            .WriteLine("    End")
            .WriteLine("        ")
            .WriteLine("	AnimationState = DOOR_1_OPENING")
            .WriteLine("		StateName = STATE_Open   ")
            .WriteLine("		Animation = Open ")
            .WriteLine("			AnimationName	=	MBCUGateDr.MBCUGateDr")
            .WriteLine("			AnimationMode	=	ONCE ")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("		BeginScript")
            .WriteLine("			Prev = CurDrawablePrevAnimationState()")
            .WriteLine("			if Prev == " & Chr(34) & "STATE_Closed" & Chr(34) & " then CurDrawableSetTransitionAnimState(" & Chr(34) & "TRANS_Closed_To_Open" & Chr(34) & ") end")
            .WriteLine("		EndScript")
            .WriteLine("    End")
            .WriteLine("    TransitionState = TRANS_Closed_To_Open")
            .WriteLine("		Animation = Open ")
            .WriteLine("			AnimationName	=	MBCUGateDr.MBCUGateDr")
            .WriteLine("			AnimationMode	=	ONCE ")
            .WriteLine("		End")
            .WriteLine("    End")
            .WriteLine("        ")
            .WriteLine("	AnimationState = DOOR_1_CLOSING ")
            .WriteLine("		StateName = STATE_Closed ")
            .WriteLine("		Animation = Close ")
            .WriteLine("			AnimationName	=	MBCUGateDr.MBCUGateDr")
            .WriteLine("			AnimationMode	=	ONCE_BACKWARDS ")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_FIRST")
            .WriteLine("		BeginScript")
            .WriteLine("			Prev = CurDrawablePrevAnimationState()")
            .WriteLine("			if Prev == " & Chr(34) & "STATE_Open" & Chr(34) & " then CurDrawableSetTransitionAnimState(" & Chr(34) & "TRANS_Open_To_Closed" & Chr(34) & ") end")
            .WriteLine("		EndScript")
            .WriteLine("    End")
            .WriteLine("    TransitionState = TRANS_Open_To_Closed")
            .WriteLine("		Animation = Open ")
            .WriteLine("			AnimationName	=	MBCUGateDr.MBCUGateDr")
            .WriteLine("			AnimationMode	=	ONCE_BACKWARDS ")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	VoiceSelect		= GateSelect")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("")
            .WriteLine("  DisplayName      = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine("  VisionRange         = 1600.0          ; Shroud clearing distance")
            .WriteLine("")
            .WriteLine("  ArmorSet")
            .WriteLine("    Conditions        = None")
            .WriteLine("    Armor             = HelmsDeepGates")
            .WriteLine("    DamageFX          = None")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("	CommandSet = CastleGateCommandSet")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("	; *** ENGINEERING Parameters ***  ")
            .WriteLine("	KindOf                = STRUCTURE IMMOBILE SELECTABLE BLOCKING_GATE ")
            .WriteLine("	RadarPriority = STRUCTURE")
            .WriteLine("	Body                  = ActiveBody ModuleTag_02")
            .WriteLine("		MaxHealth       = 2000.0")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("  	; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("  	; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("  	; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("  	Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("  		DestructionDelay  = 2100")
            .WriteLine("  	End")
            .WriteLine("")
            .WriteLine("	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior")
            .WriteLine("		MaxUpdateRangeCap = 800")
            .WriteLine(";		AnimationSound = Sound: MinisTirithGateDie Animation:GBMgatedoorSKL.GBMgatedoorA3 Frames: 1 ")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	Behavior = GateOpenAndCloseBehavior ModuleTag_GATE")
            .WriteLine("		ResetTimeInMilliseconds = 12200 ; important! this must be longer than the gates animation, ir it will twitch")
            .WriteLine("		OpenByDefault = Yes")
            .WriteLine("		PercentOpenForPathing = 50")
            .WriteLine("		SoundOpeningGateLoop = GateOpenStart")
            .WriteLine("		SoundClosingGateLoop = GateCloseStart")
            .WriteLine("		SoundFinishedOpeningGate = GateOpenEnd")
            .WriteLine("		SoundFinishedClosingGate = GateCloseEnd")
            .WriteLine("		TimeBeforePlayingOpenSound = 9500")
            .WriteLine("		TimeBeforePlayingClosedSound = 9500")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("	Geometry              = BOX")
            .WriteLine("	GeometryMajorRadius   = 14.0")
            .WriteLine("	GeometryMinorRadius   = 57.0")
            .WriteLine("	GeometryHeight        = 74.0")
            .WriteLine("	GeometryName          = Closed")
            .WriteLine("	GeometryIsSmall       = No")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("	AdditionalGeometry    = BOX")
            .WriteLine("	GeometryMajorRadius   = 14.0")
            .WriteLine("	GeometryMinorRadius   = 1.0")
            .WriteLine("	GeometryHeight        = 62.0	")
            .WriteLine("	GeometryOffset		  = X:8 Y:29 Z:0")
            .WriteLine("	GeometryName          = OpenLeft")
            .WriteLine("	")
            .WriteLine("	AdditionalGeometry    = BOX")
            .WriteLine("	GeometryMajorRadius   = 14.0")
            .WriteLine("	GeometryMinorRadius   = 1.0")
            .WriteLine("	GeometryHeight        = 62.0	")
            .WriteLine("	GeometryOffset		  = X:8 Y:-29 Z:0")
            .WriteLine("	GeometryName          = OpenRight")
            .WriteLine("	")
            .WriteLine("	GeometryContactPoint = X:15 Y:-29 Z:0 Ram ")
            .WriteLine("    GeometryContactPoint = X:7 Y:-29 Z:60")
            .WriteLine("	GeometryContactPoint = X:0  Y:-29 Z:0")
            .WriteLine("	GeometryContactPoint = X:0  Y:-14 Z:60")
            .WriteLine("	GeometryContactPoint = X:0  Y:  0 Z:1 Ram")
            .WriteLine("	GeometryContactPoint = X:0  Y: 14 Z:60")
            .WriteLine("	GeometryContactPoint = X:0  Y: 29 Z:0")
            .WriteLine("	GeometryContactPoint = X:7 Y: 29 Z:60")
            .WriteLine("	GeometryContactPoint = X:15 Y: 29 Z:0 Ram  ")
            .WriteLine("")
            .WriteLine("	Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolStairA")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("        RampMesh1 = P2")
            .WriteLine("")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUStairA")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE ")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE STRUCTURE WALK_ON_TOP_OF_WALL")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 32.5")
            .WriteLine("  GeometryMinorRadius   = 60.0")
            .WriteLine("  GeometryHeight        = 170.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolStairB")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P2")
            .WriteLine("        RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUStairB")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE STRUCTURE WALK_ON_TOP_OF_WALL")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 78.5")
            .WriteLine("  GeometryHeight        = 191.0")
            .WriteLine("  GeometryOffset		= X:0 Y:0 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 41.0")
            .WriteLine("  GeometryHeight        = 212.0")
            .WriteLine("  GeometryOffset		= X:0 Y:37.5 Z:0")
            .WriteLine("      ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolStairC")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P2")
            .WriteLine("        RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUStairC")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 80.5")
            .WriteLine("  GeometryMinorRadius   = 37.5")
            .WriteLine("  GeometryHeight        = 140.0")
            .WriteLine("  GeometryOffset		= X:0 Y:0 Z:0")
            .WriteLine("      ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 80.5")
            .WriteLine("  GeometryHeight        = 160.0")
            .WriteLine("  GeometryOffset		= X:43 Y:0 Z:0")
            .WriteLine("  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolStairD")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P2")
            .WriteLine("        RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUStairD")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine(";  Geometry              = BOX")
            .WriteLine(";  GeometryMajorRadius   = 37.5")
            .WriteLine(";  GeometryMinorRadius   = 80.0")
            .WriteLine(";  GeometryHeight        = 190.0")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 78.5")
            .WriteLine("  GeometryHeight        = 191.0")
            .WriteLine("  GeometryOffset		= X:0 Y:0 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 41.0")
            .WriteLine("  GeometryHeight        = 212.0")
            .WriteLine("  GeometryOffset		= X:0 Y:37.5 Z:0")
            .WriteLine("  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolTowerA")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("    ;    WallBoundsMesh = P2w")
            .WriteLine("    ;    RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUTowerA")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("    ;AlphaCameraFadeOuterRadius = 400")
            .WriteLine("	;AlphaCameraFadeInnerRadius = 300")
            .WriteLine("	;AlphaCameraAtInnerRadius = 15%")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE CASTLE_KEEP ;WALK_ON_TOP_OF_WALL")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine(";  Geometry              = BOX")
            .WriteLine(";  GeometryMajorRadius   = 35.0")
            .WriteLine(";  GeometryMinorRadius   = 165.0")
            .WriteLine(";  GeometryHeight        = 190.0")
            .WriteLine("")
            .WriteLine("  Geometry              = CYLINDER")
            .WriteLine("  GeometryMajorRadius   = 66.0")
            .WriteLine("  GeometryMinorRadius   = 0")
            .WriteLine("  GeometryHeight        = 466.0")
            .WriteLine("  GeometryOffset		= X:0 Y:0 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = CYLINDER")
            .WriteLine("  GeometryMajorRadius   = 114.0")
            .WriteLine("  GeometryMinorRadius   = 0")
            .WriteLine("  GeometryHeight        = 187.0")
            .WriteLine("  GeometryOffset		= X:-18 Y:0 Z:0")
            .WriteLine("")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolTowerB")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P2w")
            .WriteLine("        RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUTowerB")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 35.0")
            .WriteLine("  GeometryMinorRadius   = 65.0")
            .WriteLine("  GeometryHeight        = 190.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolTowerC")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine(" ;       WallBoundsMesh = P2W")
            .WriteLine(" ;       RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUTowerC")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE  STRUCTURE ;WALK_ON_TOP_OF_WALL")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("	  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 35.0")
            .WriteLine("  GeometryMinorRadius   = 65.0")
            .WriteLine("  GeometryHeight        = 190.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallA")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ; RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLA")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL  STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 75.0")
            .WriteLine("  GeometryHeight        = 169.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallC")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("         WallBoundsMesh = P1")
            .WriteLine("       ; RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLC")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE ")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("	MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 20.0")
            .WriteLine("  GeometryMinorRadius   = 42.0")
            .WriteLine("  GeometryHeight        = 169.0")
            .WriteLine("  GeometryOffset		= X:-32 Y:0 Z:0")
            .WriteLine("")
            .WriteLine("  AdditionalGeometry	= CYLINDER")
            .WriteLine("  GeometryMajorRadius	= 32.0")
            .WriteLine("  GeometryMinorRadius	= 0")
            .WriteLine("  GeometryHeight		= 169.0")
            .WriteLine("  GeometryOffset		= X:0 Y:0 Z:0")
            .WriteLine("  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallD")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("		;WallBoundsMesh = P2")
            .WriteLine("		RampMesh1 = P1")
            .WriteLine("		RampMesh2 = P3")
            .WriteLine("		RaisedWallMesh = P2")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLD")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("	End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE ")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 60.0")
            .WriteLine("  GeometryMinorRadius   = 40.0")
            .WriteLine("  GeometryHeight        = 180.0")
            .WriteLine("  GeometryOffset		= X:0 Y:-80 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 60.0")
            .WriteLine("  GeometryMinorRadius   = 40.0")
            .WriteLine("  GeometryHeight        = 180.0")
            .WriteLine("  GeometryOffset		= X:0 Y:80 Z:0")
            .WriteLine("    ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallE")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("       WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLE")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("       ")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE ")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 57.5")
            .WriteLine("  GeometryMinorRadius   = 130.0")
            .WriteLine("  GeometryHeight        = 160.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallG")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("		WallBoundsMesh = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLG")
            .WriteLine("    End")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 35.0")
            .WriteLine("  GeometryMinorRadius   = 30.0")
            .WriteLine("  GeometryHeight        = 160.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallJ")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("       WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLJ")
            .WriteLine("    End")
            .WriteLine("       ")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE ")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** AUDIO Parameters ***")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 50.0")
            .WriteLine("  GeometryMinorRadius   = 80.0")
            .WriteLine("  GeometryHeight        = 160.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallK")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLK")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE ")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 50.0")
            .WriteLine("  GeometryMinorRadius   = 80.0")
            .WriteLine("  GeometryHeight        = 160.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallN")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLN")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 80.0")
            .WriteLine("  GeometryHeight        = 160.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallQ")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLQ")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 50.0")
            .WriteLine("  GeometryMinorRadius   = 90.0")
            .WriteLine("  GeometryHeight        = 100.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallR")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLR")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 57.5")
            .WriteLine("  GeometryMinorRadius   = 80.0")
            .WriteLine("  GeometryHeight        = 100.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallS")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLS")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 125.0")
            .WriteLine("  GeometryHeight        = 111.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallT")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLT")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 37.5")
            .WriteLine("  GeometryMinorRadius   = 125.0")
            .WriteLine("  GeometryHeight        = 115.0")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Mordor Cirith Ungol")
            .WriteLine("Object MordorCirithUngolWallU")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = MBCUWALLU")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:CirithUngol")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION CIRITH_UNGOL STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = NOT_ON_RADAR")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 30.0")
            .WriteLine("  GeometryMinorRadius   = 35.0")
            .WriteLine("  GeometryHeight        = 111.0")
            .WriteLine("  GeometryOffset		= X:0 Y:0 Z:0")
            .WriteLine("  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Lothlorien")
            .WriteLine("Object LothlorienBridge")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    ")
            .WriteLine("    StaticModelLODMode = yes ")
            .WriteLine("    ")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = LBBRIDGE")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:LBBRIDGE")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION LOTHLORIEN STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("	Geometry              = BOX")
            .WriteLine("	GeometryMajorRadius   = 120.0")
            .WriteLine("	GeometryMinorRadius   = 60.0")
            .WriteLine("	GeometryHeight        = 32.6")
            .WriteLine("	")
            .WriteLine("	GeometryIsSmall       = No")
            .WriteLine("	Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Lothlorien")
            .WriteLine("Object LothlorienTreeHouse1")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    ")
            .WriteLine("    StaticModelLODMode = yes ")
            .WriteLine("    ")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = LBTREEHOUSE1")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("	AlphaCameraFadeOuterRadius = 300")
            .WriteLine("	AlphaCameraFadeInnerRadius = 150")
            .WriteLine("	AlphaCameraAtInnerRadius = 10%    ")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:LBTREEHOUSE")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION LOTHLORIEN STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 47.8")
            .WriteLine("  GeometryMinorRadius   = 46.8")
            .WriteLine("  GeometryHeight        = 141.8")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine(";Lothlorien")
            .WriteLine("Object LothlorienTreeHouse2")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    ")
            .WriteLine("    StaticModelLODMode = yes ")
            .WriteLine("    ")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = LBTREEHOUSE2")
            .WriteLine("    End")
            .WriteLine("    ")
            .WriteLine("	AlphaCameraFadeOuterRadius = 300")
            .WriteLine("	AlphaCameraFadeInnerRadius = 150")
            .WriteLine("	AlphaCameraAtInnerRadius = 10%    ")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:LBTREEHOUSE")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("  Browser = REGION LOTHLORIEN STRUCTURE")
            .WriteLine("  ThreatLevel = 1.0")
            .WriteLine("  CommandSet			= GenericKeepCommandSet")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("; KindOf          = SELECTABLE IMMOBILE STRUCTURE CASTLE_KEEP")
            .WriteLine("  KindOf          = STRUCTURE SELECTABLE IMMOBILE CASTLE_KEEP FS_FACTORY AUTO_RALLYPOINT ")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Behavior            = GettingBuiltBehavior ModuleTag_04")
            .WriteLine("    SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker")
            .WriteLine("	SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound")
            .WriteLine("	SelfRepairFromRubbleLoop  = BuildingConstructionLoop")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Behavior = CastleMemberBehavior ModuleTag_CMB")
            .WriteLine("  End ")
            .WriteLine("")
            .WriteLine("  	;-----------------------------------------------")
            .WriteLine("	;Used for hero revival and initial construction     ")
            .WriteLine("	Behavior = ProductionUpdate ProductionUpdateModuleTag")
            .WriteLine("		; nothing, but is required if we have any Object-level Upgrades!")
            .WriteLine("	End")
            .WriteLine("	Behavior = QueueProductionExitUpdate ModuleTag_QueuePEU")
            .WriteLine("		UnitCreatePoint   = X:0.0 Y:-20.0 Z:0.0")
            .WriteLine("		NaturalRallyPoint = X:28.8 Y:-80.0 Z:0.0;NaturalRallyPointX must always match GeometryMajorRadius! -ML")
            .WriteLine("		ExitDelay = 300 ;Handles delays between units if multiple produced at a time. (like Generals Redguard coming out 2 at a time)")
            .WriteLine("	End  ")
            .WriteLine("	;-----------------------------------------------")
            .WriteLine("")
            .WriteLine(";  Geometry              = BOX")
            .WriteLine(";  GeometryMajorRadius   = 30.0")
            .WriteLine(";  GeometryMinorRadius   = 35.0")
            .WriteLine(";  GeometryHeight        = 55.0")
            .WriteLine(";  GeometryOffset		= X:0 Y:0 Z:0")
            .WriteLine(";  GeometryActive		= no")
            .WriteLine("  ")
            .WriteLine("  Geometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 110.0")
            .WriteLine("  GeometryMinorRadius   = 70.0")
            .WriteLine("  GeometryHeight        = 145.0")
            .WriteLine("  GeometryOffset		= X:46 Y:35 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 70.0")
            .WriteLine("  GeometryMinorRadius   = 75.0")
            .WriteLine("  GeometryHeight        = 299.0")
            .WriteLine("  GeometryOffset		= X:0 Y:35 Z:0")
            .WriteLine("  ")
            .WriteLine("  AdditionalGeometry    = BOX")
            .WriteLine("  GeometryMajorRadius   = 40.0")
            .WriteLine("  GeometryMinorRadius   = 25.0")
            .WriteLine("  GeometryHeight        = 155.0")
            .WriteLine("  GeometryOffset		= X:-47 Y:-110 Z:0")
            .WriteLine("  ")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("Object GenericRockBridge")
            .WriteLine("")
            .WriteLine("	; *** ART Parameters ***")
            .WriteLine("		Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("			OkToChangeModelColor = Yes")
            .WriteLine("			DefaultModelConditionState")
            .WriteLine("				Model = NBRockBrdge")
            .WriteLine("			End")
            .WriteLine("		")
            .WriteLine("		    WallBoundsMesh	= P2")
            .WriteLine("		    RampMesh1		= P1")
            .WriteLine("		    RampMesh2		= P3		    ")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("	; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	; ***DESIGN parameters ***")
            .WriteLine("		DisplayName      = OBJECT:Bridge")
            .WriteLine("		EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("		ArmorSet")
            .WriteLine("			Conditions        = None")
            .WriteLine("			Armor             = NoArmor")
            .WriteLine("			DamageFX          = None")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("	; *** ENGINEERING Parameters ***  ")
            .WriteLine("		KindOf                = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL CHUNK_VENDOR  NOT_AUTOACQUIRABLE")
            .WriteLine("		RadarPriority		= STRUCTURE")
            .WriteLine("		Body                  = InactiveBody ModuleTag_03")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("		; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("		; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("		; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("		Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 4000")
            .WriteLine("		End")
            .WriteLine("		  ")
            .WriteLine("  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus")
            .WriteLine("		StartsActive	= Yes ;If no, requires upgrade to turn on.")
            .WriteLine("		BonusName		= WallBonus")
            .WriteLine("		RefreshDelay	= 2000")
            .WriteLine("		;Range			= 120		; Range is overridden to affect people on us since we are a wall")
            .WriteLine("		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall")
            .WriteLine("	End	")
            .WriteLine("")
            .WriteLine("		Geometry              = BOX")
            .WriteLine("		GeometryMajorRadius   = 76.0")
            .WriteLine("		GeometryMinorRadius   = 150.0")
            .WriteLine("		GeometryHeight        = 65.6")
            .WriteLine("		GeometryIsSmall       = No")
            .WriteLine("		;GeometryRotationAnchorOffset = X:1037.871 Y:0")
            .WriteLine("		")
            .WriteLine("		GeometryContactPoint			= X:40		Y: -120		Z:60 Grab")
            .WriteLine("		GeometryContactPoint			= X:40		Y: 0		Z:70 Grab")
            .WriteLine("		GeometryContactPoint			= X:40		Y: 120		Z:60 Grab ")
            .WriteLine("		GeometryContactPoint			= X:-40		Y: 120		Z:60 Grab")
            .WriteLine("		GeometryContactPoint			= X:-40		Y: 0		Z:70 Grab")
            .WriteLine("		GeometryContactPoint			= X:-40		Y: -120		Z:60 Grab")
            .WriteLine("		")
            .WriteLine("		")
            .WriteLine("		Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine("Object GenericTreeBridge")
            .WriteLine("")
            .WriteLine("	; *** ART Parameters ***")
            .WriteLine("		Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("			OkToChangeModelColor = Yes")
            .WriteLine("			DefaultModelConditionState")
            .WriteLine("				Model = NBTreeBrdge")
            .WriteLine("			End")
            .WriteLine("		")
            .WriteLine("		    WallBoundsMesh	= P2")
            .WriteLine("		    RampMesh1		= P1")
            .WriteLine("		    RampMesh2		= P3		    ")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("	; *** AUDIO Parameters ***")
            .WriteLine("")
            .WriteLine("	; ***DESIGN parameters ***")
            .WriteLine("		DisplayName      = OBJECT:Bridge")
            .WriteLine("		EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine("		ArmorSet")
            .WriteLine("			Conditions        = None")
            .WriteLine("			Armor             = NoArmor")
            .WriteLine("			DamageFX          = None")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("	; *** ENGINEERING Parameters ***  ")
            .WriteLine("		KindOf                = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL CHUNK_VENDOR  NOT_AUTOACQUIRABLE")
            .WriteLine("		RadarPriority		= STRUCTURE")
            .WriteLine("		Body                  = InactiveBody ModuleTag_03")
            .WriteLine("		End")
            .WriteLine("")
            .WriteLine("		; Note that structures with " & Chr(34) & "RUBBLE" & Chr(34) & " states should not use DestroyDie; such buildings are ")
            .WriteLine("		; never truly destroyed, even when reduced to zero health. Also note that garrisonable")
            .WriteLine("		; buildings automatically stick around because GarrisonContain has it's own DieModule")
            .WriteLine("		Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble")
            .WriteLine("      DestructionDelay  = 4000")
            .WriteLine("		End")
            .WriteLine("		  ")
            .WriteLine("  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus")
            .WriteLine("		StartsActive	= Yes ;If no, requires upgrade to turn on.")
            .WriteLine("		BonusName		= WallBonus")
            .WriteLine("		RefreshDelay	= 2000")
            .WriteLine("		;Range			= 120		; Range is overridden to affect people on us since we are a wall")
            .WriteLine("		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall")
            .WriteLine("	End	")
            .WriteLine("")
            .WriteLine("		Geometry              = BOX")
            .WriteLine("		GeometryMajorRadius   = 76.0")
            .WriteLine("		GeometryMinorRadius   = 150.0")
            .WriteLine("		GeometryHeight        = 65.6")
            .WriteLine("		GeometryIsSmall       = No")
            .WriteLine("		;GeometryRotationAnchorOffset = X:1037.871 Y:0")
            .WriteLine("		Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine(";Gondor")
            .WriteLine("Object GondorWoodDock")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBWoodDock")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:Dock")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = SELECTABLE IMMOBILE STRUCTURE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = ActiveBody ModuleTag_03")
            .WriteLine("  MaxHealth       = 99999.0")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 20.9")
            .WriteLine("  GeometryMinorRadius   = 60.4")
            .WriteLine("  GeometryHeight        = 25.4")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------")
            .WriteLine(";Gondor")
            .WriteLine("Object GondorStoneDock")
            .WriteLine("  ")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_Draw")
            .WriteLine("    OkToChangeModelColor  = Yes")
            .WriteLine("    UseStandardModelNames = Yes")
            .WriteLine("        WallBoundsMesh = P1")
            .WriteLine("       ;RampMesh1 = P1")
            .WriteLine("    DefaultModelConditionState")
            .WriteLine("      Model = GBStoneDock")
            .WriteLine("    End")
            .WriteLine("")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  ; *** AUDIO Parameters *** ")
            .WriteLine(" ")
            .WriteLine("  ; ***DESIGN parameters ***")
            .WriteLine("  DisplayName     = OBJECT:Dock")
            .WriteLine("  EditorSorting   = STRUCTURE")
            .WriteLine("")
            .WriteLine(" ")
            .WriteLine("  ; *** ENGINEERING Parameters ***")
            .WriteLine("  RadarPriority       = STRUCTURE")
            .WriteLine("  ")
            .WriteLine("  ; *** ENGINEERING Parameters ***  ")
            .WriteLine("  KindOf          = IMMOBILE STRUCTURE UNATTACKABLE")
            .WriteLine("  Shadow          = SHADOW_VOLUME")
            .WriteLine("  Body            = InactiveBody ModuleTag_03")
            .WriteLine("  End")
            .WriteLine("")
            .WriteLine("  Geometry              = BOX")
            .WriteLine("  GeometryMajorRadius   = 31.8")
            .WriteLine("  GeometryMinorRadius   = 120.8")
            .WriteLine("  GeometryHeight        = 57.8")
            .WriteLine("  GeometryIsSmall       = No")
            .WriteLine("  Shadow                = SHADOW_VOLUME")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";-------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject CampNoFlag_NE CampFlagNE")
            .WriteLine("")
            .WriteLine(";SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = AICamp_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";-------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject CampNoFlag_NW CampFlagNW")
            .WriteLine("")
            .WriteLine(";SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = AICamp_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";-------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject CampNoFlag_SE CampFlagSE")
            .WriteLine("")
            .WriteLine(";SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = AICamp_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine(";-------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject CampNoFlag_SW CampFlagSW")
            .WriteLine("")
            .WriteLine(";SelectPortrait = BPCCamp")
            .WriteLine("")
            .WriteLine("  ; *** ART Parameters ***")
            .WriteLine("  Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    	    OkToChangeModelColor  = Yes")
            .WriteLine("   	DefaultModelConditionState")
            .WriteLine("   		Model = AICamp_SKN")
            .WriteLine(";                    ParticleSysBone   = glowbone01 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone02 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone03 TorchGlow FollowBone:Yes")
            .WriteLine(";                    ParticleSysBone   = glowbone04 TorchGlow FollowBone:Yes")
            .WriteLine("   	End")
            .WriteLine("	ModelConditionState = WORLD_BUILDER")
            .WriteLine("		Model = Camp_Flag")
            .WriteLine("	End")
            .WriteLine("    IdleAnimationState")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("    End    ")
            .WriteLine("	AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 0")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End	    ")
            .WriteLine("	AnimationState = UNPACKING")
            .WriteLine("		Animation")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("			AnimationMode = ONCE")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("		Flags = START_FRAME_LAST")
            .WriteLine("	End")
            .WriteLine("	AnimationState = PACKING")
            .WriteLine("		Animation = flag")
            .WriteLine("			AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("			AnimationMode = LOOP")
            .WriteLine("			AnimationBlendTime = 90")
            .WriteLine("		End")
            .WriteLine("	End	    ")
            .WriteLine("  End")
            .WriteLine("End")
            .WriteLine("")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject PreBuiltCampNoFlag_01 PreBuiltCampFlag_01")
            .WriteLine("")
            .WriteLine("	; *** ART Parameters ***")
            .WriteLine("	Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    			OkToChangeModelColor  = Yes")
            .WriteLine("   		DefaultModelConditionState")
            .WriteLine("   			Model = AICamp_SKN")
            .WriteLine("   		End")
            .WriteLine("		ModelConditionState = WORLD_BUILDER")
            .WriteLine("			Model = Camp_Flag")
            .WriteLine("		End")
            .WriteLine("		IdleAnimationState")
            .WriteLine("			Animation = flag")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationBlendTime = 90")
            .WriteLine("			End")
            .WriteLine("		End    ")
            .WriteLine("		AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("			Animation = flag")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationBlendTime = 0")
            .WriteLine("			End")
            .WriteLine("			Flags = START_FRAME_LAST")
            .WriteLine("		End	    ")
            .WriteLine("		AnimationState = UNPACKING")
            .WriteLine("			Animation")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationBlendTime = 90")
            .WriteLine("			End")
            .WriteLine("			Flags = START_FRAME_LAST")
            .WriteLine("		End")
            .WriteLine("		AnimationState = PACKING")
            .WriteLine("			Animation = flag")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("				AnimationMode = LOOP")
            .WriteLine("				AnimationBlendTime = 90")
            .WriteLine("			End")
            .WriteLine("		End	    ")
            .WriteLine("	End")
            .WriteLine("End	")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject PreBuiltCampNoFlag_02 PreBuiltCampFlag_02")
            .WriteLine("")
            .WriteLine("	; *** ART Parameters ***")
            .WriteLine("	Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    			OkToChangeModelColor  = Yes")
            .WriteLine("   		DefaultModelConditionState")
            .WriteLine("   			Model = AICamp_SKN")
            .WriteLine("   		End")
            .WriteLine("		ModelConditionState = WORLD_BUILDER")
            .WriteLine("			Model = Camp_Flag")
            .WriteLine("		End")
            .WriteLine("		IdleAnimationState")
            .WriteLine("			Animation = flag")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationBlendTime = 90")
            .WriteLine("			End")
            .WriteLine("		End    ")
            .WriteLine("		AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("			Animation = flag")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationBlendTime = 0")
            .WriteLine("			End")
            .WriteLine("			Flags = START_FRAME_LAST")
            .WriteLine("		End	    ")
            .WriteLine("		AnimationState = UNPACKING")
            .WriteLine("			Animation")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationBlendTime = 90")
            .WriteLine("			End")
            .WriteLine("			Flags = START_FRAME_LAST")
            .WriteLine("		End")
            .WriteLine("		AnimationState = PACKING")
            .WriteLine("			Animation = flag")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("				AnimationMode = LOOP")
            .WriteLine("				AnimationBlendTime = 90")
            .WriteLine("			End")
            .WriteLine("		End	    ")
            .WriteLine("	End")
            .WriteLine("End	")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject PreBuiltCampNoFlag_03 PreBuiltCampFlag_03")
            .WriteLine("")
            .WriteLine("	; *** ART Parameters ***")
            .WriteLine("	Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    			OkToChangeModelColor  = Yes")
            .WriteLine("   		DefaultModelConditionState")
            .WriteLine("   			Model = AICamp_SKN")
            .WriteLine("   		End")
            .WriteLine("		ModelConditionState = WORLD_BUILDER")
            .WriteLine("			Model = Camp_Flag")
            .WriteLine("		End")
            .WriteLine("		IdleAnimationState")
            .WriteLine("			Animation = flag")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationBlendTime = 90")
            .WriteLine("			End")
            .WriteLine("		End    ")
            .WriteLine("		AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("			Animation = flag")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationBlendTime = 0")
            .WriteLine("			End")
            .WriteLine("			Flags = START_FRAME_LAST")
            .WriteLine("		End	    ")
            .WriteLine("		AnimationState = UNPACKING")
            .WriteLine("			Animation")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationBlendTime = 90")
            .WriteLine("			End")
            .WriteLine("			Flags = START_FRAME_LAST")
            .WriteLine("		End")
            .WriteLine("		AnimationState = PACKING")
            .WriteLine("			Animation = flag")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("				AnimationMode = LOOP")
            .WriteLine("				AnimationBlendTime = 90")
            .WriteLine("			End")
            .WriteLine("		End	    ")
            .WriteLine("	End")
            .WriteLine("End	")
            .WriteLine("")
            .WriteLine(";------------------------------------------------------------------------------")
            .WriteLine("")
            .WriteLine("ChildObject PreBuiltCampNoFlag_04 PreBuiltCampFlag_04")
            .WriteLine("")
            .WriteLine("	; *** ART Parameters ***")
            .WriteLine("	Draw = W3DScriptedModelDraw ModuleTag_01")
            .WriteLine("    			OkToChangeModelColor  = Yes")
            .WriteLine("   		DefaultModelConditionState")
            .WriteLine("   			Model = AICamp_SKN")
            .WriteLine("   		End")
            .WriteLine("		ModelConditionState = WORLD_BUILDER")
            .WriteLine("			Model = Camp_Flag")
            .WriteLine("		End")
            .WriteLine("		IdleAnimationState")
            .WriteLine("			Animation = flag")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationBlendTime = 90")
            .WriteLine("			End")
            .WriteLine("		End    ")
            .WriteLine("		AnimationState = JUST_BUILT ; for instant-build")
            .WriteLine("			Animation = flag")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationBlendTime = 0")
            .WriteLine("			End")
            .WriteLine("			Flags = START_FRAME_LAST")
            .WriteLine("		End	    ")
            .WriteLine("		AnimationState = UNPACKING")
            .WriteLine("			Animation")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_A")
            .WriteLine("				AnimationMode = ONCE")
            .WriteLine("				AnimationBlendTime = 90")
            .WriteLine("			End")
            .WriteLine("			Flags = START_FRAME_LAST")
            .WriteLine("		End")
            .WriteLine("		AnimationState = PACKING")
            .WriteLine("			Animation = flag")
            .WriteLine("				AnimationName = NCampsite_SKL.NCampsite_IDLA")
            .WriteLine("				AnimationMode = LOOP")
            .WriteLine("				AnimationBlendTime = 90")
            .WriteLine("			End")
            .WriteLine("		End	    ")
            .WriteLine("	End")
            .WriteLine("End	")
            .WriteLine("")
        End With
        swCBINIFILE.Close()
        End If
    End Sub
    Sub LoadFile(ByVal str As String)
        Dim sr As IO.StreamReader = IO.File.OpenText(str)
        Dim NumberOfFactionsToSeek As String = sr.ReadLine
        Dim line As String
        NumberOfFactionsToSeek = CInt(NumberOfFactionsToSeek.Substring(NumberOfFactionsToSeek.IndexOf(" ") + 1))
        sr.ReadLine()
        For TimesToLoop As Integer = 1 To NumberOfFactionsToSeek
            Try
                FactNum += 1
                Fact(FactNum) = New Faction(FactNum, "", "", "", "", "", Color.Blue, "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", True, True)
                i = FactNum
                sr.ReadLine() 'blank line
                line = sr.ReadLine
                Fact(i).AllyDeathScaleFactor = CDbl(line.Substring(line.IndexOf(" ") + 1))
                line = sr.ReadLine
                Fact(i).BuildableHerosMP = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).CreateCB = CType(line.Substring(line.IndexOf(" ") + 1), Boolean)
                line = sr.ReadLine
                Fact(i).CreateFaction = CType(line.Substring(line.IndexOf(" ") + 1), Boolean)
                line = sr.ReadLine
                Fact(i).DefaultPlayerAIType = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).EnemyKillScaleFactor = CDbl(line.Substring(line.IndexOf(" ") + 1))
                line = sr.ReadLine
                Fact(i).Evil = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).FactionName = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).FactionsArmiesName = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).FactionsDisplayedName = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).FactionsUpgradeText = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).InitialUpgrades = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).IntrinsicSciences = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).IsGrantable = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).LightPointsSound = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).MajorUnitValue = CDbl(line.Substring(line.IndexOf(" ") + 1))
                line = sr.ReadLine
                Fact(i).MapToCellVictoryRatio = CDbl(line.Substring(line.IndexOf(" ") + 1))
                line = sr.ReadLine
                Fact(i).ObjectiveAddedSound = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).ObjectiveCompleteSound = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).PlayableSide = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).PreferredColor = Color.FromArgb(255, CInt(line.Substring(line.IndexOf("R:") + 2, line.IndexOf("G:") - line.IndexOf("R:") - 2)), CInt(line.Substring(line.IndexOf("G:") + 2, line.IndexOf("B:") - line.IndexOf("G:") - 2)), CInt(line.Substring(line.IndexOf("B:") + 2)))
                line = sr.ReadLine
                Fact(i).ScienceCommandSet = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).Side = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).SpellBook = line.Substring(line.IndexOf(" ") + 1)
                line = sr.ReadLine
                Fact(i).VictoryThreshhold = CDbl(line.Substring(line.IndexOf(" ") + 1))
            Catch ex As Exception
                MsgBox(ex.Message)
            End Try
            UpdateTextBoxes()
        Next
        sr.Close()
        MsgBox(NumberOfFactionsToSeek & " Factions Loaded")
    End Sub
    Sub SaveFile(ByVal str As String)
        Dim sw As IO.StreamWriter = IO.File.CreateText(str.Substring(str.LastIndexOf("\") + 1))
        Dim NumberOfFactionsToWrite As Integer
        For f As Integer = 0 To FactNum
            If Fact(f).CreateFaction = True Then
                NumberOfFactionsToWrite += 1
            End If
        Next
        sw.WriteLine("NumberOfFactionsToRead= " & NumberOfFactionsToWrite)
        sw.WriteLine(":ATTENTION DO NOT TAMPER WITH FILE UNLESS YOU KNOW HOW. KEEP ONE SPACE PER LINE, KEEP IN THIS ORDER.")
        For f As Integer = 0 To FactNum
            If Fact(f).CreateFaction = True Then
                sw.WriteLine("")
                sw.WriteLine("AllyDeathScaleFactor= " & Fact(f).AllyDeathScaleFactor)
                sw.WriteLine("BuildableHerosMP= " & Fact(f).BuildableHerosMP)
                sw.WriteLine("CreateInCivilianBuildings= " & Fact(f).CreateCB)
                sw.WriteLine("CreateFaction= " & Fact(f).CreateFaction)
                sw.WriteLine("DefaultPlayerAIType= " & Fact(f).DefaultPlayerAIType)
                sw.WriteLine("EnemyKillScaleFactor= " & Fact(f).EnemyKillScaleFactor)
                sw.WriteLine("Evil= " & Fact(f).Evil)
                sw.WriteLine("FactionName= " & Fact(f).FactionName)
                sw.WriteLine("FactionsArmiesName= " & Fact(f).FactionsArmiesName)
                sw.WriteLine("FactionsDisplayedName= " & Fact(f).FactionsDisplayedName)
                sw.WriteLine("FactionsUpgradeText= " & Fact(f).FactionsUpgradeText)
                sw.WriteLine("InitialUpgrades= " & Fact(f).InitialUpgrades)
                sw.WriteLine("IntrinsicSciences= " & Fact(f).IntrinsicSciences)
                sw.WriteLine("IsGrantable= " & Fact(f).IsGrantable)
                sw.WriteLine("LightPointsSound= " & Fact(f).LightPointsSound)
                sw.WriteLine("MajorUnitValue= " & Fact(f).MajorUnitValue)
                sw.WriteLine("MapToCellVictoryRatio= " & Fact(f).MapToCellVictoryRatio)
                sw.WriteLine("ObjectiveAddedSound= " & Fact(f).ObjectiveAddedSound)
                sw.WriteLine("ObjectiveCompleteSound= " & Fact(f).ObjectiveCompleteSound)
                sw.WriteLine("PlayableSide= " & Fact(f).PlayableSide)
                sw.WriteLine("PreferredColor= " & "R:" & Fact(f).PreferredColor.R & "G:" & Fact(f).PreferredColor.G & "B:" & Fact(f).PreferredColor.B)
                sw.WriteLine("ScienceCommandSet= " & Fact(f).ScienceCommandSet)
                sw.WriteLine("Side= " & Fact(f).Side)
                sw.WriteLine("SpellBook= " & Fact(f).SpellBook)
                sw.WriteLine("VictoryThreshhold= " & Fact(f).VictoryThreshhold)
            End If
        Next
        sw.Close()
        MsgBox(NumberOfFactionsToWrite & " Factions Saved in " & str & " Located In This Programs Location")
    End Sub
    Sub OpenINIFile(ByVal FilePath As String)
        Dim sr As IO.StreamReader = IO.File.OpenText(FilePath)
        Dim line As String
        Dim line2 As String = "e"
        Dim InFaction As Boolean
        Do While sr.Peek <> -1
            line = sr.ReadLine.TrimStart.TrimEnd
            If line.ToLower.StartsWith("playertemplate") Then
                InFaction = True
                FactNum += 1
                Dim FactName As String = line.Substring(line.ToLower.IndexOf("faction") + 7)
                If FactName = "civilian" Or FactName = "observer" Or FactName = "neutral" Then
                    GoTo SkipFaction
                End If
                Fact(FactNum) = New Faction(FactNum, "", "", FactName, "", "", Nothing, "", "", "", "", "", "Gui_MissionObjectiveNew", "Gui_MissionObjectiveCompleted", "", "", "None", "No", "0", "", "", "", "1.0", "1.1", "200", "10.0", "0.8", True, True)
                Do While InFaction = True
                    line2 = sr.ReadLine.TrimStart.TrimEnd
                    If line2.ToLower.TrimStart.StartsWith("end") Then
                        InFaction = False
                        Exit Do
                    End If
                    If LineContains(line2.ToLower, ";") = True Then
                        line2 = line2.Substring(0, line2.IndexOf(";"))
                    End If
                    If line2.ToLower.StartsWith("side") Then
                        Dim str As String = line2.Substring(line2.IndexOf("=") + 1).TrimEnd.TrimStart
                        Fact(FactNum).Side = str
                        Fact(FactNum).FactionsArmiesName = str & " Army"
                        Fact(FactNum).FactionsDisplayedName = str
                        Fact(FactNum).FactionsUpgradeText = str
                    End If
                    If line2.ToLower.StartsWith("playableside") Then
                        Dim str As String = line2.Substring(line2.IndexOf("=") + 1).TrimEnd.TrimStart
                        Fact(FactNum).PlayableSide = str
                    End If
                    If line2.ToLower.StartsWith("startmoney") Then
                        Dim str As String = line2.Substring(line2.IndexOf("=") + 1).TrimEnd.TrimStart
                        Fact(FactNum).StartMoney = str
                    End If
                    If line2.ToLower.StartsWith("preferredcolor") Then
                        Dim R As String = line2.ToLower.Substring(line2.ToLower.LastIndexOf("r:") + 2, line2.ToLower.LastIndexOf("g:") - line2.ToLower.LastIndexOf("r:") - 2)
                        Dim G As String = line2.ToLower.Substring(line2.ToLower.LastIndexOf("g:") + 2, line2.ToLower.LastIndexOf("b:") - line2.ToLower.LastIndexOf("g:") - 2)
                        Dim B As String = line2.ToLower.Substring(line2.ToLower.LastIndexOf("b:") + 2)
                        Fact(FactNum).PreferredColor = Color.FromArgb(255, R, G, B)
                    End If

                    If line2.ToLower.StartsWith("intrinsicsciences ") Then
                        Dim str As String = line2.Substring(line2.IndexOf("=") + 1).TrimEnd.TrimStart
                        Fact(FactNum).IntrinsicSciences = str
                    End If
                    If line2.ToLower.StartsWith("evil") Then
                        Dim str As String = line2.Substring(line2.IndexOf("=") + 1).TrimEnd.TrimStart
                        Fact(FactNum).Evil = str
                        If str.tolower = "yes" Then
                            Fact(FactNum).EnemyKillScaleFactor = "1.1"
                            Fact(FactNum).MajorUnitValue = "10.0"
                            Fact(FactNum).MapToCellVictoryRatio = "0.8"
                            Fact(FactNum).VictoryThreshhold = "150"
                            Fact(FactNum).AllyDeathScaleFactor = "1.0"
                        ElseIf str.tolower = "no" Then
                            Fact(FactNum).EnemyKillScaleFactor = "1.1"
                            Fact(FactNum).MajorUnitValue = "10.0"
                            Fact(FactNum).MapToCellVictoryRatio = "0.8"
                            Fact(FactNum).VictoryThreshhold = "200"
                            Fact(FactNum).AllyDeathScaleFactor = "1.0"
                        End If
                    End If
                    If line2.ToLower.StartsWith("spellbook ") Then
                        Dim str As String = line2.Substring(line2.IndexOf("=") + 1).TrimEnd.TrimStart
                        Fact(FactNum).SpellBook = str
                    End If
                    If line2.ToLower.StartsWith("purchasesciencecommandset ") Then
                        Dim str As String = line2.Substring(line2.IndexOf("=") + 1).TrimEnd.TrimStart
                        Fact(FactNum).ScienceCommandSet = str
                    End If
                    If line2.ToLower.StartsWith("defaultplayeraitype") Then
                        Dim str As String = line2.Substring(line2.IndexOf("=") + 1).TrimEnd.TrimStart
                        Fact(FactNum).DefaultPlayerAIType = str
                    End If
                    If line2.ToLower.StartsWith("lightpointsupsound") Then
                        Dim str As String = line2.Substring(line.IndexOf("=") + 1).TrimEnd.TrimStart
                        Fact(FactNum).LightPointsSound = str
                    End If
                    If line2.ToLower.StartsWith("initialupgrades") Then
                        Dim str As String = line2.Substring(line2.IndexOf("=") + 1).TrimEnd.TrimStart
                        Fact(FactNum).InitialUpgrades = str
                        Dim InitialUpgrade As String = "upgrade_" & Fact(FactNum).Side.ToLower & "faction"
                        If str.TrimStart.ToLower.StartsWith(InitialUpgrade) Then
                            str = str.Substring(str.ToLower.IndexOf(InitialUpgrade) + InitialUpgrade.Length)
                            Fact(FactNum).InitialUpgrades = str
                        End If
                    End If
                    If line2.ToLower.StartsWith("buildableheroesmp") Then
                        Dim str As String = line2.Substring(line2.IndexOf("=") + 1).TrimEnd.TrimStart
                        Fact(FactNum).BuildableHerosMP = str
                    End If
                Loop
            End If
SkipFaction:
        Loop
        UpdateTextBoxes()
        UpdateList()
    End Sub
    Function LineContains(ByVal line As String, ByVal contains As String)
        For ii As Integer = 0 To line.Length - contains.Length
            If line.Substring(ii, contains.Length) = contains Then
                Return True
            End If
        Next
        Return False
    End Function
#End Region
#Region " MainPage "
    Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Fact(0) = New Faction(0, "Gondor", "Yes", "Gondor", "No", "0", Color.FromArgb(255, 43, 150, 179), "SCIENCE_GOOD", "GoodSpellBook", "GoodSpellStoreCommandSet", "GondorSkirmishAI", "GondorLightPointsUp", "Gui_MissionObjectiveNew", "Gui_MissionObjectiveCompleted", "GondorGandalf GondorBoromir GondorFaramir RohanPippin", "", "None", "No", "0", "Gondor", "Gondor Army", "Gondor", "1.0", "1.1", "200", "10.0", "0.8", False, True)
        Fact(1) = New Faction(1, "Rohan", "Yes", "Rohan", "No", "0", Color.FromArgb(255, 42, 190, 53), "SCIENCE_GOOD", "GoodSpellBook", "GoodSpellStoreCommandSet", "RohanSkirmishAI", "RohanLightPointsUp", "Gui_MissionObjectiveNew", "Gui_MissionObjectiveCompleted", "RohanTheoden RohanEomer RohanEowyn RohanGimli RohanLegolas GondorAragornMP RohanMerry", "Upgrade_RohanDualEconomyChoice", "None", "No", "0", "Rohan", "Rohan Army", "Rohan", "1.0", "1.1", "200", "10.0", "0.8", False, True)
        Fact(2) = New Faction(2, "Isengard", "Yes", "Isengard", "Yes", "0", Color.FromArgb(255, 216, 175, 48), "SCIENCE_EVIL", "EvilSpellBook", "EvilSpellStoreCommandSet", "IsengardSkirmishAI", "IsengardLightPointsUp", "Gui_MissionObjectiveNew", "Gui_MissionObjectiveCompleted", "IsengardSaruman IsengardLurtz", "Upgrade_IsengardDualEconomyChoice Upgrade_EvilDualEconomyChoice", "None", "No", "0", "Isengard", "Isengard Army", "Isengard", "1.0", "1.1", "150", "10.0", "0.8", False, True)
        Fact(3) = New Faction(3, "Mordor", "Yes", "Mordor", "Yes", "0", Color.FromArgb(255, 175, 49, 33), "SCIENCE_EVIL", "EvilSpellBook", "EvilSpellStoreCommandSet", "MordorSkirmishAI", "MordorLightPointsUp", "Gui_MissionObjectiveNew", "Gui_MissionObjectiveCompleted", "MordorWitchKingOnFellBeast MordorFellBeast MordorFellBeast NeutralGollum", "Upgrade_MordorDualEconomyChoice Upgrade_EvilDualEconomyChoice", "None", "No", "0", "Mordor", "Mordor Army", "Mordor", "1.0", "1.1", "150", "10.0", "0.8", False, True)
        UpdateTextBoxes()
        UpdateList()
        FormLoaded = True
    End Sub
    Private Sub btnAddFaction_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnAdd.Click, btnAdd2.Click
        Try
            Dim FactName As String
            FactName = InputBox("Faction Name", "Faction Creator")
            FactNum += 1
            Fact(FactNum) = New Faction(FactNum, FactName, "Yes", FactName, "", "0", Color.FromArgb(255, 0, 0, 0), " ", " ", " ", " ", " ", "Gui_MissionObjectiveNew", "Gui_MissionObjectiveCompleted", " ", " ", "None", "No", "0", FactName, FactName & " Army", FactName, "1.0", "1.1", "200", "10.0", "0.8", True, True)
            i = FactNum
            UpdateTextBoxes()
            SetValues()
            UpdateTextBoxes()
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Sub
    Private Sub btnCreate_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnCreate.Click, btnSave2.Click
        Try
            Dim str(FactNum) As String
            Dim msg As String
            For f As Integer = 0 To FactNum
                If Fact(f).CreateFaction = True Then
                    str(f) = Fact(f).Side & ":" & vbTab & vbTab & "Create"
                Else
                    str(f) = Fact(f).Side & ":" & vbTab & vbTab & "Do not Create"
                End If
                msg &= str(f) & vbCrLf
            Next
            msg &= vbCrLf
            msg &= "Create PlayerTemplate.ini" & vbTab & " = " & chkPT.Checked & vbCrLf
            msg &= "Create Science.ini" & vbTab & vbTab & " = " & chkS.Checked & vbCrLf
            msg &= "Create Upgrade.ini" & vbTab & vbTab & " = " & chkU.Checked & vbCrLf
            msg &= "Create CommandSet.ini" & vbTab & " = " & chkCS.Checked & vbCrLf
            msg &= "Create VictorySystem.ini" & vbTab & " = " & chkVS.Checked & vbCrLf
            msg &= "Create lotr.str" & vbTab & vbTab & " = " & chkSTR.Checked & vbCrLf
            msg &= "Create CivilianBuildings.ini" & vbTab & " = " & chkCB.Checked
            If MsgBox(msg, MsgBoxStyle.OKCancel, "Is this correct?") = MsgBoxResult.OK Then
                Me.Cursor = Cursors.WaitCursor
                CreatePlayerTemplate(chkPT.Checked)
                createScience(chkS.Checked)
                CreateUpgrade(chkU.Checked)
                CreateVictorySystem(chkVS.Checked)
                CreateSTR(chkSTR.Checked)
                CreateCivilianBuildings(chkCB.Checked)
                CreateCommandSet(chkCS.Checked)
                CreateReadMe(True)
                MsgBox("Factions Created")
                Me.Cursor = Cursors.Default
            End If
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Sub
    Private Sub btnSave_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        With SaveFileDialog1
            .Filter = "All files(*.*)|*.*|Faction Creator Files(*.fcf)|*.fcf"
            .FilterIndex = 1
            .RestoreDirectory = True
            .InitialDirectory = "C:\"
            If SaveFileDialog1.ShowDialog() = DialogResult.OK Then
                SaveFile(.FileName)
            End If
        End With
    End Sub
    Private Sub btnHelp_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnInstructions.Click, btnInstructions2.Click
        If IO.File.Exists(Application.StartupPath & "\Instructions.txt") = True Then
            System.Diagnostics.Process.Start("Instructions.txt")
        Else
            MsgBox("The File " & "\Instructions.txt does not exist.", MsgBoxStyle.Exclamation, "Attention")
        End If
    End Sub
    Private Sub btnOpen_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnOpen.Click, btnOpen2.Click
        With OpenFileDialog1
            .InitialDirectory = Application.StartupPath
            .Filter = "All files(*.*)|*.*|INI Files(*.ini)|*.ini"
            .FilterIndex = 1
            .RestoreDirectory = True
            If OpenFileDialog1.ShowDialog() = DialogResult.OK Then
                OpenINIFile(.FileName)
            End If
        End With
    End Sub
    Private Sub btnCredits_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnCredits.Click, btnCredits2.Click
        MsgBox("Created on December 23 2005" & vbCrLf & _
                "------------------------------------------------" & vbCrLf & _
                "Author: Phil, {IP}Gil-Galad" & vbCrLf & _
                vbCrLf & _
                "Special Thanks:" & vbCrLf & _
                "-Geoff Thomas (AdmiralGT)" & vbCrLf & _
                "-Hostile, Webmaster at T3A" & vbCrLf & _
                vbCrLf & _
                "Made for modding BFME" & vbCrLf & _
                vbCrLf & _
                "Contact Me:" & vbCrLf & _
                "Msn:Freaklotr4@yahoo.com" & vbCrLf & _
                "Email:Freaklotr4@yahoo.com" & vbCrLf & _
                "Aim:Freaklotr4" & vbCrLf & _
                vbCrLf & _
                "Faction Creator " & Chr(153) & vbCrLf & _
                "------------------------------------------------", MsgBoxStyle.OKOnly.Information, "Faction Creator")
    End Sub
    Private Sub LinkLabel1_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles LinkLabel1.LinkClicked
        Dim IE As New SHDocVw.InternetExplorer
        IE.Visible = True
        IE.Navigate("www.the3rdage.net")
    End Sub
    Private Sub lstFactions_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles lstFactions.SelectedIndexChanged
        Try
            i = lstFactions.SelectedIndex
        UpdateTextBoxes()
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Sub
    Private Sub btnCreateFiles_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnCreateFiles.Click
        MsgBox("These are the files that can be created." & vbCrLf & "If your starting a mod its very smart to do all of them.")
    End Sub
    Private Sub MenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MenuItem1.Click, btnTips2.Click
        MsgBox("To get tips on what each function does put your cursor over the label that your curious about")
    End Sub
    Private Sub btnEvil_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEvil.Click, btnEvil2.Click
        Fact(i).Evil = "Yes"
        Fact(i).DefaultPlayerAIType = "MordorSkirmishAI"
        Fact(i).IntrinsicSciences = "SCIENCE_EVIL"
        Fact(i).SpellBook = "EvilSpellBook"
        Fact(i).ScienceCommandSet = "EvilSpellStoreCommandSet"
        Fact(i).EnemyKillScaleFactor = "1.1"
        Fact(i).MajorUnitValue = "10.0"
        Fact(i).MapToCellVictoryRatio = "0.8"
        Fact(i).VictoryThreshhold = "150"
        Fact(i).AllyDeathScaleFactor = "1.0"
        UpdateTextBoxes()
    End Sub
    Private Sub btnGood_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnGood.Click, btnGood2.Click
        Fact(i).Evil = "No"
        Fact(i).DefaultPlayerAIType = "GondorSkirmishAI"
        Fact(i).IntrinsicSciences = "SCIENCE_GOOD"
        Fact(i).SpellBook = "GoodSpellBook"
        Fact(i).ScienceCommandSet = "GoodSpellStoreCommandSet"
        Fact(i).EnemyKillScaleFactor = "1.1"
        Fact(i).MajorUnitValue = "10.0"
        Fact(i).MapToCellVictoryRatio = "0.8"
        Fact(i).VictoryThreshhold = "200"
        Fact(i).AllyDeathScaleFactor = "1.0"
        UpdateTextBoxes()
    End Sub
    Private Sub btnExit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnExit.Click
        Me.Close()
    End Sub
    Private Sub btnNew2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnNew2.Click
        Select Case MsgBox("Are you sure you want to erase all factions" & vbCrLf & "and start out with the four original ones?", MsgBoxStyle.YesNo)
            Case MsgBoxResult.Yes
                Try
                    For ii As Integer = 0 To FactNum
                        Fact(ii) = Nothing
                    Next
                    FactNum = 3
                    Fact(0) = New Faction(0, "Gondor", "Yes", "Gondor", "No", "0", Color.FromArgb(255, 43, 150, 179), "SCIENCE_GOOD", "GoodSpellBook", "GoodSpellStoreCommandSet", "GondorSkirmishAI", "GondorLightPointsUp", "Gui_MissionObjectiveNew", "Gui_MissionObjectiveCompleted", "GondorGandalf GondorBoromir GondorFaramir RohanPippin", "", "None", "No", "0", "Gondor", "Gondor Army", "Gondor", "1.0", "1.1", "200", "10.0", "0.8", False, True)
                    Fact(1) = New Faction(1, "Rohan", "Yes", "Rohan", "No", "0", Color.FromArgb(255, 42, 190, 53), "SCIENCE_GOOD", "GoodSpellBook", "GoodSpellStoreCommandSet", "RohanSkirmishAI", "RohanLightPointsUp", "Gui_MissionObjectiveNew", "Gui_MissionObjectiveCompleted", "RohanTheoden RohanEomer RohanEowyn RohanGimli RohanLegolas GondorAragornMP RohanMerry", "Upgrade_RohanDualEconomyChoice", "None", "No", "0", "Rohan", "Rohan Army", "Rohan", "1.0", "1.1", "200", "10.0", "0.8", False, True)
                    Fact(2) = New Faction(2, "Isengard", "Yes", "Isengard", "Yes", "0", Color.FromArgb(255, 216, 175, 48), "SCIENCE_EVIL", "EvilSpellBook", "EvilSpellStoreCommandSet", "IsengardSkirmishAI", "IsengardLightPointsUp", "Gui_MissionObjectiveNew", "Gui_MissionObjectiveCompleted", "IsengardSaruman IsengardLurtz", "Upgrade_IsengardDualEconomyChoice Upgrade_EvilDualEconomyChoice", "None", "No", "0", "Isengard", "Isengard Army", "Isengard", "1.0", "1.1", "150", "10.0", "0.8", False, True)
                    Fact(3) = New Faction(3, "Mordor", "Yes", "Mordor", "Yes", "0", Color.FromArgb(255, 175, 49, 33), "SCIENCE_EVIL", "EvilSpellBook", "EvilSpellStoreCommandSet", "MordorSkirmishAI", "MordorLightPointsUp", "Gui_MissionObjectiveNew", "Gui_MissionObjectiveCompleted", "MordorWitchKingOnFellBeast MordorFellBeast MordorFellBeast NeutralGollum", "Upgrade_MordorDualEconomyChoice Upgrade_EvilDualEconomyChoice", "None", "No", "0", "Mordor", "Mordor Army", "Mordor", "1.0", "1.1", "150", "10.0", "0.8", False, True)
                    UpdateTextBoxes()
                    UpdateList()
                Catch ex As Exception
                    MsgBox(ex.Message)
                End Try
        End Select

    End Sub
#End Region
#Region " Help Buttons (Unused)"
    Private Sub qEnemyKillScaleFactor_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("Value this faction places on 'kills' of enemy units that it gets", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qArmiesName_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("This is the name of your factions Living World Army", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qIsgrantable_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("By Default this is No, Its Advised not to change these values.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qSciencePurchasePointCost_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("By Default this is 0, Its Advised not to change these values.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qMajorUnitValue_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("Value placed on special/major units (normal units are worth 1.0). Its Advised not to change these values.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qPlayerTemplateFaction_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("This is your Factions Name Used only for player Template.ini", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qUpgradeText_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("The purpose of this is Unknown, it's suggested to keep this to your Sides Name", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qVictoryThreshold_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("Thereshold needed for a 'Victory'. Its Advised not to change these values.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qPrerequisiteSciences_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("These are the Sciences needed for the faction. Its suggested to keep this to None, If you choose otherwise it might screw up your faction", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qMapToCellVictoryRatio_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("Factor of VictoryThreshold that a cell needs for a Victory, practical range should be on the order of 0.2 and 1.0. Larger values make it more difficult to achieve 'Victory'. Its Advised not to change these values.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qSide_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("This is used for the commandsets, Str String Files and all Objects for which side they are on.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qPlayableSide_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("This should always be Yes, unless you dont want to play your team.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qEvil_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("Is This faction evil? Example: Isengard and Mordor ar Evil while Gondor and Rohan are Good.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qStartMoney_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("By Defualt this should always be set as 0, unless you know exactly what your doing.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qAllyDeathScaleFactor_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("Value placed on special/major units (normal units are worth 1.0). Its Advised not to change these values.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qPreferredColor_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("This is the Factions preferred color if you were to face it in Skirmish.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qIntrinsicSciences_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("Does this faction have good or bad Sciences?", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qSpellBook_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("Does this faction have good or bad Spellbooks?", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qScienceCommandSet_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("Does this faction have good or bad SpellStores?", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qDefaultPlayerAIType_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("This is the Factions AItype unless you create your own", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qLightPointsSound_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("This is the Light Points sound used in game", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qObjectiveAddedSound_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("This is the sound that occurs when an objective has been added", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qObjectiveCompleteSound_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("This is the sound that occurs when an objective has been completed.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qBuildableHeros_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("List all Buildable Heros here for skirmish matches. Separate the Heros by a space, no comma.", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qInitialUpgrades_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("The Factions Upgrade (Upgrade_'FactionName'Upgrade) Is already taken care of just list additional Upgrades", MsgBoxStyle.Information, "Whats This?")
    End Sub
    Private Sub qDisplayedName_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        MsgBox("This is the name displayed in game for the new faction. Also the name used for the Living World Army", MsgBoxStyle.Information, "Whats This")
    End Sub
#End Region


End Class

Public Class Faction
    'Used to Change the Faction
    Private _ID As Integer
    'Faction INI
    Private _Side As String
    Private _PlayableSide As String
    Private _FactionName As String
    Private _Evil As String
    Private _StartMoney As String
    Private _PreferredColor As Color
    Private _IntrinsicSciences As String
    Private _SpellBook As String
    Private _ScienceCommandSet As String
    Private _DefaultPlayerAIType As String
    Private _LightPointsSound As String
    Private _ObjectiveAddedSound As String
    Private _ObjectiveCompletedSound As String
    Private _BuildableHerosMP As String
    Private _InitialUpgrades As String
    'Science INI
    Private _PrerequisiteSciences As String
    Private _IsGrantable As String
    Private _SciencePurchasePointCost As String
    'STR File
    Private _FactionsDisplayedName As String
    Private _FactionsArmiesName As String
    Private _FactionsUpgradeText As String
    'VictorySystem INI
    Private _AllyDeathScaleFactor As String
    Private _EnemyKillScaleFactor As String
    Private _VictoryThreshhold As String
    Private _MajorUnitValue As String
    Private _MapToCellVictoryRatio As String
    'Others
    Private _CreateFaction As Boolean
    Private _CreateCB As Boolean
    Public Sub New()

    End Sub
    Public Sub New( _
    ByVal id_ As Integer, _
    ByVal side_ As String, _
    ByVal playableside_ As String, _
    ByVal factionname_ As String, _
    ByVal evil_ As String, _
    ByVal startMoney_ As String, _
    ByVal preferredColor_ As Color, _
    ByVal IntrinsicSciences_ As String, _
    ByVal spellBook_ As String, _
    ByVal scienceCommandSet_ As String, _
    ByVal defaultPlayerAIType_ As String, _
    ByVal lightPointsSound_ As String, _
    ByVal objectiveAddedSound_ As String, _
    ByVal objectiveCompletedSound_ As String, _
    ByVal buildableHerosMP_ As String, _
    ByVal initialUpgrades_ As String, _
    ByVal prerequisiteSciences_ As String, _
    ByVal isGrantable_ As String, _
    ByVal sciencePurchasePointCost_ As String, _
    ByVal factionsDisplayedName_ As String, _
    ByVal factionsArmiesName_ As String, _
    ByVal factionsUpgradeText_ As String, _
    ByVal allyDeathScaleFactor_ As String, _
    ByVal enemyKillScaleFactor_ As String, _
    ByVal victoryThreshhold_ As String, _
    ByVal majorUnitValue_ As String, _
    ByVal mapToCellVictoryRatio_ As String, _
    ByVal createfaction_ As Boolean, _
    ByVal createCB_ As Boolean)

        Me.ID = id_
        Me.Side = side_
        Me.PlayableSide = playableside_
        Me.FactionName = factionname_
        Me.Evil = evil_
        Me.StartMoney = startMoney_
        Me.PreferredColor = preferredColor_
        Me.IntrinsicSciences = IntrinsicSciences_
        Me.SpellBook = spellBook_
        Me.ScienceCommandSet = scienceCommandSet_
        Me.DefaultPlayerAIType = defaultPlayerAIType_
        Me.LightPointsSound = lightPointsSound_
        Me.ObjectiveAddedSound = objectiveAddedSound_
        Me.ObjectiveCompleteSound = objectiveCompletedSound_
        Me.BuildableHerosMP = buildableHerosMP_
        Me.InitialUpgrades = initialUpgrades_
        Me.PrerequisiteSciences = prerequisiteSciences_
        Me.IsGrantable = isGrantable_
        Me.SciencePurchasePointCost = sciencePurchasePointCost_
        Me.FactionsDisplayedName = factionsDisplayedName_
        Me.FactionsArmiesName = factionsArmiesName_
        Me.FactionsUpgradeText = factionsUpgradeText_
        Me.AllyDeathScaleFactor = allyDeathScaleFactor_
        Me.EnemyKillScaleFactor = enemyKillScaleFactor_
        Me.VictoryThreshhold = victoryThreshhold_
        Me.MajorUnitValue = majorUnitValue_
        Me.MapToCellVictoryRatio = mapToCellVictoryRatio_
        Me.CreateFaction = createfaction_
        Me.CreateCB = createCB_
    End Sub
    Public Property ID() As Integer
        Get
            Return Me._ID
        End Get
        Set(ByVal Value As Integer)
            Me._ID = Value
        End Set
    End Property
    Public Property Side() As String
        Get
            Return Me._Side
        End Get
        Set(ByVal Value As String)
            Me._Side = Value
        End Set
    End Property
    Public Property PlayableSide() As String
        Get
            Return Me._PlayableSide
        End Get
        Set(ByVal Value As String)
            Me._PlayableSide = Value
        End Set
    End Property
    Public Property FactionName() As String
        Get
            Return Me._FactionName
        End Get
        Set(ByVal Value As String)
            Me._FactionName = Value
        End Set
    End Property
    Public Property Evil() As String
        Get
            Return Me._Evil
        End Get
        Set(ByVal Value As String)
            Me._Evil = Value
        End Set
    End Property
    Public Property StartMoney() As String
        Get
            Return Me._StartMoney
        End Get
        Set(ByVal Value As String)
            Me._StartMoney = Value
        End Set
    End Property
    Public Property PreferredColor() As Color
        Get
            Return Me._PreferredColor
        End Get
        Set(ByVal Value As Color)
            Me._PreferredColor = Value
        End Set
    End Property
    Public Property IntrinsicSciences() As String
        Get
            Return Me._IntrinsicSciences
        End Get
        Set(ByVal Value As String)
            Me._IntrinsicSciences = Value
        End Set
    End Property
    Public Property SpellBook() As String
        Get
            Return Me._SpellBook
        End Get
        Set(ByVal Value As String)
            Me._SpellBook = Value
        End Set
    End Property
    Public Property ScienceCommandSet() As String
        Get
            Return Me._ScienceCommandSet
        End Get
        Set(ByVal Value As String)
            Me._ScienceCommandSet = Value
        End Set
    End Property
    Public Property DefaultPlayerAIType() As String
        Get
            Return Me._DefaultPlayerAIType
        End Get
        Set(ByVal Value As String)
            Me._DefaultPlayerAIType = Value
        End Set
    End Property
    Public Property LightPointsSound() As String
        Get
            Return Me._LightPointsSound
        End Get
        Set(ByVal Value As String)
            Me._LightPointsSound = Value
        End Set
    End Property
    Public Property ObjectiveAddedSound() As String
        Get
            Return Me._ObjectiveAddedSound
        End Get
        Set(ByVal Value As String)
            Me._ObjectiveAddedSound = Value
        End Set
    End Property
    Public Property ObjectiveCompleteSound() As String
        Get
            Return Me._ObjectiveCompletedSound
        End Get
        Set(ByVal Value As String)
            Me._ObjectiveCompletedSound = Value
        End Set
    End Property
    Public Property BuildableHerosMP() As String
        Get
            Return Me._BuildableHerosMP
        End Get
        Set(ByVal Value As String)
            Me._BuildableHerosMP = Value
        End Set
    End Property
    Public Property InitialUpgrades() As String
        Get
            Return Me._InitialUpgrades
        End Get
        Set(ByVal Value As String)
            Me._InitialUpgrades = Value
        End Set
    End Property
    Public Property PrerequisiteSciences() As String
        Get
            Return Me._PrerequisiteSciences
        End Get
        Set(ByVal Value As String)
            Me._PrerequisiteSciences = Value
        End Set
    End Property
    Public Property IsGrantable() As String
        Get
            Return Me._IsGrantable
        End Get
        Set(ByVal Value As String)
            Me._IsGrantable = Value
        End Set
    End Property
    Public Property SciencePurchasePointCost() As String
        Get
            Return Me._SciencePurchasePointCost
        End Get
        Set(ByVal Value As String)
            Me._SciencePurchasePointCost = Value
        End Set
    End Property
    Public Property FactionsDisplayedName() As String
        Get
            Return Me._FactionsDisplayedName
        End Get
        Set(ByVal Value As String)
            Me._FactionsDisplayedName = Value
        End Set
    End Property
    Public Property FactionsArmiesName() As String
        Get
            Return Me._FactionsArmiesName
        End Get
        Set(ByVal Value As String)
            Me._FactionsArmiesName = Value
        End Set
    End Property
    Public Property FactionsUpgradeText() As String
        Get
            Return Me._FactionsUpgradeText
        End Get
        Set(ByVal Value As String)
            Me._FactionsUpgradeText = Value
        End Set
    End Property
    Public Property AllyDeathScaleFactor() As String
        Get
            Return Me._AllyDeathScaleFactor
        End Get
        Set(ByVal Value As String)
            Me._AllyDeathScaleFactor = Value
        End Set
    End Property
    Public Property EnemyKillScaleFactor() As String
        Get
            Return Me._EnemyKillScaleFactor
        End Get
        Set(ByVal Value As String)
            Me._EnemyKillScaleFactor = Value
        End Set
    End Property
    Public Property VictoryThreshhold() As String
        Get
            Return Me._VictoryThreshhold
        End Get
        Set(ByVal Value As String)
            Me._VictoryThreshhold = Value
        End Set
    End Property
    Public Property MajorUnitValue() As String
        Get
            Return Me._MajorUnitValue
        End Get
        Set(ByVal Value As String)
            Me._MajorUnitValue = Value
        End Set
    End Property
    Public Property MapToCellVictoryRatio() As String
        Get
            Return Me._MapToCellVictoryRatio
        End Get
        Set(ByVal Value As String)
            Me._MapToCellVictoryRatio = Value
        End Set
    End Property
    Public Property CreateFaction() As Boolean
        Get
            Return Me._CreateFaction
        End Get
        Set(ByVal Value As Boolean)
            Me._CreateFaction = Value
        End Set
    End Property
    Public Property CreateCB() As Boolean
        Get
            Return Me._CreateCB
        End Get
        Set(ByVal Value As Boolean)
            Me._CreateCB = Value
        End Set
    End Property
End Class
